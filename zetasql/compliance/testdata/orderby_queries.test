# Base tables for order by tests
[load_proto_files=zetasql/testdata/test_schema.proto]
[load_proto_names=zetasql_test__.KitchenSinkPB]
[load_enum_names=zetasql_test__.TestEnum]

[prepare_database]
CREATE TABLE AllTypesTable AS
SELECT CAST(1 AS int64) as row_id,
       CAST(true AS bool) as bool_val,
       CAST(-1 AS int32) as int32_val,
       CAST(-1 AS int64) as int64_val,
       CAST(1 AS uint32) as uint32_val,
       CAST(1 AS uint64) as uint64_val,
       CAST(0.125 AS float) as float_val,
       CAST(0.125 AS double) as double_val,
       CAST("1" AS string) as str_val,
       CAST("1" AS BYTES) as bytes_val,
       CAST('2014-01-01' AS DATE) as date_val,
       TIMESTAMP '2014-01-01 00:00:01.011011 UTC' as
           timestamp_val
UNION ALL
SELECT CAST(2 AS int64) as row_id,
       CAST(true AS bool) as bool_val,
       CAST(-1 AS int32) as int32_val,
       CAST(-1 AS int64) as int64_val,
       CAST(1 AS uint32) as uint32_val,
       CAST(1 AS uint64) as uint64_val,
       CAST("NaN" AS float) as float_val,
       CAST("+Inf" AS double) as double_val,
       CAST("1" AS string) as str_val,
       CAST("1" AS BYTES) as bytes_val,
       CAST('2014-01-01' AS DATE) as date_val,
       TIMESTAMP '2014-01-01 00:00:01.011011 UTC' as
           timestamp_val
UNION ALL
SELECT CAST(3 AS int64) as row_id,
       CAST(true AS bool) as bool_val,
       CAST(-1 AS int32) as int32_val,
       CAST(-1 AS int64) as int64_val,
       CAST(1 AS uint32) as uint32_val,
       CAST(1 AS uint64) as uint64_val,
       CAST("+Inf" AS float) as float_val,
       CAST("-Inf" AS double) as double_val,
       CAST("1" AS string) as str_val,
       CAST("1" AS BYTES) as bytes_val,
       CAST('2014-01-01' AS DATE) as date_val,
       TIMESTAMP '2014-01-01 00:00:01.011011 UTC' as
           timestamp_val
UNION ALL
SELECT CAST(4 AS int64) as row_id,
       CAST(false AS bool) as bool_val,
       CAST(-2 AS int32) as int32_val,
       CAST(-2 AS int64) as int64_val,
       CAST(2 AS uint32) as uint32_val,
       CAST(2 AS uint64) as uint64_val,
       CAST(0.25 AS float) as float_val,
       CAST(pow(0.1, 324) AS double) as double_val, #positive 0 of type double
       CAST("2" AS string) as str_val,
       CAST("2" AS BYTES) as bytes_val,
       CAST('2014-01-02' AS DATE) as date_val,
       TIMESTAMP '2014-01-02 00:00:02.022022 UTC' as
           timestamp_val
UNION ALL
SELECT CAST(5 AS int64) as row_id,
       CAST(false AS bool) as bool_val,
       CAST(-2 AS int32) as int32_val,
       CAST(-2 AS int64) as int64_val,
       CAST(2 AS uint32) as uint32_val,
       CAST(2 AS uint64) as uint64_val,
       CAST("-Inf" AS float) as float_val,
       CAST(0.25 AS double) as double_val,
       CAST("2" AS string) as str_val,
       CAST("2" AS BYTES) as bytes_val,
       CAST('2014-01-02' AS DATE) as date_val,
       TIMESTAMP '2014-01-02 00:00:02.022022 UTC' as
           timestamp_val
UNION ALL
SELECT CAST(6 AS int64) as row_id,
       CAST(true AS bool) as bool_val,
       CAST(-3 AS int32) as int32_val,
       CAST(-3 AS int64) as int64_val,
       CAST(3 AS uint32) as uint32_val,
       CAST(3 AS uint64) as uint64_val,
       CAST(0.375 AS float) as float_val,
       CAST(0.375 AS double) as double_val,
       CAST("3" AS string) as str_val,
       CAST("3" AS BYTES) as bytes_val,
       CAST('2014-01-03' AS DATE) as date_val,
       TIMESTAMP '2014-01-03 00:00:03.033033 UTC' as
           timestamp_val
UNION ALL
SELECT CAST(7 AS int64) as row_id,
       CAST(false AS bool) as bool_val,
       CAST(-4 AS int32) as int32_val,
       CAST(-4 AS int64) as int64_val,
       CAST(4 AS uint32) as uint32_val,
       CAST(4 AS uint64) as uint64_val,
       CAST(0.5 AS float) as float_val,
       CAST(0.5 AS double) as double_val,
       CAST("4" AS string) as str_val,
       CAST("4" AS BYTES) as bytes_val,
       CAST('2014-01-04' AS DATE) as date_val,
       TIMESTAMP '2014-01-04 00:00:04.044044 UTC' as
           timestamp_val
UNION ALL
SELECT CAST(8 AS int64) as row_id,
       CAST(NULL AS bool) as bool_val,
       CAST(NULL AS int32) as int32_val,
       CAST(NULL AS int64) as int64_val,
       CAST(NULL AS uint32) as uint32_val,
       CAST(NULL AS uint64) as uint64_val,
       CAST(NULL AS float) as float_val,
       CAST(NULL AS double) as double_val,
       CAST(NULL AS string) as str_val,
       CAST(NULL AS BYTES) as bytes_val,
       CAST(NULL AS DATE) as date_val,
       CAST(NULL AS TIMESTAMP) as timestamp_val
UNION ALL
SELECT CAST(9 AS int64) as row_id,
       CAST(NULL AS bool) as bool_val,
       CAST(NULL AS int32) as int32_val,
       CAST(NULL AS int64) as int64_val,
       CAST(NULL AS uint32) as uint32_val,
       CAST(NULL AS uint64) as uint64_val,
       CAST(-pow(0.1, 46) AS float) as float_val, #negative 0 of type float
       CAST("NaN" AS double) as double_val,
       CAST(NULL AS string) as str_val,
       CAST(NULL AS BYTES) as bytes_val,
       CAST(NULL AS DATE) as date_val,
       CAST(NULL AS TIMESTAMP) as timestamp_val
UNION ALL
SELECT CAST(10 AS int64) as row_id,
       CAST(true AS bool) as bool_val,
       CAST(1 AS int32) as int32_val,
       CAST(1 AS int64) as int64_val,
       CAST(11 AS uint32) as uint32_val,
       CAST(11 AS uint64) as uint64_val,
       CAST(0.625 AS float) as float_val,
       CAST(0.625 AS double) as double_val,
       CAST("6" AS string) as str_val,
       CAST("7" AS BYTES) as bytes_val,
       CAST('2014-01-08' AS DATE) as date_val,
       TIMESTAMP '2014-01-02 00:00:01.011011 UTC' as
           timestamp_val
UNION ALL
SELECT CAST(11 AS int64) as row_id,
       CAST(false AS bool) as bool_val,
       CAST(5 AS int32) as int32_val,
       CAST(3 AS int64) as int64_val,
       CAST(11 AS uint32) as uint32_val,
       CAST(8 AS uint64) as uint64_val,
       CAST(-0.125 AS float) as float_val,
       CAST(-0.125 AS double) as double_val,
       CAST("123" AS string) as str_val,
       CAST("123" AS BYTES) as bytes_val,
       CAST('2014-02-01' AS DATE) as date_val,
       TIMESTAMP '2014-04-01 00:00:01.011011 UTC' as
           timestamp_val
UNION ALL
SELECT CAST(12 AS int64) as row_id,
       CAST(false AS bool) as bool_val,
       CAST(2 AS int32) as int32_val,
       CAST(16 AS int64) as int64_val,
       CAST(5 AS uint32) as uint32_val,
       CAST(9 AS uint64) as uint64_val,
       CAST(0.75 AS float) as float_val,
       CAST(-0.25 AS double) as double_val,
       CAST("24" AS string) as str_val,
       CAST("22" AS BYTES) as bytes_val,
       CAST('2014-02-02' AS DATE) as date_val,
       TIMESTAMP '2014-01-05 00:00:02.022022 UTC' as
           timestamp_val
UNION ALL
SELECT CAST(13 AS int64) as row_id,
       CAST(false AS bool) as bool_val,
       CAST(9 AS int32) as int32_val,
       CAST(9 AS int64) as int64_val,
       CAST(4 AS uint32) as uint32_val,
       CAST(8 AS uint64) as uint64_val,
       CAST(-0.25 AS float) as float_val,
       CAST(-0.75 AS double) as double_val,
       CAST("222" AS string) as str_val,
       CAST("234" AS BYTES) as bytes_val,
       CAST('2014-05-02' AS DATE) as date_val,
       TIMESTAMP '2014-05-02 00:00:02.022022 UTC' as
           timestamp_val
UNION ALL
SELECT CAST(14 AS int64) as row_id,
       CAST(true AS bool) as bool_val,
       CAST(13 AS int32) as int32_val,
       CAST(23 AS int64) as int64_val,
       CAST(31 AS uint32) as uint32_val,
       CAST(32 AS uint64) as uint64_val,
       CAST(-0.375 AS float) as float_val,
       CAST(-0.375 AS double) as double_val,
       CAST("345" AS string) as str_val,
       CAST("345" AS BYTES) as bytes_val,
       CAST('2014-01-06' AS DATE) as date_val,
       TIMESTAMP '2014-01-04 00:00:03.033033 UTC' as
           timestamp_val
UNION ALL
SELECT CAST(15 AS int64) as row_id,
       CAST(false AS bool) as bool_val,
       CAST(-24 AS int32) as int32_val,
       CAST(-14 AS int64) as int64_val,
       CAST(41 AS uint32) as uint32_val,
       CAST(54 AS uint64) as uint64_val,
       CAST(-0.5 AS float) as float_val,
       CAST(-0.5 AS double) as double_val,
       CAST("432" AS string) as str_val,
       CAST("433" AS BYTES) as bytes_val,
       CAST('2014-02-04' AS DATE) as date_val,
       TIMESTAMP '2014-02-04 00:00:04.044044 UTC' as
           timestamp_val
UNION ALL
SELECT CAST(16 AS int64) as row_id,
       CAST(false AS bool) as bool_val,
       CAST(NULL AS int32) as int32_val,
       CAST(-1 AS int64) as int64_val,
       CAST(NULL AS uint32) as uint32_val,
       CAST(1 AS uint64) as uint64_val,
       CAST(NULL AS float) as float_val,
       CAST(-pow(0.1, 324) AS double) as double_val, #negative 0 of type double
       CAST(NULL AS string) as str_val,
       CAST("1" AS BYTES) as bytes_val,
       CAST(NULL AS DATE) as date_val,
       TIMESTAMP '2014-02-04 00:00:04.044044 UTC' as
           timestamp_val
UNION ALL
SELECT CAST(17 AS int64) as row_id,
       CAST(NULL AS bool) as bool_val,
       CAST(-1 AS int32) as int32_val,
       CAST(NULL AS int64) as int64_val,
       CAST(1 AS uint32) as uint32_val,
       CAST(NULL AS uint64) as uint64_val,
       CAST(pow(0.1, 46) AS float) as float_val, #positive 0 of type float
       CAST(NULL AS double) as double_val,
       CAST("1" AS string) as str_val,
       CAST(NULL AS BYTES) as bytes_val,
       CAST('2014-02-04' AS DATE) as date_val,
       CAST(NULL AS TIMESTAMP) as timestamp_val
--
ARRAY<STRUCT<
        row_id INT64,
        bool_val BOOL,
        int32_val INT32,
        int64_val INT64,
        uint32_val UINT32,
        uint64_val UINT64,
        float_val FLOAT,
        double_val DOUBLE,
        str_val STRING,
        bytes_val BYTES,
        date_val DATE,
        timestamp_val TIMESTAMP
      >>
[{
   1,
   true,
   -1,
   -1,
   1,
   1,
   0.125,
   0.125,
   "1",
   b"1",
   2014-01-01,
   2014-01-01 00:00:01.011011+00
 },
 {
   2,
   true,
   -1,
   -1,
   1,
   1,
   nan,
   inf,
   "1",
   b"1",
   2014-01-01,
   2014-01-01 00:00:01.011011+00
 },
 {
   3,
   true,
   -1,
   -1,
   1,
   1,
   inf,
   -inf,
   "1",
   b"1",
   2014-01-01,
   2014-01-01 00:00:01.011011+00
 },
 {
   4,
   false,
   -2,
   -2,
   2,
   2,
   0.25,
   0,
   "2",
   b"2",
   2014-01-02,
   2014-01-02 00:00:02.022022+00
 },
 {
   5,
   false,
   -2,
   -2,
   2,
   2,
   -inf,
   0.25,
   "2",
   b"2",
   2014-01-02,
   2014-01-02 00:00:02.022022+00
 },
 {
   6,
   true,
   -3,
   -3,
   3,
   3,
   0.375,
   0.375,
   "3",
   b"3",
   2014-01-03,
   2014-01-03 00:00:03.033033+00
 },
 {
   7,
   false,
   -4,
   -4,
   4,
   4,
   0.5,
   0.5,
   "4",
   b"4",
   2014-01-04,
   2014-01-04 00:00:04.044044+00
 },
 {8, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL},
 {9, NULL, NULL, NULL, NULL, NULL, -0, nan, NULL, NULL, NULL, NULL},
 {
   10,
   true,
   1,
   1,
   11,
   11,
   0.625,
   0.625,
   "6",
   b"7",
   2014-01-08,
   2014-01-02 00:00:01.011011+00
 },
 {
   11,
   false,
   5,
   3,
   11,
   8,
   -0.125,
   -0.125,
   "123",
   b"123",
   2014-02-01,
   2014-04-01 00:00:01.011011+00
 },
 {
   12,
   false,
   2,
   16,
   5,
   9,
   0.75,
   -0.25,
   "24",
   b"22",
   2014-02-02,
   2014-01-05 00:00:02.022022+00
 },
 {
   13,
   false,
   9,
   9,
   4,
   8,
   -0.25,
   -0.75,
   "222",
   b"234",
   2014-05-02,
   2014-05-02 00:00:02.022022+00
 },
 {
   14,
   true,
   13,
   23,
   31,
   32,
   -0.375,
   -0.375,
   "345",
   b"345",
   2014-01-06,
   2014-01-04 00:00:03.033033+00
 },
 {
   15,
   false,
   -24,
   -14,
   41,
   54,
   -0.5,
   -0.5,
   "432",
   b"433",
   2014-02-04,
   2014-02-04 00:00:04.044044+00
 },
 {
   16,
   false,
   NULL,
   -1,
   NULL,
   1,
   NULL,
   -0,
   NULL,
   b"1",
   NULL,
   2014-02-04 00:00:04.044044+00
 },
 {17, NULL, -1, NULL, 1, NULL, 0, NULL, "1", NULL, 2014-02-04, NULL}]
==
[prepare_database]
[required_features=NUMERIC_TYPE]
CREATE TABLE AllTypesNumericTable AS
SELECT CAST(1 AS int64) as row_id,
       CAST(true AS bool) as bool_val,
       CAST(-1 AS int32) as int32_val,
       CAST(-1 AS int64) as int64_val,
       CAST(1 AS uint32) as uint32_val,
       CAST(1 AS uint64) as uint64_val,
       CAST(0.125 AS float) as float_val,
       CAST(0.125 AS double) as double_val,
       CAST("1" AS string) as str_val,
       CAST("1" AS BYTES) as bytes_val,
       CAST('2014-01-01' AS DATE) as date_val,
       TIMESTAMP '2014-01-01 00:00:01.011011 UTC' as
           timestamp_val,
       CAST(1 AS numeric) AS numeric_val
UNION ALL
SELECT CAST(2 AS int64) as row_id,
       CAST(true AS bool) as bool_val,
       CAST(-1 AS int32) as int32_val,
       CAST(-1 AS int64) as int64_val,
       CAST(1 AS uint32) as uint32_val,
       CAST(1 AS uint64) as uint64_val,
       CAST("NaN" AS float) as float_val,
       CAST("+Inf" AS double) as double_val,
       CAST("1" AS string) as str_val,
       CAST("1" AS BYTES) as bytes_val,
       CAST('2014-01-01' AS DATE) as date_val,
       TIMESTAMP '2014-01-01 00:00:01.011011 UTC' as
           timestamp_val,
       CAST(1 AS numeric) AS numeric_val
UNION ALL
SELECT CAST(3 AS int64) as row_id,
       CAST(true AS bool) as bool_val,
       CAST(-1 AS int32) as int32_val,
       CAST(-1 AS int64) as int64_val,
       CAST(1 AS uint32) as uint32_val,
       CAST(1 AS uint64) as uint64_val,
       CAST("+Inf" AS float) as float_val,
       CAST("-Inf" AS double) as double_val,
       CAST("1" AS string) as str_val,
       CAST("1" AS BYTES) as bytes_val,
       CAST('2014-01-01' AS DATE) as date_val,
       TIMESTAMP '2014-01-01 00:00:01.011011 UTC' as
           timestamp_val,
       CAST(1 AS numeric) AS numeric_val
UNION ALL
SELECT CAST(4 AS int64) as row_id,
       CAST(false AS bool) as bool_val,
       CAST(-2 AS int32) as int32_val,
       CAST(-2 AS int64) as int64_val,
       CAST(2 AS uint32) as uint32_val,
       CAST(2 AS uint64) as uint64_val,
       CAST(0.25 AS float) as float_val,
       CAST(pow(0.1, 324) AS double) as double_val, #positive 0 of type double
       CAST("2" AS string) as str_val,
       CAST("2" AS BYTES) as bytes_val,
       CAST('2014-01-02' AS DATE) as date_val,
       TIMESTAMP '2014-01-02 00:00:02.022022 UTC' as
           timestamp_val,
       CAST(2 AS numeric) AS numeric_val
UNION ALL
SELECT CAST(5 AS int64) as row_id,
       CAST(false AS bool) as bool_val,
       CAST(-2 AS int32) as int32_val,
       CAST(-2 AS int64) as int64_val,
       CAST(2 AS uint32) as uint32_val,
       CAST(2 AS uint64) as uint64_val,
       CAST("-Inf" AS float) as float_val,
       CAST(0.25 AS double) as double_val,
       CAST("2" AS string) as str_val,
       CAST("2" AS BYTES) as bytes_val,
       CAST('2014-01-02' AS DATE) as date_val,
       TIMESTAMP '2014-01-02 00:00:02.022022 UTC' as
           timestamp_val,
       CAST(93 AS numeric) AS numeric_val
UNION ALL
SELECT CAST(6 AS int64) as row_id,
       CAST(true AS bool) as bool_val,
       CAST(-3 AS int32) as int32_val,
       CAST(-3 AS int64) as int64_val,
       CAST(3 AS uint32) as uint32_val,
       CAST(3 AS uint64) as uint64_val,
       CAST(0.375 AS float) as float_val,
       CAST(0.375 AS double) as double_val,
       CAST("3" AS string) as str_val,
       CAST("3" AS BYTES) as bytes_val,
       CAST('2014-01-03' AS DATE) as date_val,
       TIMESTAMP '2014-01-03 00:00:03.033033 UTC' as
           timestamp_val,
       CAST(3 AS numeric) AS numeric_val
UNION ALL
SELECT CAST(7 AS int64) as row_id,
       CAST(false AS bool) as bool_val,
       CAST(-4 AS int32) as int32_val,
       CAST(-4 AS int64) as int64_val,
       CAST(4 AS uint32) as uint32_val,
       CAST(4 AS uint64) as uint64_val,
       CAST(0.5 AS float) as float_val,
       CAST(0.5 AS double) as double_val,
       CAST("4" AS string) as str_val,
       CAST("4" AS BYTES) as bytes_val,
       CAST('2014-01-04' AS DATE) as date_val,
       TIMESTAMP '2014-01-04 00:00:04.044044 UTC' as
           timestamp_val,
       CAST(4 AS numeric) AS numeric_val
UNION ALL
SELECT CAST(8 AS int64) as row_id,
       CAST(NULL AS bool) as bool_val,
       CAST(NULL AS int32) as int32_val,
       CAST(NULL AS int64) as int64_val,
       CAST(NULL AS uint32) as uint32_val,
       CAST(NULL AS uint64) as uint64_val,
       CAST(NULL AS float) as float_val,
       CAST(NULL AS double) as double_val,
       CAST(NULL AS string) as str_val,
       CAST(NULL AS BYTES) as bytes_val,
       CAST(NULL AS DATE) as date_val,
       CAST(NULL AS TIMESTAMP) as timestamp_val,
       CAST(NULL AS numeric) AS numeric_val
UNION ALL
SELECT CAST(9 AS int64) as row_id,
       CAST(NULL AS bool) as bool_val,
       CAST(NULL AS int32) as int32_val,
       CAST(NULL AS int64) as int64_val,
       CAST(NULL AS uint32) as uint32_val,
       CAST(NULL AS uint64) as uint64_val,
       CAST(-pow(0.1, 46) AS float) as float_val, #negative 0 of type float
       CAST("NaN" AS double) as double_val,
       CAST(NULL AS string) as str_val,
       CAST(NULL AS BYTES) as bytes_val,
       CAST(NULL AS DATE) as date_val,
       CAST(NULL AS TIMESTAMP) as timestamp_val,
       CAST(NULL AS numeric) AS numeric_val
UNION ALL
SELECT CAST(10 AS int64) as row_id,
       CAST(true AS bool) as bool_val,
       CAST(1 AS int32) as int32_val,
       CAST(1 AS int64) as int64_val,
       CAST(11 AS uint32) as uint32_val,
       CAST(11 AS uint64) as uint64_val,
       CAST(0.625 AS float) as float_val,
       CAST(0.625 AS double) as double_val,
       CAST("6" AS string) as str_val,
       CAST("7" AS BYTES) as bytes_val,
       CAST('2014-01-08' AS DATE) as date_val,
       TIMESTAMP '2014-01-02 00:00:01.011011 UTC' as
           timestamp_val,
       CAST(1 AS numeric) AS numeric_val
UNION ALL
SELECT CAST(11 AS int64) as row_id,
       CAST(false AS bool) as bool_val,
       CAST(5 AS int32) as int32_val,
       CAST(3 AS int64) as int64_val,
       CAST(11 AS uint32) as uint32_val,
       CAST(8 AS uint64) as uint64_val,
       CAST(-0.125 AS float) as float_val,
       CAST(-0.125 AS double) as double_val,
       CAST("123" AS string) as str_val,
       CAST("123" AS BYTES) as bytes_val,
       CAST('2014-02-01' AS DATE) as date_val,
       TIMESTAMP '2014-04-01 00:00:01.011011 UTC' as
           timestamp_val,
       CAST(-5.34 AS numeric) AS numeric_val
UNION ALL
SELECT CAST(12 AS int64) as row_id,
       CAST(false AS bool) as bool_val,
       CAST(2 AS int32) as int32_val,
       CAST(16 AS int64) as int64_val,
       CAST(5 AS uint32) as uint32_val,
       CAST(9 AS uint64) as uint64_val,
       CAST(0.75 AS float) as float_val,
       CAST(-0.25 AS double) as double_val,
       CAST("24" AS string) as str_val,
       CAST("22" AS BYTES) as bytes_val,
       CAST('2014-02-02' AS DATE) as date_val,
       TIMESTAMP '2014-01-05 00:00:02.022022 UTC' as
           timestamp_val,
       CAST(999.999 AS numeric) AS numeric_val
UNION ALL
SELECT CAST(13 AS int64) as row_id,
       CAST(false AS bool) as bool_val,
       CAST(9 AS int32) as int32_val,
       CAST(9 AS int64) as int64_val,
       CAST(4 AS uint32) as uint32_val,
       CAST(8 AS uint64) as uint64_val,
       CAST(-0.25 AS float) as float_val,
       CAST(-0.75 AS double) as double_val,
       CAST("222" AS string) as str_val,
       CAST("234" AS BYTES) as bytes_val,
       CAST('2014-05-02' AS DATE) as date_val,
       TIMESTAMP '2014-05-02 00:00:02.022022 UTC' as
           timestamp_val,
       CAST(-1000.10101 AS numeric) AS numeric_val
UNION ALL
SELECT CAST(14 AS int64) as row_id,
       CAST(true AS bool) as bool_val,
       CAST(13 AS int32) as int32_val,
       CAST(23 AS int64) as int64_val,
       CAST(31 AS uint32) as uint32_val,
       CAST(32 AS uint64) as uint64_val,
       CAST(-0.375 AS float) as float_val,
       CAST(-0.375 AS double) as double_val,
       CAST("345" AS string) as str_val,
       CAST("345" AS BYTES) as bytes_val,
       CAST('2014-01-06' AS DATE) as date_val,
       TIMESTAMP '2014-01-04 00:00:03.033033 UTC' as
           timestamp_val,
       CAST(222 AS numeric) AS numeric_val
UNION ALL
SELECT CAST(15 AS int64) as row_id,
       CAST(false AS bool) as bool_val,
       CAST(-24 AS int32) as int32_val,
       CAST(-14 AS int64) as int64_val,
       CAST(41 AS uint32) as uint32_val,
       CAST(54 AS uint64) as uint64_val,
       CAST(-0.5 AS float) as float_val,
       CAST(-0.5 AS double) as double_val,
       CAST("432" AS string) as str_val,
       CAST("433" AS BYTES) as bytes_val,
       CAST('2014-02-04' AS DATE) as date_val,
       TIMESTAMP '2014-02-04 00:00:04.044044 UTC' as
           timestamp_val,
       CAST(-123456789.123456789 AS numeric) AS numeric_val
UNION ALL
SELECT CAST(16 AS int64) as row_id,
       CAST(false AS bool) as bool_val,
       CAST(NULL AS int32) as int32_val,
       CAST(-1 AS int64) as int64_val,
       CAST(NULL AS uint32) as uint32_val,
       CAST(1 AS uint64) as uint64_val,
       CAST(NULL AS float) as float_val,
       CAST(-pow(0.1, 324) AS double) as double_val, #negative 0 of type double
       CAST(NULL AS string) as str_val,
       CAST("1" AS BYTES) as bytes_val,
       CAST(NULL AS DATE) as date_val,
       TIMESTAMP '2014-02-04 00:00:04.044044 UTC' as
           timestamp_val,
       CAST(NULL AS numeric) AS numeric_val
UNION ALL
SELECT CAST(17 AS int64) as row_id,
       CAST(NULL AS bool) as bool_val,
       CAST(-1 AS int32) as int32_val,
       CAST(NULL AS int64) as int64_val,
       CAST(1 AS uint32) as uint32_val,
       CAST(NULL AS uint64) as uint64_val,
       CAST(pow(0.1, 46) AS float) as float_val, #positive 0 of type float
       CAST(NULL AS double) as double_val,
       CAST("1" AS string) as str_val,
       CAST(NULL AS BYTES) as bytes_val,
       CAST('2014-02-04' AS DATE) as date_val,
       CAST(NULL AS TIMESTAMP) as timestamp_val,
       CAST(-123456789.123456789 AS numeric) AS numeric_val
--
ARRAY<STRUCT<
        row_id INT64,
        bool_val BOOL,
        int32_val INT32,
        int64_val INT64,
        uint32_val UINT32,
        uint64_val UINT64,
        float_val FLOAT,
        double_val DOUBLE,
        str_val STRING,
        bytes_val BYTES,
        date_val DATE,
        timestamp_val TIMESTAMP,
        numeric_val NUMERIC
      >>
[{
   1,
   true,
   -1,
   -1,
   1,
   1,
   0.125,
   0.125,
   "1",
   b"1",
   2014-01-01,
   2014-01-01 00:00:01.011011+00,
   1
 },
 {
   2,
   true,
   -1,
   -1,
   1,
   1,
   nan,
   inf,
   "1",
   b"1",
   2014-01-01,
   2014-01-01 00:00:01.011011+00,
   1
 },
 {
   3,
   true,
   -1,
   -1,
   1,
   1,
   inf,
   -inf,
   "1",
   b"1",
   2014-01-01,
   2014-01-01 00:00:01.011011+00,
   1
 },
 {
   4,
   false,
   -2,
   -2,
   2,
   2,
   0.25,
   0,
   "2",
   b"2",
   2014-01-02,
   2014-01-02 00:00:02.022022+00,
   2
 },
 {
   5,
   false,
   -2,
   -2,
   2,
   2,
   -inf,
   0.25,
   "2",
   b"2",
   2014-01-02,
   2014-01-02 00:00:02.022022+00,
   93
 },
 {
   6,
   true,
   -3,
   -3,
   3,
   3,
   0.375,
   0.375,
   "3",
   b"3",
   2014-01-03,
   2014-01-03 00:00:03.033033+00,
   3
 },
 {
   7,
   false,
   -4,
   -4,
   4,
   4,
   0.5,
   0.5,
   "4",
   b"4",
   2014-01-04,
   2014-01-04 00:00:04.044044+00,
   4
 },
 {8, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL},
 {9, NULL, NULL, NULL, NULL, NULL, -0, nan, NULL, NULL, NULL, NULL, NULL},
 {
   10,
   true,
   1,
   1,
   11,
   11,
   0.625,
   0.625,
   "6",
   b"7",
   2014-01-08,
   2014-01-02 00:00:01.011011+00,
   1
 },
 {
   11,
   false,
   5,
   3,
   11,
   8,
   -0.125,
   -0.125,
   "123",
   b"123",
   2014-02-01,
   2014-04-01 00:00:01.011011+00,
   -5.34
 },
 {
   12,
   false,
   2,
   16,
   5,
   9,
   0.75,
   -0.25,
   "24",
   b"22",
   2014-02-02,
   2014-01-05 00:00:02.022022+00,
   999.999
 },
 {
   13,
   false,
   9,
   9,
   4,
   8,
   -0.25,
   -0.75,
   "222",
   b"234",
   2014-05-02,
   2014-05-02 00:00:02.022022+00,
   -1000.10101
 },
 {
   14,
   true,
   13,
   23,
   31,
   32,
   -0.375,
   -0.375,
   "345",
   b"345",
   2014-01-06,
   2014-01-04 00:00:03.033033+00,
   222
 },
 {
   15,
   false,
   -24,
   -14,
   41,
   54,
   -0.5,
   -0.5,
   "432",
   b"433",
   2014-02-04,
   2014-02-04 00:00:04.044044+00,
   -123456789.123456789
 },
 {
   16,
   false,
   NULL,
   -1,
   NULL,
   1,
   NULL,
   -0,
   NULL,
   b"1",
   NULL,
   2014-02-04 00:00:04.044044+00,
   NULL
 },
 {17,
  NULL,
  -1,
  NULL,
  1,
  NULL,
  0,
  NULL,
  "1",
  NULL,
  2014-02-04,
  NULL,
  -123456789.123456789}]
==
[prepare_database]
[required_features=BIGNUMERIC_TYPE]
CREATE TABLE AllTypesBigNumericTable AS
SELECT CAST(1 AS int64) as row_id,
       CAST(true AS bool) as bool_val,
       CAST(-1 AS int32) as int32_val,
       CAST(-1 AS int64) as int64_val,
       CAST(1 AS uint32) as uint32_val,
       CAST(1 AS uint64) as uint64_val,
       CAST(0.125 AS float) as float_val,
       CAST(0.125 AS double) as double_val,
       CAST("1" AS string) as str_val,
       CAST("1" AS BYTES) as bytes_val,
       CAST('2014-01-01' AS DATE) as date_val,
       TIMESTAMP '2014-01-01 00:00:01.011011 UTC' as
           timestamp_val,
       CAST(1 AS bignumeric) AS bignumeric_val
UNION ALL
SELECT CAST(2 AS int64) as row_id,
       CAST(true AS bool) as bool_val,
       CAST(-1 AS int32) as int32_val,
       CAST(-1 AS int64) as int64_val,
       CAST(1 AS uint32) as uint32_val,
       CAST(1 AS uint64) as uint64_val,
       CAST("NaN" AS float) as float_val,
       CAST("+Inf" AS double) as double_val,
       CAST("1" AS string) as str_val,
       CAST("1" AS BYTES) as bytes_val,
       CAST('2014-01-01' AS DATE) as date_val,
       TIMESTAMP '2014-01-01 00:00:01.011011 UTC' as
           timestamp_val,
       CAST(1 AS bignumeric) AS bignumeric_val
UNION ALL
SELECT CAST(3 AS int64) as row_id,
       CAST(true AS bool) as bool_val,
       CAST(-1 AS int32) as int32_val,
       CAST(-1 AS int64) as int64_val,
       CAST(1 AS uint32) as uint32_val,
       CAST(1 AS uint64) as uint64_val,
       CAST("+Inf" AS float) as float_val,
       CAST("-Inf" AS double) as double_val,
       CAST("1" AS string) as str_val,
       CAST("1" AS BYTES) as bytes_val,
       CAST('2014-01-01' AS DATE) as date_val,
       TIMESTAMP '2014-01-01 00:00:01.011011 UTC' as
           timestamp_val,
       CAST(1 AS bignumeric) AS bignumeric_val
UNION ALL
SELECT CAST(4 AS int64) as row_id,
       CAST(false AS bool) as bool_val,
       CAST(-2 AS int32) as int32_val,
       CAST(-2 AS int64) as int64_val,
       CAST(2 AS uint32) as uint32_val,
       CAST(2 AS uint64) as uint64_val,
       CAST(0.25 AS float) as float_val,
       CAST(pow(0.1, 324) AS double) as double_val, #positive 0 of type double
       CAST("2" AS string) as str_val,
       CAST("2" AS BYTES) as bytes_val,
       CAST('2014-01-02' AS DATE) as date_val,
       TIMESTAMP '2014-01-02 00:00:02.022022 UTC' as
           timestamp_val,
       CAST(2 AS bignumeric) AS bignumeric_val
UNION ALL
SELECT CAST(5 AS int64) as row_id,
       CAST(false AS bool) as bool_val,
       CAST(-2 AS int32) as int32_val,
       CAST(-2 AS int64) as int64_val,
       CAST(2 AS uint32) as uint32_val,
       CAST(2 AS uint64) as uint64_val,
       CAST("-Inf" AS float) as float_val,
       CAST(0.25 AS double) as double_val,
       CAST("2" AS string) as str_val,
       CAST("2" AS BYTES) as bytes_val,
       CAST('2014-01-02' AS DATE) as date_val,
       TIMESTAMP '2014-01-02 00:00:02.022022 UTC' as
           timestamp_val,
       CAST(93 AS bignumeric) AS bignumeric_val
UNION ALL
SELECT CAST(6 AS int64) as row_id,
       CAST(true AS bool) as bool_val,
       CAST(-3 AS int32) as int32_val,
       CAST(-3 AS int64) as int64_val,
       CAST(3 AS uint32) as uint32_val,
       CAST(3 AS uint64) as uint64_val,
       CAST(0.375 AS float) as float_val,
       CAST(0.375 AS double) as double_val,
       CAST("3" AS string) as str_val,
       CAST("3" AS BYTES) as bytes_val,
       CAST('2014-01-03' AS DATE) as date_val,
       TIMESTAMP '2014-01-03 00:00:03.033033 UTC' as
           timestamp_val,
       CAST(3 AS bignumeric) AS bignumeric_val
UNION ALL
SELECT CAST(7 AS int64) as row_id,
       CAST(false AS bool) as bool_val,
       CAST(-4 AS int32) as int32_val,
       CAST(-4 AS int64) as int64_val,
       CAST(4 AS uint32) as uint32_val,
       CAST(4 AS uint64) as uint64_val,
       CAST(0.5 AS float) as float_val,
       CAST(0.5 AS double) as double_val,
       CAST("4" AS string) as str_val,
       CAST("4" AS BYTES) as bytes_val,
       CAST('2014-01-04' AS DATE) as date_val,
       TIMESTAMP '2014-01-04 00:00:04.044044 UTC' as
           timestamp_val,
       CAST(4 AS bignumeric) AS bignumeric_val
UNION ALL
SELECT CAST(8 AS int64) as row_id,
       CAST(NULL AS bool) as bool_val,
       CAST(NULL AS int32) as int32_val,
       CAST(NULL AS int64) as int64_val,
       CAST(NULL AS uint32) as uint32_val,
       CAST(NULL AS uint64) as uint64_val,
       CAST(NULL AS float) as float_val,
       CAST(NULL AS double) as double_val,
       CAST(NULL AS string) as str_val,
       CAST(NULL AS BYTES) as bytes_val,
       CAST(NULL AS DATE) as date_val,
       CAST(NULL AS TIMESTAMP) as timestamp_val,
       CAST(NULL AS bignumeric) AS bignumeric_val
UNION ALL
SELECT CAST(9 AS int64) as row_id,
       CAST(NULL AS bool) as bool_val,
       CAST(NULL AS int32) as int32_val,
       CAST(NULL AS int64) as int64_val,
       CAST(NULL AS uint32) as uint32_val,
       CAST(NULL AS uint64) as uint64_val,
       CAST(-pow(0.1, 46) AS float) as float_val, #negative 0 of type float
       CAST("NaN" AS double) as double_val,
       CAST(NULL AS string) as str_val,
       CAST(NULL AS BYTES) as bytes_val,
       CAST(NULL AS DATE) as date_val,
       CAST(NULL AS TIMESTAMP) as timestamp_val,
       CAST(NULL AS bignumeric) AS bignumeric_val
UNION ALL
SELECT CAST(10 AS int64) as row_id,
       CAST(true AS bool) as bool_val,
       CAST(1 AS int32) as int32_val,
       CAST(1 AS int64) as int64_val,
       CAST(11 AS uint32) as uint32_val,
       CAST(11 AS uint64) as uint64_val,
       CAST(0.625 AS float) as float_val,
       CAST(0.625 AS double) as double_val,
       CAST("6" AS string) as str_val,
       CAST("7" AS BYTES) as bytes_val,
       CAST('2014-01-08' AS DATE) as date_val,
       TIMESTAMP '2014-01-02 00:00:01.011011 UTC' as
           timestamp_val,
       CAST(1 AS bignumeric) AS bignumeric_val
UNION ALL
SELECT CAST(11 AS int64) as row_id,
       CAST(false AS bool) as bool_val,
       CAST(5 AS int32) as int32_val,
       CAST(3 AS int64) as int64_val,
       CAST(11 AS uint32) as uint32_val,
       CAST(8 AS uint64) as uint64_val,
       CAST(-0.125 AS float) as float_val,
       CAST(-0.125 AS double) as double_val,
       CAST("123" AS string) as str_val,
       CAST("123" AS BYTES) as bytes_val,
       CAST('2014-02-01' AS DATE) as date_val,
       TIMESTAMP '2014-04-01 00:00:01.011011 UTC' as
           timestamp_val,
       CAST(-5.34 AS bignumeric) AS bignumeric_val
UNION ALL
SELECT CAST(12 AS int64) as row_id,
       CAST(false AS bool) as bool_val,
       CAST(2 AS int32) as int32_val,
       CAST(16 AS int64) as int64_val,
       CAST(5 AS uint32) as uint32_val,
       CAST(9 AS uint64) as uint64_val,
       CAST(0.75 AS float) as float_val,
       CAST(-0.25 AS double) as double_val,
       CAST("24" AS string) as str_val,
       CAST("22" AS BYTES) as bytes_val,
       CAST('2014-02-02' AS DATE) as date_val,
       TIMESTAMP '2014-01-05 00:00:02.022022 UTC' as
           timestamp_val,
       CAST(999.9999999999999999999 AS bignumeric) AS bignumeric_val
UNION ALL
SELECT CAST(13 AS int64) as row_id,
       CAST(false AS bool) as bool_val,
       CAST(9 AS int32) as int32_val,
       CAST(9 AS int64) as int64_val,
       CAST(4 AS uint32) as uint32_val,
       CAST(8 AS uint64) as uint64_val,
       CAST(-0.25 AS float) as float_val,
       CAST(-0.75 AS double) as double_val,
       CAST("222" AS string) as str_val,
       CAST("234" AS BYTES) as bytes_val,
       CAST('2014-05-02' AS DATE) as date_val,
       TIMESTAMP '2014-05-02 00:00:02.022022 UTC' as
           timestamp_val,
       CAST(-1000.0000000000000000001 AS bignumeric) AS bignumeric_val
UNION ALL
SELECT CAST(14 AS int64) as row_id,
       CAST(true AS bool) as bool_val,
       CAST(13 AS int32) as int32_val,
       CAST(23 AS int64) as int64_val,
       CAST(31 AS uint32) as uint32_val,
       CAST(32 AS uint64) as uint64_val,
       CAST(-0.375 AS float) as float_val,
       CAST(-0.375 AS double) as double_val,
       CAST("345" AS string) as str_val,
       CAST("345" AS BYTES) as bytes_val,
       CAST('2014-01-06' AS DATE) as date_val,
       TIMESTAMP '2014-01-04 00:00:03.033033 UTC' as
           timestamp_val,
       CAST(222 AS bignumeric) AS bignumeric_val
UNION ALL
SELECT CAST(15 AS int64) as row_id,
       CAST(false AS bool) as bool_val,
       CAST(-24 AS int32) as int32_val,
       CAST(-14 AS int64) as int64_val,
       CAST(41 AS uint32) as uint32_val,
       CAST(54 AS uint64) as uint64_val,
       CAST(-0.5 AS float) as float_val,
       CAST(-0.5 AS double) as double_val,
       CAST("432" AS string) as str_val,
       CAST("433" AS BYTES) as bytes_val,
       CAST('2014-02-04' AS DATE) as date_val,
       TIMESTAMP '2014-02-04 00:00:04.044044 UTC' as
           timestamp_val,
       CAST(-123456789.1234567890123456789 AS bignumeric) AS bignumeric_val
UNION ALL
SELECT CAST(16 AS int64) as row_id,
       CAST(false AS bool) as bool_val,
       CAST(NULL AS int32) as int32_val,
       CAST(-1 AS int64) as int64_val,
       CAST(NULL AS uint32) as uint32_val,
       CAST(1 AS uint64) as uint64_val,
       CAST(NULL AS float) as float_val,
       CAST(-pow(0.1, 324) AS double) as double_val, #negative 0 of type double
       CAST(NULL AS string) as str_val,
       CAST("1" AS BYTES) as bytes_val,
       CAST(NULL AS DATE) as date_val,
       TIMESTAMP '2014-02-04 00:00:04.044044 UTC' as
           timestamp_val,
       CAST(NULL AS bignumeric) AS bignumeric_val
UNION ALL
SELECT CAST(17 AS int64) as row_id,
       CAST(NULL AS bool) as bool_val,
       CAST(-1 AS int32) as int32_val,
       CAST(NULL AS int64) as int64_val,
       CAST(1 AS uint32) as uint32_val,
       CAST(NULL AS uint64) as uint64_val,
       CAST(pow(0.1, 46) AS float) as float_val, #positive 0 of type float
       CAST(NULL AS double) as double_val,
       CAST("1" AS string) as str_val,
       CAST(NULL AS BYTES) as bytes_val,
       CAST('2014-02-04' AS DATE) as date_val,
       CAST(NULL AS TIMESTAMP) as timestamp_val,
       CAST(-123456789.1234567890123456789 AS bignumeric) AS bignumeric_val
--
ARRAY<STRUCT<
        row_id INT64,
        bool_val BOOL,
        int32_val INT32,
        int64_val INT64,
        uint32_val UINT32,
        uint64_val UINT64,
        float_val FLOAT,
        double_val DOUBLE,
        str_val STRING,
        bytes_val BYTES,
        date_val DATE,
        timestamp_val TIMESTAMP,
        bignumeric_val BIGNUMERIC
      >>
[{
   1,
   true,
   -1,
   -1,
   1,
   1,
   0.125,
   0.125,
   "1",
   b"1",
   2014-01-01,
   2014-01-01 00:00:01.011011+00,
   1
 },
 {
   2,
   true,
   -1,
   -1,
   1,
   1,
   nan,
   inf,
   "1",
   b"1",
   2014-01-01,
   2014-01-01 00:00:01.011011+00,
   1
 },
 {
   3,
   true,
   -1,
   -1,
   1,
   1,
   inf,
   -inf,
   "1",
   b"1",
   2014-01-01,
   2014-01-01 00:00:01.011011+00,
   1
 },
 {
   4,
   false,
   -2,
   -2,
   2,
   2,
   0.25,
   0,
   "2",
   b"2",
   2014-01-02,
   2014-01-02 00:00:02.022022+00,
   2
 },
 {
   5,
   false,
   -2,
   -2,
   2,
   2,
   -inf,
   0.25,
   "2",
   b"2",
   2014-01-02,
   2014-01-02 00:00:02.022022+00,
   93
 },
 {
   6,
   true,
   -3,
   -3,
   3,
   3,
   0.375,
   0.375,
   "3",
   b"3",
   2014-01-03,
   2014-01-03 00:00:03.033033+00,
   3
 },
 {
   7,
   false,
   -4,
   -4,
   4,
   4,
   0.5,
   0.5,
   "4",
   b"4",
   2014-01-04,
   2014-01-04 00:00:04.044044+00,
   4
 },
 {8, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL},
 {9, NULL, NULL, NULL, NULL, NULL, -0, nan, NULL, NULL, NULL, NULL, NULL},
 {
   10,
   true,
   1,
   1,
   11,
   11,
   0.625,
   0.625,
   "6",
   b"7",
   2014-01-08,
   2014-01-02 00:00:01.011011+00,
   1
 },
 {
   11,
   false,
   5,
   3,
   11,
   8,
   -0.125,
   -0.125,
   "123",
   b"123",
   2014-02-01,
   2014-04-01 00:00:01.011011+00,
   -5.34
 },
 {
   12,
   false,
   2,
   16,
   5,
   9,
   0.75,
   -0.25,
   "24",
   b"22",
   2014-02-02,
   2014-01-05 00:00:02.022022+00,
   999.9999999999999999999
 },
 {
   13,
   false,
   9,
   9,
   4,
   8,
   -0.25,
   -0.75,
   "222",
   b"234",
   2014-05-02,
   2014-05-02 00:00:02.022022+00,
   -1000.0000000000000000001
 },
 {
   14,
   true,
   13,
   23,
   31,
   32,
   -0.375,
   -0.375,
   "345",
   b"345",
   2014-01-06,
   2014-01-04 00:00:03.033033+00,
   222
 },
 {
   15,
   false,
   -24,
   -14,
   41,
   54,
   -0.5,
   -0.5,
   "432",
   b"433",
   2014-02-04,
   2014-02-04 00:00:04.044044+00,
   -123456789.1234567890123456789
 },
 {
   16,
   false,
   NULL,
   -1,
   NULL,
   1,
   NULL,
   -0,
   NULL,
   b"1",
   NULL,
   2014-02-04 00:00:04.044044+00,
   NULL
 },
 {
   17,
   NULL,
   -1,
   NULL,
   1,
   NULL,
   0,
   NULL,
   "1",
   NULL,
   2014-02-04,
   NULL,
   -123456789.1234567890123456789
 }]
==
[prepare_database]
[required_features=RANGE_TYPE]
CREATE TABLE AllTypesRangeTable AS
SELECT CAST(1 AS int64) as row_id,
       CAST(true AS bool) as bool_val,
       CAST(-1 AS int32) as int32_val,
       CAST(-1 AS int64) as int64_val,
       CAST(1 AS uint32) as uint32_val,
       CAST(1 AS uint64) as uint64_val,
       CAST(0.125 AS float) as float_val,
       CAST(0.125 AS double) as double_val,
       CAST("1" AS string) as str_val,
       CAST("1" AS BYTES) as bytes_val,
       CAST('2014-01-01' AS DATE) as date_val,
       TIMESTAMP '2014-01-01 00:00:01.011011 UTC' as
           timestamp_val,
       RANGE<TIMESTAMP> '[2011-01-01 00:00:00+00, 2011-10-15 00:00:00+00)' as range_timestamp_val,
       RANGE<DATE> '[2011-01-01, 2011-10-15)' as range_date_val
UNION ALL
SELECT CAST(2 AS int64) as row_id,
       CAST(true AS bool) as bool_val,
       CAST(-1 AS int32) as int32_val,
       CAST(-1 AS int64) as int64_val,
       CAST(1 AS uint32) as uint32_val,
       CAST(1 AS uint64) as uint64_val,
       CAST("NaN" AS float) as float_val,
       CAST("+Inf" AS double) as double_val,
       CAST("1" AS string) as str_val,
       CAST("1" AS BYTES) as bytes_val,
       CAST('2014-01-01' AS DATE) as date_val,
       TIMESTAMP '2014-01-01 00:00:01.011011 UTC' as
           timestamp_val,
       RANGE<TIMESTAMP> '[2011-01-01 00:00:00+00, 2011-10-15 00:00:00+00)' as range_timestamp_val,
       RANGE<DATE> '[2011-01-01, 2011-10-15)' as range_date_val
UNION ALL
SELECT CAST(3 AS int64) as row_id,
       CAST(true AS bool) as bool_val,
       CAST(-1 AS int32) as int32_val,
       CAST(-1 AS int64) as int64_val,
       CAST(1 AS uint32) as uint32_val,
       CAST(1 AS uint64) as uint64_val,
       CAST("+Inf" AS float) as float_val,
       CAST("-Inf" AS double) as double_val,
       CAST("1" AS string) as str_val,
       CAST("1" AS BYTES) as bytes_val,
       CAST('2014-01-01' AS DATE) as date_val,
       TIMESTAMP '2014-01-01 00:00:01.011011 UTC' as
           timestamp_val,
       RANGE<TIMESTAMP> '[2011-01-01 00:00:00+00, 2011-10-15 00:00:00+00)' as range_timestamp_val,
       RANGE<DATE> '[2011-01-01, 2011-10-15)' as range_date_val
UNION ALL
SELECT CAST(4 AS int64) as row_id,
       CAST(false AS bool) as bool_val,
       CAST(-2 AS int32) as int32_val,
       CAST(-2 AS int64) as int64_val,
       CAST(2 AS uint32) as uint32_val,
       CAST(2 AS uint64) as uint64_val,
       CAST(0.25 AS float) as float_val,
       CAST(pow(0.1, 324) AS double) as double_val, #positive 0 of type double
       CAST("2" AS string) as str_val,
       CAST("2" AS BYTES) as bytes_val,
       CAST('2014-01-02' AS DATE) as date_val,
       TIMESTAMP '2014-01-02 00:00:02.022022 UTC' as
           timestamp_val,
       RANGE<TIMESTAMP> '[2012-01-01 00:00:00+00, 2012-10-15 00:00:00+00)' as range_timestamp_val,
       RANGE<DATE> '[2012-01-01, 2012-10-15)' as range_date_val
UNION ALL
SELECT CAST(5 AS int64) as row_id,
       CAST(false AS bool) as bool_val,
       CAST(-2 AS int32) as int32_val,
       CAST(-2 AS int64) as int64_val,
       CAST(2 AS uint32) as uint32_val,
       CAST(2 AS uint64) as uint64_val,
       CAST("-Inf" AS float) as float_val,
       CAST(0.25 AS double) as double_val,
       CAST("2" AS string) as str_val,
       CAST("2" AS BYTES) as bytes_val,
       CAST('2014-01-02' AS DATE) as date_val,
       TIMESTAMP '2014-01-02 00:00:02.022022 UTC' as
           timestamp_val,
       RANGE<TIMESTAMP> '[2012-01-01 00:00:00+00, 2012-10-15 00:00:00+00)' as range_timestamp_val,
       RANGE<DATE> '[2012-01-01, 2012-10-15)' as range_date_val
UNION ALL
SELECT CAST(6 AS int64) as row_id,
       CAST(true AS bool) as bool_val,
       CAST(-3 AS int32) as int32_val,
       CAST(-3 AS int64) as int64_val,
       CAST(3 AS uint32) as uint32_val,
       CAST(3 AS uint64) as uint64_val,
       CAST(0.375 AS float) as float_val,
       CAST(0.375 AS double) as double_val,
       CAST("3" AS string) as str_val,
       CAST("3" AS BYTES) as bytes_val,
       CAST('2014-01-03' AS DATE) as date_val,
       TIMESTAMP '2014-01-03 00:00:03.033033 UTC' as
           timestamp_val,
       RANGE<TIMESTAMP> '[2013-01-01 00:00:00+00, 2013-10-15 00:00:00+00)' as range_timestamp_val,
       RANGE<DATE> '[2013-01-01, 2013-10-15)' as range_date_val
UNION ALL
SELECT CAST(7 AS int64) as row_id,
       CAST(false AS bool) as bool_val,
       CAST(-4 AS int32) as int32_val,
       CAST(-4 AS int64) as int64_val,
       CAST(4 AS uint32) as uint32_val,
       CAST(4 AS uint64) as uint64_val,
       CAST(0.5 AS float) as float_val,
       CAST(0.5 AS double) as double_val,
       CAST("4" AS string) as str_val,
       CAST("4" AS BYTES) as bytes_val,
       CAST('2014-01-04' AS DATE) as date_val,
       TIMESTAMP '2014-01-04 00:00:04.044044 UTC' as
           timestamp_val,
       RANGE<TIMESTAMP> '[2014-01-01 00:00:00+00, 2014-10-15 00:00:00+00)' as range_timestamp_val,
       RANGE<DATE> '[2014-01-01, 2014-10-15)' as range_date_val
UNION ALL
SELECT CAST(8 AS int64) as row_id,
       CAST(NULL AS bool) as bool_val,
       CAST(NULL AS int32) as int32_val,
       CAST(NULL AS int64) as int64_val,
       CAST(NULL AS uint32) as uint32_val,
       CAST(NULL AS uint64) as uint64_val,
       CAST(NULL AS float) as float_val,
       CAST(NULL AS double) as double_val,
       CAST(NULL AS string) as str_val,
       CAST(NULL AS BYTES) as bytes_val,
       CAST(NULL AS DATE) as date_val,
       CAST(NULL AS TIMESTAMP) as timestamp_val,
       CAST(NULL AS RANGE<TIMESTAMP>) as range_timestamp_val,
       CAST(NULL AS RANGE<DATE>) as range_date_val
UNION ALL
SELECT CAST(9 AS int64) as row_id,
       CAST(NULL AS bool) as bool_val,
       CAST(NULL AS int32) as int32_val,
       CAST(NULL AS int64) as int64_val,
       CAST(NULL AS uint32) as uint32_val,
       CAST(NULL AS uint64) as uint64_val,
       CAST(-pow(0.1, 46) AS float) as float_val, #negative 0 of type float
       CAST("NaN" AS double) as double_val,
       CAST(NULL AS string) as str_val,
       CAST(NULL AS BYTES) as bytes_val,
       CAST(NULL AS DATE) as date_val,
       CAST(NULL AS TIMESTAMP) as timestamp_val,
       CAST(NULL AS RANGE<TIMESTAMP>) as range_timestamp_val,
       CAST(NULL AS RANGE<DATE>) as range_date_val
UNION ALL
SELECT CAST(10 AS int64) as row_id,
       CAST(true AS bool) as bool_val,
       CAST(1 AS int32) as int32_val,
       CAST(1 AS int64) as int64_val,
       CAST(11 AS uint32) as uint32_val,
       CAST(11 AS uint64) as uint64_val,
       CAST(0.625 AS float) as float_val,
       CAST(0.625 AS double) as double_val,
       CAST("6" AS string) as str_val,
       CAST("7" AS BYTES) as bytes_val,
       CAST('2014-01-08' AS DATE) as date_val,
       TIMESTAMP '2014-01-02 00:00:01.011011 UTC' as
           timestamp_val,
       RANGE<TIMESTAMP> '[2011-01-01 00:00:00+00, 2011-10-15 00:00:00+00)' as range_timestamp_val,
       RANGE<DATE> '[2011-01-01, 2011-10-15)' as range_date_val
UNION ALL
SELECT CAST(11 AS int64) as row_id,
       CAST(false AS bool) as bool_val,
       CAST(5 AS int32) as int32_val,
       CAST(3 AS int64) as int64_val,
       CAST(11 AS uint32) as uint32_val,
       CAST(8 AS uint64) as uint64_val,
       CAST(-0.125 AS float) as float_val,
       CAST(-0.125 AS double) as double_val,
       CAST("123" AS string) as str_val,
       CAST("123" AS BYTES) as bytes_val,
       CAST('2014-02-01' AS DATE) as date_val,
       TIMESTAMP '2014-04-01 00:00:01.011011 UTC' as
           timestamp_val,
       RANGE<TIMESTAMP> '[2015-01-01 00:00:00+00, 2015-10-15 00:00:00+00)' as range_timestamp_val,
       RANGE<DATE> '[2013-01-01, 2013-10-15)' as range_date_val
UNION ALL
SELECT CAST(12 AS int64) as row_id,
       CAST(false AS bool) as bool_val,
       CAST(2 AS int32) as int32_val,
       CAST(16 AS int64) as int64_val,
       CAST(5 AS uint32) as uint32_val,
       CAST(9 AS uint64) as uint64_val,
       CAST(0.75 AS float) as float_val,
       CAST(-0.25 AS double) as double_val,
       CAST("24" AS string) as str_val,
       CAST("22" AS BYTES) as bytes_val,
       CAST('2014-02-02' AS DATE) as date_val,
       TIMESTAMP '2014-01-05 00:00:02.022022 UTC' as
           timestamp_val,
       RANGE<TIMESTAMP> '[2012-01-01 00:00:00+00, 2012-10-15 00:00:00+00)' as range_timestamp_val,
       RANGE<DATE> '[2026-01-01, 2026-10-15)' as range_date_val
UNION ALL
SELECT CAST(13 AS int64) as row_id,
       CAST(false AS bool) as bool_val,
       CAST(9 AS int32) as int32_val,
       CAST(9 AS int64) as int64_val,
       CAST(4 AS uint32) as uint32_val,
       CAST(8 AS uint64) as uint64_val,
       CAST(-0.25 AS float) as float_val,
       CAST(-0.75 AS double) as double_val,
       CAST("222" AS string) as str_val,
       CAST("234" AS BYTES) as bytes_val,
       CAST('2014-05-02' AS DATE) as date_val,
       TIMESTAMP '2014-05-02 00:00:02.022022 UTC' as
           timestamp_val,
       RANGE<TIMESTAMP> '[2019-01-01 00:00:00+00, 2019-10-15 00:00:00+00)' as range_timestamp_val,
       RANGE<DATE> '[2019-01-01, 2019-10-15)' as range_date_val
UNION ALL
SELECT CAST(14 AS int64) as row_id,
       CAST(true AS bool) as bool_val,
       CAST(13 AS int32) as int32_val,
       CAST(23 AS int64) as int64_val,
       CAST(31 AS uint32) as uint32_val,
       CAST(32 AS uint64) as uint64_val,
       CAST(-0.375 AS float) as float_val,
       CAST(-0.375 AS double) as double_val,
       CAST("345" AS string) as str_val,
       CAST("345" AS BYTES) as bytes_val,
       CAST('2014-01-06' AS DATE) as date_val,
       TIMESTAMP '2014-01-04 00:00:03.033033 UTC' as
           timestamp_val,
       RANGE<TIMESTAMP> '[UNBOUNDED, 2013-10-15 00:00:00+00)' as range_timestamp_val,
       RANGE<DATE> '[2017-01-01, UNBOUNDED)' as range_date_val
UNION ALL
SELECT CAST(15 AS int64) as row_id,
       CAST(false AS bool) as bool_val,
       CAST(-24 AS int32) as int32_val,
       CAST(-14 AS int64) as int64_val,
       CAST(41 AS uint32) as uint32_val,
       CAST(54 AS uint64) as uint64_val,
       CAST(-0.5 AS float) as float_val,
       CAST(-0.5 AS double) as double_val,
       CAST("432" AS string) as str_val,
       CAST("433" AS BYTES) as bytes_val,
       CAST('2014-02-04' AS DATE) as date_val,
       TIMESTAMP '2014-02-04 00:00:04.044044 UTC' as
           timestamp_val,
       RANGE<TIMESTAMP> '[2017-01-01 00:00:00+00, UNBOUNDED)' as range_timestamp_val,
       RANGE<DATE> '[UNBOUNDED, 2007-10-15)' as range_date_val
UNION ALL
SELECT CAST(16 AS int64) as row_id,
       CAST(false AS bool) as bool_val,
       CAST(NULL AS int32) as int32_val,
       CAST(-1 AS int64) as int64_val,
       CAST(NULL AS uint32) as uint32_val,
       CAST(1 AS uint64) as uint64_val,
       CAST(NULL AS float) as float_val,
       CAST(-pow(0.1, 324) AS double) as double_val, #negative 0 of type double
       CAST(NULL AS string) as str_val,
       CAST("1" AS BYTES) as bytes_val,
       CAST(NULL AS DATE) as date_val,
       TIMESTAMP '2014-02-04 00:00:04.044044 UTC' as
           timestamp_val,
       RANGE<TIMESTAMP> '[2004-01-01 00:00:00+00, 2004-10-15 00:00:00+00)' as range_timestamp_val,
       CAST (NULL AS RANGE<DATE>) as range_date_val
UNION ALL
SELECT CAST(17 AS int64) as row_id,
       CAST(NULL AS bool) as bool_val,
       CAST(-1 AS int32) as int32_val,
       CAST(NULL AS int64) as int64_val,
       CAST(1 AS uint32) as uint32_val,
       CAST(NULL AS uint64) as uint64_val,
       CAST(pow(0.1, 46) AS float) as float_val, #positive 0 of type float
       CAST(NULL AS double) as double_val,
       CAST("1" AS string) as str_val,
       CAST(NULL AS BYTES) as bytes_val,
       CAST('2014-02-04' AS DATE) as date_val,
       CAST(NULL AS TIMESTAMP) as timestamp_val,
       CAST (NULL AS RANGE<TIMESTAMP>) as range_timestamp_val,
       RANGE<DATE> '[2007-01-01, 2007-10-15)' as range_date_val
--
ARRAY<STRUCT<
        row_id INT64,
        bool_val BOOL,
        int32_val INT32,
        int64_val INT64,
        uint32_val UINT32,
        uint64_val UINT64,
        float_val FLOAT,
        double_val DOUBLE,
        str_val STRING,
        bytes_val BYTES,
        date_val DATE,
        timestamp_val TIMESTAMP,
        range_timestamp_val RANGE<TIMESTAMP>,
        range_date_val RANGE<DATE>
      >>
[
  {1,
   true,
   -1,
   -1,
   1,
   1,
   0.125,
   0.125,
   "1",
   b"1",
   2014-01-01,
   2014-01-01 00:00:01.011011+00,
   [
     2011-01-01 00:00:00+00,
     2011-10-15 00:00:00+00
   ),
   [2011-01-01, 2011-10-15)},
  {2,
   true,
   -1,
   -1,
   1,
   1,
   nan,
   inf,
   "1",
   b"1",
   2014-01-01,
   2014-01-01 00:00:01.011011+00,
   [
     2011-01-01 00:00:00+00,
     2011-10-15 00:00:00+00
   ),
   [2011-01-01, 2011-10-15)},
  {3,
   true,
   -1,
   -1,
   1,
   1,
   inf,
   -inf,
   "1",
   b"1",
   2014-01-01,
   2014-01-01 00:00:01.011011+00,
   [
     2011-01-01 00:00:00+00,
     2011-10-15 00:00:00+00
   ),
   [2011-01-01, 2011-10-15)},
  {4,
   false,
   -2,
   -2,
   2,
   2,
   0.25,
   0,
   "2",
   b"2",
   2014-01-02,
   2014-01-02 00:00:02.022022+00,
   [
     2012-01-01 00:00:00+00,
     2012-10-15 00:00:00+00
   ),
   [2012-01-01, 2012-10-15)},
  {5,
   false,
   -2,
   -2,
   2,
   2,
   -inf,
   0.25,
   "2",
   b"2",
   2014-01-02,
   2014-01-02 00:00:02.022022+00,
   [
     2012-01-01 00:00:00+00,
     2012-10-15 00:00:00+00
   ),
   [2012-01-01, 2012-10-15)},
  {6,
   true,
   -3,
   -3,
   3,
   3,
   0.375,
   0.375,
   "3",
   b"3",
   2014-01-03,
   2014-01-03 00:00:03.033033+00,
   [
     2013-01-01 00:00:00+00,
     2013-10-15 00:00:00+00
   ),
   [2013-01-01, 2013-10-15)},
  {7,
   false,
   -4,
   -4,
   4,
   4,
   0.5,
   0.5,
   "4",
   b"4",
   2014-01-04,
   2014-01-04 00:00:04.044044+00,
   [
     2014-01-01 00:00:00+00,
     2014-10-15 00:00:00+00
   ),
   [2014-01-01, 2014-10-15)},
  {8,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL,
   NULL},
  {9, NULL, NULL, NULL, NULL, NULL, -0, nan, NULL, NULL, NULL, NULL, NULL, NULL},
  {10,
   true,
   1,
   1,
   11,
   11,
   0.625,
   0.625,
   "6",
   b"7",
   2014-01-08,
   2014-01-02 00:00:01.011011+00,
   [
     2011-01-01 00:00:00+00,
     2011-10-15 00:00:00+00
   ),
   [2011-01-01, 2011-10-15)},
  {11,
   false,
   5,
   3,
   11,
   8,
   -0.125,
   -0.125,
   "123",
   b"123",
   2014-02-01,
   2014-04-01 00:00:01.011011+00,
   [
     2015-01-01 00:00:00+00,
     2015-10-15 00:00:00+00
   ),
   [2013-01-01, 2013-10-15)},
  {12,
   false,
   2,
   16,
   5,
   9,
   0.75,
   -0.25,
   "24",
   b"22",
   2014-02-02,
   2014-01-05 00:00:02.022022+00,
   [
     2012-01-01 00:00:00+00,
     2012-10-15 00:00:00+00
   ),
   [2026-01-01, 2026-10-15)},
  {13,
   false,
   9,
   9,
   4,
   8,
   -0.25,
   -0.75,
   "222",
   b"234",
   2014-05-02,
   2014-05-02 00:00:02.022022+00,
   [
     2019-01-01 00:00:00+00,
     2019-10-15 00:00:00+00
   ),
   [2019-01-01, 2019-10-15)},
  {14,
   true,
   13,
   23,
   31,
   32,
   -0.375,
   -0.375,
   "345",
   b"345",
   2014-01-06,
   2014-01-04 00:00:03.033033+00,
   [
     NULL,
     2013-10-15 00:00:00+00
   ),
   [2017-01-01, NULL)},
  {15,
   false,
   -24,
   -14,
   41,
   54,
   -0.5,
   -0.5,
   "432",
   b"433",
   2014-02-04,
   2014-02-04 00:00:04.044044+00,
   [
     2017-01-01 00:00:00+00,
     NULL
   ),
   [NULL, 2007-10-15)},
  {16,
   false,
   NULL,
   -1,
   NULL,
   1,
   NULL,
   -0,
   NULL,
   b"1",
   NULL,
   2014-02-04 00:00:04.044044+00,
   [
     2004-01-01 00:00:00+00,
     2004-10-15 00:00:00+00
   ),
   NULL},
  {
    17,
    NULL,
    -1,
    NULL,
    1,
    NULL,
    0,
    NULL,
    "1",
    NULL,
    2014-02-04,
    NULL,
    NULL,
    [2007-01-01, 2007-10-15)
  }
]
==
[prepare_database]
[required_features=RANGE_TYPE,V_1_2_CIVIL_TIME]
CREATE TABLE AllTypesRangeDatetimeTable AS
SELECT CAST(1 AS int64) as row_id,
       CAST(true AS bool) as bool_val,
       CAST(-1 AS int32) as int32_val,
       CAST(-1 AS int64) as int64_val,
       CAST(1 AS uint32) as uint32_val,
       CAST(1 AS uint64) as uint64_val,
       CAST(0.125 AS float) as float_val,
       CAST(0.125 AS double) as double_val,
       CAST("1" AS string) as str_val,
       CAST("1" AS BYTES) as bytes_val,
       CAST('2014-01-01' AS DATE) as date_val,
       TIMESTAMP '2014-01-01 00:00:01.011011 UTC' as
           timestamp_val,
       RANGE<DATETIME> '[2011-01-01 00:00:00, 2011-10-15 00:00:00)' as range_datetime_val
UNION ALL
SELECT CAST(2 AS int64) as row_id,
       CAST(true AS bool) as bool_val,
       CAST(-1 AS int32) as int32_val,
       CAST(-1 AS int64) as int64_val,
       CAST(1 AS uint32) as uint32_val,
       CAST(1 AS uint64) as uint64_val,
       CAST("NaN" AS float) as float_val,
       CAST("+Inf" AS double) as double_val,
       CAST("1" AS string) as str_val,
       CAST("1" AS BYTES) as bytes_val,
       CAST('2014-01-01' AS DATE) as date_val,
       TIMESTAMP '2014-01-01 00:00:01.011011 UTC' as
           timestamp_val,
       RANGE<DATETIME> '[2011-01-01 00:00:00, 2011-10-15 00:00:00)' as range_datetime_val
UNION ALL
SELECT CAST(3 AS int64) as row_id,
       CAST(true AS bool) as bool_val,
       CAST(-1 AS int32) as int32_val,
       CAST(-1 AS int64) as int64_val,
       CAST(1 AS uint32) as uint32_val,
       CAST(1 AS uint64) as uint64_val,
       CAST("+Inf" AS float) as float_val,
       CAST("-Inf" AS double) as double_val,
       CAST("1" AS string) as str_val,
       CAST("1" AS BYTES) as bytes_val,
       CAST('2014-01-01' AS DATE) as date_val,
       TIMESTAMP '2014-01-01 00:00:01.011011 UTC' as
           timestamp_val,
       RANGE<DATETIME> '[2011-01-01 00:00:00, 2011-10-15 00:00:00)' as range_datetime_val
UNION ALL
SELECT CAST(4 AS int64) as row_id,
       CAST(false AS bool) as bool_val,
       CAST(-2 AS int32) as int32_val,
       CAST(-2 AS int64) as int64_val,
       CAST(2 AS uint32) as uint32_val,
       CAST(2 AS uint64) as uint64_val,
       CAST(0.25 AS float) as float_val,
       CAST(pow(0.1, 324) AS double) as double_val, #positive 0 of type double
       CAST("2" AS string) as str_val,
       CAST("2" AS BYTES) as bytes_val,
       CAST('2014-01-02' AS DATE) as date_val,
       TIMESTAMP '2014-01-02 00:00:02.022022 UTC' as
           timestamp_val,
       RANGE<DATETIME> '[2012-01-01 00:00:00, 2012-10-15 00:00:00)' as range_datetime_val
UNION ALL
SELECT CAST(5 AS int64) as row_id,
       CAST(false AS bool) as bool_val,
       CAST(-2 AS int32) as int32_val,
       CAST(-2 AS int64) as int64_val,
       CAST(2 AS uint32) as uint32_val,
       CAST(2 AS uint64) as uint64_val,
       CAST("-Inf" AS float) as float_val,
       CAST(0.25 AS double) as double_val,
       CAST("2" AS string) as str_val,
       CAST("2" AS BYTES) as bytes_val,
       CAST('2014-01-02' AS DATE) as date_val,
       TIMESTAMP '2014-01-02 00:00:02.022022 UTC' as
           timestamp_val,
       RANGE<DATETIME> '[2012-01-01 00:00:00, 2012-10-15 00:00:00)' as range_datetime_val
UNION ALL
SELECT CAST(6 AS int64) as row_id,
       CAST(true AS bool) as bool_val,
       CAST(-3 AS int32) as int32_val,
       CAST(-3 AS int64) as int64_val,
       CAST(3 AS uint32) as uint32_val,
       CAST(3 AS uint64) as uint64_val,
       CAST(0.375 AS float) as float_val,
       CAST(0.375 AS double) as double_val,
       CAST("3" AS string) as str_val,
       CAST("3" AS BYTES) as bytes_val,
       CAST('2014-01-03' AS DATE) as date_val,
       TIMESTAMP '2014-01-03 00:00:03.033033 UTC' as
           timestamp_val,
       RANGE<DATETIME> '[2013-01-01 00:00:00, 2013-10-15 00:00:00)' as range_datetime_val
UNION ALL
SELECT CAST(7 AS int64) as row_id,
       CAST(false AS bool) as bool_val,
       CAST(-4 AS int32) as int32_val,
       CAST(-4 AS int64) as int64_val,
       CAST(4 AS uint32) as uint32_val,
       CAST(4 AS uint64) as uint64_val,
       CAST(0.5 AS float) as float_val,
       CAST(0.5 AS double) as double_val,
       CAST("4" AS string) as str_val,
       CAST("4" AS BYTES) as bytes_val,
       CAST('2014-01-04' AS DATE) as date_val,
       TIMESTAMP '2014-01-04 00:00:04.044044 UTC' as
           timestamp_val,
       RANGE<DATETIME> '[2014-01-01 00:00:00, 2014-10-15 00:00:00)' as range_datetime_val
UNION ALL
SELECT CAST(8 AS int64) as row_id,
       CAST(NULL AS bool) as bool_val,
       CAST(NULL AS int32) as int32_val,
       CAST(NULL AS int64) as int64_val,
       CAST(NULL AS uint32) as uint32_val,
       CAST(NULL AS uint64) as uint64_val,
       CAST(NULL AS float) as float_val,
       CAST(NULL AS double) as double_val,
       CAST(NULL AS string) as str_val,
       CAST(NULL AS BYTES) as bytes_val,
       CAST(NULL AS DATE) as date_val,
       CAST(NULL AS TIMESTAMP) as timestamp_val,
       CAST(NULL AS RANGE<DATETIME>) as range_datetime_val
UNION ALL
SELECT CAST(9 AS int64) as row_id,
       CAST(NULL AS bool) as bool_val,
       CAST(NULL AS int32) as int32_val,
       CAST(NULL AS int64) as int64_val,
       CAST(NULL AS uint32) as uint32_val,
       CAST(NULL AS uint64) as uint64_val,
       CAST(-pow(0.1, 46) AS float) as float_val, #negative 0 of type float
       CAST("NaN" AS double) as double_val,
       CAST(NULL AS string) as str_val,
       CAST(NULL AS BYTES) as bytes_val,
       CAST(NULL AS DATE) as date_val,
       CAST(NULL AS TIMESTAMP) as timestamp_val,
       CAST(NULL AS RANGE<DATETIME>) as range_datetime_val
UNION ALL
SELECT CAST(10 AS int64) as row_id,
       CAST(true AS bool) as bool_val,
       CAST(1 AS int32) as int32_val,
       CAST(1 AS int64) as int64_val,
       CAST(11 AS uint32) as uint32_val,
       CAST(11 AS uint64) as uint64_val,
       CAST(0.625 AS float) as float_val,
       CAST(0.625 AS double) as double_val,
       CAST("6" AS string) as str_val,
       CAST("7" AS BYTES) as bytes_val,
       CAST('2014-01-08' AS DATE) as date_val,
       TIMESTAMP '2014-01-02 00:00:01.011011 UTC' as
           timestamp_val,
       RANGE<DATETIME> '[2011-01-01 00:00:00, 2011-10-15 00:00:00)' as range_datetime_val
UNION ALL
SELECT CAST(11 AS int64) as row_id,
       CAST(false AS bool) as bool_val,
       CAST(5 AS int32) as int32_val,
       CAST(3 AS int64) as int64_val,
       CAST(11 AS uint32) as uint32_val,
       CAST(8 AS uint64) as uint64_val,
       CAST(-0.125 AS float) as float_val,
       CAST(-0.125 AS double) as double_val,
       CAST("123" AS string) as str_val,
       CAST("123" AS BYTES) as bytes_val,
       CAST('2014-02-01' AS DATE) as date_val,
       TIMESTAMP '2014-04-01 00:00:01.011011 UTC' as
           timestamp_val,
       RANGE<DATETIME> '[2015-01-01 00:00:00, 2015-10-15 00:00:00)' as range_datetime_val
UNION ALL
SELECT CAST(12 AS int64) as row_id,
       CAST(false AS bool) as bool_val,
       CAST(2 AS int32) as int32_val,
       CAST(16 AS int64) as int64_val,
       CAST(5 AS uint32) as uint32_val,
       CAST(9 AS uint64) as uint64_val,
       CAST(0.75 AS float) as float_val,
       CAST(-0.25 AS double) as double_val,
       CAST("24" AS string) as str_val,
       CAST("22" AS BYTES) as bytes_val,
       CAST('2014-02-02' AS DATE) as date_val,
       TIMESTAMP '2014-01-05 00:00:02.022022 UTC' as
           timestamp_val,
       RANGE<DATETIME> '[2012-01-01 00:00:00, 2012-10-15 00:00:00)' as range_datetime_val
UNION ALL
SELECT CAST(13 AS int64) as row_id,
       CAST(false AS bool) as bool_val,
       CAST(9 AS int32) as int32_val,
       CAST(9 AS int64) as int64_val,
       CAST(4 AS uint32) as uint32_val,
       CAST(8 AS uint64) as uint64_val,
       CAST(-0.25 AS float) as float_val,
       CAST(-0.75 AS double) as double_val,
       CAST("222" AS string) as str_val,
       CAST("234" AS BYTES) as bytes_val,
       CAST('2014-05-02' AS DATE) as date_val,
       TIMESTAMP '2014-05-02 00:00:02.022022 UTC' as
           timestamp_val,
       RANGE<DATETIME> '[2019-01-01 00:00:00, 2019-10-15 00:00:00)' as range_datetime_val
UNION ALL
SELECT CAST(14 AS int64) as row_id,
       CAST(true AS bool) as bool_val,
       CAST(13 AS int32) as int32_val,
       CAST(23 AS int64) as int64_val,
       CAST(31 AS uint32) as uint32_val,
       CAST(32 AS uint64) as uint64_val,
       CAST(-0.375 AS float) as float_val,
       CAST(-0.375 AS double) as double_val,
       CAST("345" AS string) as str_val,
       CAST("345" AS BYTES) as bytes_val,
       CAST('2014-01-06' AS DATE) as date_val,
       TIMESTAMP '2014-01-04 00:00:03.033033 UTC' as
           timestamp_val,
       RANGE<DATETIME> '[UNBOUNDED, 2013-10-15 00:00:00)' as range_datetime_val
UNION ALL
SELECT CAST(15 AS int64) as row_id,
       CAST(false AS bool) as bool_val,
       CAST(-24 AS int32) as int32_val,
       CAST(-14 AS int64) as int64_val,
       CAST(41 AS uint32) as uint32_val,
       CAST(54 AS uint64) as uint64_val,
       CAST(-0.5 AS float) as float_val,
       CAST(-0.5 AS double) as double_val,
       CAST("432" AS string) as str_val,
       CAST("433" AS BYTES) as bytes_val,
       CAST('2014-02-04' AS DATE) as date_val,
       TIMESTAMP '2014-02-04 00:00:04.044044 UTC' as
           timestamp_val,
       RANGE<DATETIME> '[2017-01-01 00:00:00, UNBOUNDED)' as range_datetime_val
UNION ALL
SELECT CAST(16 AS int64) as row_id,
       CAST(false AS bool) as bool_val,
       CAST(NULL AS int32) as int32_val,
       CAST(-1 AS int64) as int64_val,
       CAST(NULL AS uint32) as uint32_val,
       CAST(1 AS uint64) as uint64_val,
       CAST(NULL AS float) as float_val,
       CAST(-pow(0.1, 324) AS double) as double_val, #negative 0 of type double
       CAST(NULL AS string) as str_val,
       CAST("1" AS BYTES) as bytes_val,
       CAST(NULL AS DATE) as date_val,
       TIMESTAMP '2014-02-04 00:00:04.044044 UTC' as
           timestamp_val,
       RANGE<DATETIME> '[2004-01-01 00:00:00, 2004-10-15 00:00:00)' as range_datetime_val
UNION ALL
SELECT CAST(17 AS int64) as row_id,
       CAST(NULL AS bool) as bool_val,
       CAST(-1 AS int32) as int32_val,
       CAST(NULL AS int64) as int64_val,
       CAST(1 AS uint32) as uint32_val,
       CAST(NULL AS uint64) as uint64_val,
       CAST(pow(0.1, 46) AS float) as float_val, #positive 0 of type float
       CAST(NULL AS double) as double_val,
       CAST("1" AS string) as str_val,
       CAST(NULL AS BYTES) as bytes_val,
       CAST('2014-02-04' AS DATE) as date_val,
       CAST(NULL AS TIMESTAMP) as timestamp_val,
       CAST (NULL AS RANGE<DATETIME>) as range_datetime_val
--
ARRAY<STRUCT<
        row_id INT64,
        bool_val BOOL,
        int32_val INT32,
        int64_val INT64,
        uint32_val UINT32,
        uint64_val UINT64,
        float_val FLOAT,
        double_val DOUBLE,
        str_val STRING,
        bytes_val BYTES,
        date_val DATE,
        timestamp_val TIMESTAMP,
        range_datetime_val RANGE<DATETIME>
      >>
[{
   1,
   true,
   -1,
   -1,
   1,
   1,
   0.125,
   0.125,
   "1",
   b"1",
   2014-01-01,
   2014-01-01 00:00:01.011011+00,
   [2011-01-01 00:00:00, 2011-10-15 00:00:00)
 },
 {
   2,
   true,
   -1,
   -1,
   1,
   1,
   nan,
   inf,
   "1",
   b"1",
   2014-01-01,
   2014-01-01 00:00:01.011011+00,
   [2011-01-01 00:00:00, 2011-10-15 00:00:00)
 },
 {
   3,
   true,
   -1,
   -1,
   1,
   1,
   inf,
   -inf,
   "1",
   b"1",
   2014-01-01,
   2014-01-01 00:00:01.011011+00,
   [2011-01-01 00:00:00, 2011-10-15 00:00:00)
 },
 {
   4,
   false,
   -2,
   -2,
   2,
   2,
   0.25,
   0,
   "2",
   b"2",
   2014-01-02,
   2014-01-02 00:00:02.022022+00,
   [2012-01-01 00:00:00, 2012-10-15 00:00:00)
 },
 {
   5,
   false,
   -2,
   -2,
   2,
   2,
   -inf,
   0.25,
   "2",
   b"2",
   2014-01-02,
   2014-01-02 00:00:02.022022+00,
   [2012-01-01 00:00:00, 2012-10-15 00:00:00)
 },
 {
   6,
   true,
   -3,
   -3,
   3,
   3,
   0.375,
   0.375,
   "3",
   b"3",
   2014-01-03,
   2014-01-03 00:00:03.033033+00,
   [2013-01-01 00:00:00, 2013-10-15 00:00:00)
 },
 {
   7,
   false,
   -4,
   -4,
   4,
   4,
   0.5,
   0.5,
   "4",
   b"4",
   2014-01-04,
   2014-01-04 00:00:04.044044+00,
   [2014-01-01 00:00:00, 2014-10-15 00:00:00)
 },
 {8, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL},
 {9, NULL, NULL, NULL, NULL, NULL, -0, nan, NULL, NULL, NULL, NULL, NULL},
 {
   10,
   true,
   1,
   1,
   11,
   11,
   0.625,
   0.625,
   "6",
   b"7",
   2014-01-08,
   2014-01-02 00:00:01.011011+00,
   [2011-01-01 00:00:00, 2011-10-15 00:00:00)
 },
 {
   11,
   false,
   5,
   3,
   11,
   8,
   -0.125,
   -0.125,
   "123",
   b"123",
   2014-02-01,
   2014-04-01 00:00:01.011011+00,
   [2015-01-01 00:00:00, 2015-10-15 00:00:00)
 },
 {
   12,
   false,
   2,
   16,
   5,
   9,
   0.75,
   -0.25,
   "24",
   b"22",
   2014-02-02,
   2014-01-05 00:00:02.022022+00,
   [2012-01-01 00:00:00, 2012-10-15 00:00:00)
 },
 {
   13,
   false,
   9,
   9,
   4,
   8,
   -0.25,
   -0.75,
   "222",
   b"234",
   2014-05-02,
   2014-05-02 00:00:02.022022+00,
   [2019-01-01 00:00:00, 2019-10-15 00:00:00)
 },
 {
   14,
   true,
   13,
   23,
   31,
   32,
   -0.375,
   -0.375,
   "345",
   b"345",
   2014-01-06,
   2014-01-04 00:00:03.033033+00,
   [NULL, 2013-10-15 00:00:00)
 },
 {
   15,
   false,
   -24,
   -14,
   41,
   54,
   -0.5,
   -0.5,
   "432",
   b"433",
   2014-02-04,
   2014-02-04 00:00:04.044044+00,
   [2017-01-01 00:00:00, NULL)
 },
 {
   16,
   false,
   NULL,
   -1,
   NULL,
   1,
   NULL,
   -0,
   NULL,
   b"1",
   NULL,
   2014-02-04 00:00:04.044044+00,
   [2004-01-01 00:00:00, 2004-10-15 00:00:00)
 },
 {17, NULL, -1, NULL, 1, NULL, 0, NULL, "1", NULL, 2014-02-04, NULL, NULL}]
==
# ORDER BY on one output column and one computed column. Extra column selected.
[name=orderby_1]
SELECT * FROM (SELECT -2 a, 5 b UNION ALL SELECT 2, 7) t ORDER BY a DESC, a+5
--
ARRAY<STRUCT<a INT64, b INT64>>[known order:{2, 7}, {-2, 5}]
==
# All rows agree on the first part of the computed key (a*a). Second part 'b'
# matters.
[name=orderby_2]
SELECT * FROM (SELECT -2 a, 5 b UNION ALL SELECT 2, 7) t ORDER BY a*a, b DESC
--
ARRAY<STRUCT<a INT64, b INT64>>[known order:{2, 7}, {-2, 5}]
==
# NULL sorts first if ASC.
[name=orderby_3]
SELECT * FROM (SELECT 1 x UNION ALL SELECT NULL) ORDER BY x ASC
--
ARRAY<STRUCT<x INT64>>[known order:{NULL}, {1}]
==
# NULL sorts last if DESC.
[name=orderby_4]
SELECT * FROM (SELECT 1 x UNION ALL SELECT NULL) ORDER BY x DESC
--
ARRAY<STRUCT<x INT64>>[known order:{1}, {NULL}]
==
# Duplicate columns in the SELECT list.  Note that the ORDER BY cannot
# reference a SELECT list alias if two different SELECT list expressions
# have that same alias.
[name=orderby_5]
SELECT x, x x1 FROM (SELECT 1 x) ORDER BY x1, x
--
ARRAY<STRUCT<x INT64, x1 INT64>>[{1, 1}]
==
# Duplicate columns in ORDER BY
[name=orderby_duplicate_columns_in_by]
SELECT x FROM (SELECT 1 x) ORDER BY x, x
--
ARRAY<STRUCT<x INT64>>[{1}]
==
# "DESC" needs to be examined even though the column can be ignored.
[name=orderby_duplicate_columns_in_by_desc]
SELECT x FROM (SELECT 1 x) ORDER BY x, x DESC
--
ARRAY<STRUCT<x INT64>>[{1}]
==
#
# Single base table column ascending
#
[name=orderby_single_base_column_bool_asc]
SELECT bool_val, int32_val, row_id FROM AllTypesTable t
WHERE row_id IN (1, 4, 8)
ORDER BY bool_val ASC
--
ARRAY<STRUCT<bool_val BOOL, int32_val INT32, row_id INT64>>[known order:
  {NULL, NULL, 8},
  {false, -2, 4},
  {true, -1, 1}
]
==
[name=orderby_single_base_column_int32_asc]
SELECT int32_val, int64_val, row_id FROM AllTypesTable t
WHERE row_id NOT IN (2, 3, 5, 9, 16, 17)
ORDER BY int32_val ASC
--
ARRAY<STRUCT<int32_val INT32, int64_val INT64, row_id INT64>>[known order:
  {NULL, NULL, 8},
  {-24, -14, 15},
  {-4, -4, 7},
  {-3, -3, 6},
  {-2, -2, 4},
  {-1, -1, 1},
  {1, 1, 10},
  {2, 16, 12},
  {5, 3, 11},
  {9, 9, 13},
  {13, 23, 14}
]
==
[name=orderby_single_base_column_int64_asc]
SELECT int64_val, uint32_val, row_id FROM AllTypesTable t
WHERE row_id NOT IN (2, 3, 5, 9, 16, 17)
ORDER BY int64_val ASC
--
ARRAY<STRUCT<int64_val INT64, uint32_val UINT32, row_id INT64>>[known order:
  {NULL, NULL, 8},
  {-14, 41, 15},
  {-4, 4, 7},
  {-3, 3, 6},
  {-2, 2, 4},
  {-1, 1, 1},
  {1, 11, 10},
  {3, 11, 11},
  {9, 4, 13},
  {16, 5, 12},
  {23, 31, 14}
]
==
[name=orderby_single_base_column_uint32_asc]
SELECT uint32_val, uint64_val, row_id FROM AllTypesTable t
WHERE row_id NOT IN (2, 3, 5, 9, 10, 13, 16, 17)
ORDER BY uint32_val ASC
--
ARRAY<STRUCT<uint32_val UINT32, uint64_val UINT64, row_id INT64>>[known order:
  {NULL, NULL, 8},
  {1, 1, 1},
  {2, 2, 4},
  {3, 3, 6},
  {4, 4, 7},
  {5, 9, 12},
  {11, 8, 11},
  {31, 32, 14},
  {41, 54, 15}
]
==
[name=orderby_single_base_column_uint64_asc]
SELECT uint64_val, float_val, row_id FROM AllTypesTable t
WHERE row_id NOT IN (2, 3, 5, 9, 13, 16, 17)
ORDER BY uint64_val ASC
--
ARRAY<STRUCT<uint64_val UINT64, float_val FLOAT, row_id INT64>>[known order:
  {NULL, NULL, 8},
  {1, 0.125, 1},
  {2, 0.25, 4},
  {3, 0.375, 6},
  {4, 0.5, 7},
  {8, -0.125, 11},
  {9, 0.75, 12},
  {11, 0.625, 10},
  {32, -0.375, 14},
  {54, -0.5, 15}
]
==
[name=orderby_single_base_column_float_asc]
SELECT float_val, double_val, row_id FROM AllTypesTable t ORDER BY float_val ASC
--
ARRAY<STRUCT<float_val FLOAT, double_val DOUBLE, row_id INT64>>[unknown order:
  {NULL, NULL, 8},
  {NULL, -0, 16},
  {nan, inf, 2},
  {-inf, 0.25, 5},
  {-0.5, -0.5, 15},
  {-0.375, -0.375, 14},
  {-0.25, -0.75, 13},
  {-0.125, -0.125, 11},
  {-0, nan, 9},
  {0, NULL, 17},
  {0.125, 0.125, 1},
  {0.25, 0, 4},
  {0.375, 0.375, 6},
  {0.5, 0.5, 7},
  {0.625, 0.625, 10},
  {0.75, -0.25, 12},
  {inf, -inf, 3}
]
==
[name=orderby_single_base_column_double_asc]
SELECT double_val, str_val, row_id FROM AllTypesTable t ORDER BY double_val ASC
--
ARRAY<STRUCT<double_val DOUBLE, str_val STRING, row_id INT64>>[unknown order:
  {NULL, NULL, 8},
  {NULL, "1", 17},
  {nan, NULL, 9},
  {-inf, "1", 3},
  {-0.75, "222", 13},
  {-0.5, "432", 15},
  {-0.375, "345", 14},
  {-0.25, "24", 12},
  {-0.125, "123", 11},
  {0, "2", 4},
  {-0, NULL, 16},
  {0.125, "1", 1},
  {0.25, "2", 5},
  {0.375, "3", 6},
  {0.5, "4", 7},
  {0.625, "6", 10},
  {inf, "1", 2}
]
==
[name=orderby_single_base_column_str_asc]
SELECT str_val, bytes_val, row_id FROM AllTypesTable t
WHERE row_id NOT IN (2, 3, 5, 9, 16, 17)
ORDER BY str_val ASC
--
ARRAY<STRUCT<str_val STRING, bytes_val BYTES, row_id INT64>>[known order:
  {NULL, NULL, 8},
  {"1", b"1", 1},
  {"123", b"123", 11},
  {"2", b"2", 4},
  {"222", b"234", 13},
  {"24", b"22", 12},
  {"3", b"3", 6},
  {"345", b"345", 14},
  {"4", b"4", 7},
  {"432", b"433", 15},
  {"6", b"7", 10}
]
==
[name=orderby_single_base_column_bytes_asc]
SELECT bytes_val, date_val, row_id FROM AllTypesTable t
WHERE row_id NOT IN (2, 3, 5, 9, 16, 17)
ORDER BY bytes_val ASC
--
ARRAY<STRUCT<bytes_val BYTES, date_val DATE, row_id INT64>>[known order:
  {NULL, NULL, 8},
  {b"1", 2014-01-01, 1},
  {b"123", 2014-02-01, 11},
  {b"2", 2014-01-02, 4},
  {b"22", 2014-02-02, 12},
  {b"234", 2014-05-02, 13},
  {b"3", 2014-01-03, 6},
  {b"345", 2014-01-06, 14},
  {b"4", 2014-01-04, 7},
  {b"433", 2014-02-04, 15},
  {b"7", 2014-01-08, 10}
]
==
[name=orderby_single_base_column_date_asc]
SELECT date_val, timestamp_val, row_id FROM AllTypesTable t
WHERE row_id NOT IN (2, 3, 5, 9, 16)
ORDER BY date_val ASC
--
ARRAY<STRUCT<
        date_val DATE,
        timestamp_val TIMESTAMP,
        row_id INT64
      >>
[unknown order:{NULL, NULL, 8},
               {
                 2014-01-01,
                 2014-01-01 00:00:01.011011+00,
                 1
               },
               {
                 2014-01-02,
                 2014-01-02 00:00:02.022022+00,
                 4
               },
               {
                 2014-01-03,
                 2014-01-03 00:00:03.033033+00,
                 6
               },
               {
                 2014-01-04,
                 2014-01-04 00:00:04.044044+00,
                 7
               },
               {
                 2014-01-06,
                 2014-01-04 00:00:03.033033+00,
                 14
               },
               {
                 2014-01-08,
                 2014-01-02 00:00:01.011011+00,
                 10
               },
               {
                 2014-02-01,
                 2014-04-01 00:00:01.011011+00,
                 11
               },
               {
                 2014-02-02,
                 2014-01-05 00:00:02.022022+00,
                 12
               },
               {2014-02-04, NULL, 17},
               {
                 2014-02-04,
                 2014-02-04 00:00:04.044044+00,
                 15
               },
               {
                 2014-05-02,
                 2014-05-02 00:00:02.022022+00,
                 13
               }]
==
[name=orderby_single_base_column_timestamp_asc]
SELECT timestamp_val, date_val, row_id FROM AllTypesTable t
WHERE row_id NOT IN (2, 3, 5, 9, 16, 17)
ORDER BY timestamp_val ASC
--
ARRAY<STRUCT<
        timestamp_val TIMESTAMP,
        date_val DATE,
        row_id INT64
      >>
[known order:{NULL, NULL, 8},
             {
               2014-01-01 00:00:01.011011+00,
               2014-01-01,
               1
             },
             {
               2014-01-02 00:00:01.011011+00,
               2014-01-08,
               10
             },
             {
               2014-01-02 00:00:02.022022+00,
               2014-01-02,
               4
             },
             {
               2014-01-03 00:00:03.033033+00,
               2014-01-03,
               6
             },
             {
               2014-01-04 00:00:03.033033+00,
               2014-01-06,
               14
             },
             {
               2014-01-04 00:00:04.044044+00,
               2014-01-04,
               7
             },
             {
               2014-01-05 00:00:02.022022+00,
               2014-02-02,
               12
             },
             {
               2014-02-04 00:00:04.044044+00,
               2014-02-04,
               15
             },
             {
               2014-04-01 00:00:01.011011+00,
               2014-02-01,
               11
             },
             {
               2014-05-02 00:00:02.022022+00,
               2014-05-02,
               13
             }]
==
[required_features=NUMERIC_TYPE]
[name=orderby_single_base_column_numeric_asc]
SELECT numeric_val, int64_val, row_id FROM AllTypesNumericTable t
WHERE row_id NOT IN (2, 3, 5, 9, 16, 17)
ORDER BY numeric_val ASC
--
ARRAY<STRUCT<numeric_val NUMERIC, int64_val INT64, row_id INT64>>[unknown order:
  {NULL, NULL, 8},
  {-123456789.123456789, -14, 15},
  {-1000.10101, 9, 13},
  {-5.34, 3, 11},
  {1, 1, 10},
  {1, -1, 1},
  {2, -2, 4},
  {3, -3, 6},
  {4, -4, 7},
  {222, 23, 14},
  {999.999, 16, 12}
]
==
[required_features=BIGNUMERIC_TYPE]
[name=orderby_single_base_column_bignumeric_asc]
SELECT bignumeric_val, int64_val, row_id FROM AllTypesBigNumericTable t
WHERE row_id NOT IN (2, 3, 5, 9, 16, 17)
ORDER BY bignumeric_val ASC
--
ARRAY<STRUCT<
        bignumeric_val BIGNUMERIC,
        int64_val INT64,
        row_id INT64
      >>
[unknown order:{NULL, NULL, 8},
               {
                 -123456789.1234567890123456789,
                 -14,
                 15
               },
               {
                 -1000.0000000000000000001,
                 9,
                 13
               },
               {-5.34, 3, 11},
               {1, 1, 10},
               {1, -1, 1},
               {2, -2, 4},
               {3, -3, 6},
               {4, -4, 7},
               {222, 23, 14},
               {
                 999.9999999999999999999,
                 16,
                 12
               }]
==
[required_features=RANGE_TYPE]
[name=orderby_single_base_column_range_timestamp_asc]
SELECT range_timestamp_val, int64_val, row_id FROM AllTypesRangeTable t
WHERE row_id NOT IN (2, 3, 5, 9, 10, 12, 16, 17)
ORDER BY range_timestamp_val ASC
--
ARRAY<STRUCT<
        range_timestamp_val RANGE<TIMESTAMP>,
        int64_val INT64,
        row_id INT64
      >>
[known order:{NULL, NULL, 8},
             {[
                NULL,
                2013-10-15 00:00:00+00
              ),
              23,
              14},
             {[
                2011-01-01 00:00:00+00,
                2011-10-15 00:00:00+00
              ),
              -1,
              1},
             {[
                2012-01-01 00:00:00+00,
                2012-10-15 00:00:00+00
              ),
              -2,
              4},
             {[
                2013-01-01 00:00:00+00,
                2013-10-15 00:00:00+00
              ),
              -3,
              6},
             {[
                2014-01-01 00:00:00+00,
                2014-10-15 00:00:00+00
              ),
              -4,
              7},
             {[
                2015-01-01 00:00:00+00,
                2015-10-15 00:00:00+00
              ),
              3,
              11},
             {[
                2017-01-01 00:00:00+00,
                NULL
              ),
              -14,
              15},
             {[
                2019-01-01 00:00:00+00,
                2019-10-15 00:00:00+00
              ),
              9,
              13}]
==
[required_features=RANGE_TYPE]
[name=orderby_single_base_column_range_date_asc]
SELECT range_date_val, int64_val, row_id FROM AllTypesRangeTable t
WHERE row_id NOT IN (2, 3, 5, 8, 9, 10, 11)
ORDER BY range_date_val ASC
--
ARRAY<STRUCT<
        range_date_val RANGE<DATE>,
        int64_val INT64,
        row_id INT64
      >>
[known order:{NULL, -1, 16},
             {[NULL, 2007-10-15), -14, 15},
             {
               [2007-01-01, 2007-10-15),
               NULL,
               17
             },
             {
               [2011-01-01, 2011-10-15),
               -1,
               1
             },
             {
               [2012-01-01, 2012-10-15),
               -2,
               4
             },
             {
               [2013-01-01, 2013-10-15),
               -3,
               6
             },
             {
               [2014-01-01, 2014-10-15),
               -4,
               7
             },
             {[2017-01-01, NULL), 23, 14},
             {
               [2019-01-01, 2019-10-15),
               9,
               13
             },
             {
               [2026-01-01, 2026-10-15),
               16,
               12
             }]
==
[required_features=RANGE_TYPE,V_1_2_CIVIL_TIME]
[name=orderby_single_base_column_range_datetime_asc]
SELECT range_datetime_val, int64_val, row_id FROM AllTypesRangeDatetimeTable t
WHERE row_id NOT IN (2, 3, 5, 9, 10, 12, 17)
ORDER BY range_datetime_val ASC
--
ARRAY<STRUCT<
        range_datetime_val RANGE<DATETIME>,
        int64_val INT64,
        row_id INT64
      >>
[known order:{NULL, NULL, 8},
             {
               [NULL, 2013-10-15 00:00:00),
               23,
               14
             },
             {
               [2004-01-01 00:00:00, 2004-10-15 00:00:00),
               -1,
               16
             },
             {
               [2011-01-01 00:00:00, 2011-10-15 00:00:00),
               -1,
               1
             },
             {
               [2012-01-01 00:00:00, 2012-10-15 00:00:00),
               -2,
               4
             },
             {
               [2013-01-01 00:00:00, 2013-10-15 00:00:00),
               -3,
               6
             },
             {
               [2014-01-01 00:00:00, 2014-10-15 00:00:00),
               -4,
               7
             },
             {
               [2015-01-01 00:00:00, 2015-10-15 00:00:00),
               3,
               11
             },
             {
               [2017-01-01 00:00:00, NULL),
               -14,
               15
             },
             {
               [2019-01-01 00:00:00, 2019-10-15 00:00:00),
               9,
               13
             }]
==
#
# Single base table column descending
#
[name=orderby_single_base_column_bool_desc]
SELECT bool_val, int32_val, row_id FROM AllTypesTable t
WHERE row_id IN (1, 4, 8)
ORDER BY bool_val DESC
--
ARRAY<STRUCT<bool_val BOOL, int32_val INT32, row_id INT64>>[known order:
  {true, -1, 1},
  {false, -2, 4},
  {NULL, NULL, 8}
]
==
[name=orderby_single_base_column_int32_desc]
SELECT int32_val, int64_val, row_id FROM AllTypesTable t
WHERE row_id NOT IN (2, 3, 5, 9, 16, 17)
ORDER BY int32_val DESC
--
ARRAY<STRUCT<int32_val INT32, int64_val INT64, row_id INT64>>[known order:
  {13, 23, 14},
  {9, 9, 13},
  {5, 3, 11},
  {2, 16, 12},
  {1, 1, 10},
  {-1, -1, 1},
  {-2, -2, 4},
  {-3, -3, 6},
  {-4, -4, 7},
  {-24, -14, 15},
  {NULL, NULL, 8}
]
==
[name=orderby_single_base_column_int64_desc]
SELECT int64_val, uint32_val, row_id FROM AllTypesTable t
WHERE row_id NOT IN (2, 3, 5, 9, 16, 17)
ORDER BY int64_val DESC
--
ARRAY<STRUCT<int64_val INT64, uint32_val UINT32, row_id INT64>>[known order:
  {23, 31, 14},
  {16, 5, 12},
  {9, 4, 13},
  {3, 11, 11},
  {1, 11, 10},
  {-1, 1, 1},
  {-2, 2, 4},
  {-3, 3, 6},
  {-4, 4, 7},
  {-14, 41, 15},
  {NULL, NULL, 8}
]
==
[name=orderby_single_base_column_uint32_desc]
SELECT uint32_val, uint64_val, row_id FROM AllTypesTable t
WHERE row_id NOT IN (2, 3, 5, 9, 10, 13, 16, 17)
ORDER BY uint32_val DESC
--
ARRAY<STRUCT<uint32_val UINT32, uint64_val UINT64, row_id INT64>>[known order:
  {41, 54, 15},
  {31, 32, 14},
  {11, 8, 11},
  {5, 9, 12},
  {4, 4, 7},
  {3, 3, 6},
  {2, 2, 4},
  {1, 1, 1},
  {NULL, NULL, 8}
]
==
[name=orderby_single_base_column_uint64_desc]
SELECT uint64_val, float_val, row_id FROM AllTypesTable t
WHERE row_id NOT IN (2, 3, 5, 9, 13, 16, 17)
ORDER BY uint64_val DESC
--
ARRAY<STRUCT<uint64_val UINT64, float_val FLOAT, row_id INT64>>[known order:
  {54, -0.5, 15},
  {32, -0.375, 14},
  {11, 0.625, 10},
  {9, 0.75, 12},
  {8, -0.125, 11},
  {4, 0.5, 7},
  {3, 0.375, 6},
  {2, 0.25, 4},
  {1, 0.125, 1},
  {NULL, NULL, 8}
]
==
[name=orderby_single_base_column_float_desc]
SELECT float_val, double_val, row_id FROM AllTypesTable t ORDER BY float_val DESC
--
ARRAY<STRUCT<float_val FLOAT, double_val DOUBLE, row_id INT64>>[unknown order:
  {inf, -inf, 3},
  {0.75, -0.25, 12},
  {0.625, 0.625, 10},
  {0.5, 0.5, 7},
  {0.375, 0.375, 6},
  {0.25, 0, 4},
  {0.125, 0.125, 1},
  {-0, nan, 9},
  {0, NULL, 17},
  {-0.125, -0.125, 11},
  {-0.25, -0.75, 13},
  {-0.375, -0.375, 14},
  {-0.5, -0.5, 15},
  {-inf, 0.25, 5},
  {nan, inf, 2},
  {NULL, NULL, 8},
  {NULL, -0, 16}
]
==
[name=orderby_single_base_column_double_desc]
SELECT double_val, str_val, row_id FROM AllTypesTable t ORDER BY double_val DESC
--
ARRAY<STRUCT<double_val DOUBLE, str_val STRING, row_id INT64>>[unknown order:
  {inf, "1", 2},
  {0.625, "6", 10},
  {0.5, "4", 7},
  {0.375, "3", 6},
  {0.25, "2", 5},
  {0.125, "1", 1},
  {0, "2", 4},
  {-0, NULL, 16},
  {-0.125, "123", 11},
  {-0.25, "24", 12},
  {-0.375, "345", 14},
  {-0.5, "432", 15},
  {-0.75, "222", 13},
  {-inf, "1", 3},
  {nan, NULL, 9},
  {NULL, NULL, 8},
  {NULL, "1", 17}
]
==
[name=orderby_single_base_column_str_desc]
SELECT str_val, bytes_val, row_id FROM AllTypesTable t
WHERE row_id NOT IN (2, 3, 5, 9, 16, 17)
ORDER BY str_val DESC
--
ARRAY<STRUCT<str_val STRING, bytes_val BYTES, row_id INT64>>[known order:
  {"6", b"7", 10},
  {"432", b"433", 15},
  {"4", b"4", 7},
  {"345", b"345", 14},
  {"3", b"3", 6},
  {"24", b"22", 12},
  {"222", b"234", 13},
  {"2", b"2", 4},
  {"123", b"123", 11},
  {"1", b"1", 1},
  {NULL, NULL, 8}
]
==
[name=orderby_single_base_column_bytes_desc]
SELECT bytes_val, date_val, row_id FROM AllTypesTable t
WHERE row_id NOT IN (2, 3, 5, 9, 16, 17)
ORDER BY bytes_val DESC
--
ARRAY<STRUCT<bytes_val BYTES, date_val DATE, row_id INT64>>[known order:
  {b"7", 2014-01-08, 10},
  {b"433", 2014-02-04, 15},
  {b"4", 2014-01-04, 7},
  {b"345", 2014-01-06, 14},
  {b"3", 2014-01-03, 6},
  {b"234", 2014-05-02, 13},
  {b"22", 2014-02-02, 12},
  {b"2", 2014-01-02, 4},
  {b"123", 2014-02-01, 11},
  {b"1", 2014-01-01, 1},
  {NULL, NULL, 8}
]
==
[name=orderby_single_base_column_date_desc]
SELECT date_val, timestamp_val, row_id FROM AllTypesTable t
WHERE row_id NOT IN (2, 3, 5, 9, 16)
ORDER BY date_val DESC
--
ARRAY<STRUCT<
        date_val DATE,
        timestamp_val TIMESTAMP,
        row_id INT64
      >>
[unknown order:{
                 2014-05-02,
                 2014-05-02 00:00:02.022022+00,
                 13
               },
               {2014-02-04, NULL, 17},
               {
                 2014-02-04,
                 2014-02-04 00:00:04.044044+00,
                 15
               },
               {
                 2014-02-02,
                 2014-01-05 00:00:02.022022+00,
                 12
               },
               {
                 2014-02-01,
                 2014-04-01 00:00:01.011011+00,
                 11
               },
               {
                 2014-01-08,
                 2014-01-02 00:00:01.011011+00,
                 10
               },
               {
                 2014-01-06,
                 2014-01-04 00:00:03.033033+00,
                 14
               },
               {
                 2014-01-04,
                 2014-01-04 00:00:04.044044+00,
                 7
               },
               {
                 2014-01-03,
                 2014-01-03 00:00:03.033033+00,
                 6
               },
               {
                 2014-01-02,
                 2014-01-02 00:00:02.022022+00,
                 4
               },
               {
                 2014-01-01,
                 2014-01-01 00:00:01.011011+00,
                 1
               },
               {NULL, NULL, 8}]
==
[name=orderby_single_base_column_timestamp_desc]
SELECT timestamp_val, date_val, row_id FROM AllTypesTable t
WHERE row_id NOT IN (2, 3, 5, 9, 16, 17)
ORDER BY timestamp_val DESC
--
ARRAY<STRUCT<
        timestamp_val TIMESTAMP,
        date_val DATE,
        row_id INT64
      >>
[known order:{
               2014-05-02 00:00:02.022022+00,
               2014-05-02,
               13
             },
             {
               2014-04-01 00:00:01.011011+00,
               2014-02-01,
               11
             },
             {
               2014-02-04 00:00:04.044044+00,
               2014-02-04,
               15
             },
             {
               2014-01-05 00:00:02.022022+00,
               2014-02-02,
               12
             },
             {
               2014-01-04 00:00:04.044044+00,
               2014-01-04,
               7
             },
             {
               2014-01-04 00:00:03.033033+00,
               2014-01-06,
               14
             },
             {
               2014-01-03 00:00:03.033033+00,
               2014-01-03,
               6
             },
             {
               2014-01-02 00:00:02.022022+00,
               2014-01-02,
               4
             },
             {
               2014-01-02 00:00:01.011011+00,
               2014-01-08,
               10
             },
             {
               2014-01-01 00:00:01.011011+00,
               2014-01-01,
               1
             },
             {NULL, NULL, 8}]
==
[required_features=NUMERIC_TYPE]
[name=orderby_single_base_column_numeric_desc]
SELECT numeric_val, int64_val, row_id FROM AllTypesNumericTable t
WHERE row_id NOT IN (2, 3, 5, 9, 16, 17)
ORDER BY numeric_val ASC
--
ARRAY<STRUCT<numeric_val NUMERIC, int64_val INT64, row_id INT64>>[unknown order:
  {NULL, NULL, 8},
  {-123456789.123456789, -14, 15},
  {-1000.10101, 9, 13},
  {-5.34, 3, 11},
  {1, 1, 10},
  {1, -1, 1},
  {2, -2, 4},
  {3, -3, 6},
  {4, -4, 7},
  {222, 23, 14},
  {999.999, 16, 12}
]
==
[required_features=BIGNUMERIC_TYPE]
[name=orderby_single_base_column_bignumeric_desc]
SELECT bignumeric_val, int64_val, row_id FROM AllTypesBigNumericTable t
WHERE row_id NOT IN (2, 3, 5, 9, 16, 17)
ORDER BY bignumeric_val ASC
--
ARRAY<STRUCT<
        bignumeric_val BIGNUMERIC,
        int64_val INT64,
        row_id INT64
      >>
[unknown order:{NULL, NULL, 8},
               {
                 -123456789.1234567890123456789,
                 -14,
                 15
               },
               {
                 -1000.0000000000000000001,
                 9,
                 13
               },
               {-5.34, 3, 11},
               {1, 1, 10},
               {1, -1, 1},
               {2, -2, 4},
               {3, -3, 6},
               {4, -4, 7},
               {222, 23, 14},
               {
                 999.9999999999999999999,
                 16,
                 12
               }]
==
[required_features=RANGE_TYPE]
[name=orderby_single_base_column_range_timestamp_desc]
SELECT range_timestamp_val, int64_val, row_id FROM AllTypesRangeTable t
WHERE row_id NOT IN (2, 3, 5, 9, 10, 12, 16, 17)
ORDER BY range_timestamp_val DESC
--
ARRAY<STRUCT<
        range_timestamp_val RANGE<TIMESTAMP>,
        int64_val INT64,
        row_id INT64
      >>
[known order:{[
                2019-01-01 00:00:00+00,
                2019-10-15 00:00:00+00
              ),
              9,
              13},
             {[
                2017-01-01 00:00:00+00,
                NULL
              ),
              -14,
              15},
             {[
                2015-01-01 00:00:00+00,
                2015-10-15 00:00:00+00
              ),
              3,
              11},
             {[
                2014-01-01 00:00:00+00,
                2014-10-15 00:00:00+00
              ),
              -4,
              7},
             {[
                2013-01-01 00:00:00+00,
                2013-10-15 00:00:00+00
              ),
              -3,
              6},
             {[
                2012-01-01 00:00:00+00,
                2012-10-15 00:00:00+00
              ),
              -2,
              4},
             {[
                2011-01-01 00:00:00+00,
                2011-10-15 00:00:00+00
              ),
              -1,
              1},
             {[
                NULL,
                2013-10-15 00:00:00+00
              ),
              23,
              14},
             {NULL, NULL, 8}]
==
[required_features=RANGE_TYPE]
[name=orderby_single_base_column_range_date_desc]
SELECT range_date_val, int64_val, row_id FROM AllTypesRangeTable t
WHERE row_id NOT IN (2, 3, 5, 8, 9, 10, 11)
ORDER BY range_date_val DESC
--
ARRAY<STRUCT<
        range_date_val RANGE<DATE>,
        int64_val INT64,
        row_id INT64
      >>
[known order:{
               [2026-01-01, 2026-10-15),
               16,
               12
             },
             {
               [2019-01-01, 2019-10-15),
               9,
               13
             },
             {[2017-01-01, NULL), 23, 14},
             {
               [2014-01-01, 2014-10-15),
               -4,
               7
             },
             {
               [2013-01-01, 2013-10-15),
               -3,
               6
             },
             {
               [2012-01-01, 2012-10-15),
               -2,
               4
             },
             {
               [2011-01-01, 2011-10-15),
               -1,
               1
             },
             {
               [2007-01-01, 2007-10-15),
               NULL,
               17
             },
             {[NULL, 2007-10-15), -14, 15},
             {NULL, -1, 16}]
==
[required_features=RANGE_TYPE,V_1_2_CIVIL_TIME]
[name=orderby_single_base_column_range_datetime_desc]
SELECT range_datetime_val, int64_val, row_id FROM AllTypesRangeDatetimeTable t
WHERE row_id NOT IN (2, 3, 5, 9, 10, 12, 17)
ORDER BY range_datetime_val DESC
--
ARRAY<STRUCT<
        range_datetime_val RANGE<DATETIME>,
        int64_val INT64,
        row_id INT64
      >>
[known order:{
               [2019-01-01 00:00:00, 2019-10-15 00:00:00),
               9,
               13
             },
             {
               [2017-01-01 00:00:00, NULL),
               -14,
               15
             },
             {
               [2015-01-01 00:00:00, 2015-10-15 00:00:00),
               3,
               11
             },
             {
               [2014-01-01 00:00:00, 2014-10-15 00:00:00),
               -4,
               7
             },
             {
               [2013-01-01 00:00:00, 2013-10-15 00:00:00),
               -3,
               6
             },
             {
               [2012-01-01 00:00:00, 2012-10-15 00:00:00),
               -2,
               4
             },
             {
               [2011-01-01 00:00:00, 2011-10-15 00:00:00),
               -1,
               1
             },
             {
               [2004-01-01 00:00:00, 2004-10-15 00:00:00),
               -1,
               16
             },
             {
               [NULL, 2013-10-15 00:00:00),
               23,
               14
             },
             {NULL, NULL, 8}]
==
#
# Single computed column ascending
#
[name=orderby_single_computed_column_bool_asc]
SELECT bool_val, int32_val, row_id FROM AllTypesTable t
WHERE row_id IN (1, 4, 8)
ORDER BY (NOT bool_val) ASC
--
ARRAY<STRUCT<bool_val BOOL, int32_val INT32, row_id INT64>>[known order:
  {NULL, NULL, 8},
  {true, -1, 1},
  {false, -2, 4}
]
==
[name=orderby_single_computed_column_int32_asc]
SELECT int32_val, int64_val, row_id FROM AllTypesTable t
WHERE row_id NOT IN (2, 3, 5, 9, 16, 17)
ORDER BY int32_val + 1 ASC
--
ARRAY<STRUCT<int32_val INT32, int64_val INT64, row_id INT64>>[known order:
  {NULL, NULL, 8},
  {-24, -14, 15},
  {-4, -4, 7},
  {-3, -3, 6},
  {-2, -2, 4},
  {-1, -1, 1},
  {1, 1, 10},
  {2, 16, 12},
  {5, 3, 11},
  {9, 9, 13},
  {13, 23, 14}
]
==
[name=orderby_single_computed_column_int64_asc]
SELECT int64_val, uint32_val, row_id FROM AllTypesTable t
WHERE row_id NOT IN (2, 3, 5, 9, 16, 17)
ORDER BY int64_val * 2 ASC
--
ARRAY<STRUCT<int64_val INT64, uint32_val UINT32, row_id INT64>>[known order:
  {NULL, NULL, 8},
  {-14, 41, 15},
  {-4, 4, 7},
  {-3, 3, 6},
  {-2, 2, 4},
  {-1, 1, 1},
  {1, 11, 10},
  {3, 11, 11},
  {9, 4, 13},
  {16, 5, 12},
  {23, 31, 14}
]
==
[name=orderby_single_computed_column_uint32_asc]
SELECT uint32_val, uint64_val, row_id FROM AllTypesTable t
WHERE row_id NOT IN (2, 3, 5, 9, 10, 13, 16, 17)
ORDER BY uint32_val + 7 ASC
--
ARRAY<STRUCT<uint32_val UINT32, uint64_val UINT64, row_id INT64>>[known order:
  {NULL, NULL, 8},
  {1, 1, 1},
  {2, 2, 4},
  {3, 3, 6},
  {4, 4, 7},
  {5, 9, 12},
  {11, 8, 11},
  {31, 32, 14},
  {41, 54, 15}
]
==
[name=orderby_single_computed_column_uint64_asc]
SELECT uint64_val, float_val, row_id FROM AllTypesTable t
WHERE row_id NOT IN (2, 3, 5, 9, 13, 16, 17)
ORDER BY uint64_val * 3 ASC
--
ARRAY<STRUCT<uint64_val UINT64, float_val FLOAT, row_id INT64>>[known order:
  {NULL, NULL, 8},
  {1, 0.125, 1},
  {2, 0.25, 4},
  {3, 0.375, 6},
  {4, 0.5, 7},
  {8, -0.125, 11},
  {9, 0.75, 12},
  {11, 0.625, 10},
  {32, -0.375, 14},
  {54, -0.5, 15}
]
==
[name=orderby_single_computed_column_float_asc]
SELECT float_val, double_val, row_id FROM AllTypesTable t ORDER BY float_val + 0.125 ASC
--
ARRAY<STRUCT<float_val FLOAT, double_val DOUBLE, row_id INT64>>[unknown order:
  {NULL, NULL, 8},
  {NULL, -0, 16},
  {nan, inf, 2},
  {-inf, 0.25, 5},
  {-0.5, -0.5, 15},
  {-0.375, -0.375, 14},
  {-0.25, -0.75, 13},
  {-0.125, -0.125, 11},
  {-0, nan, 9},
  {0, NULL, 17},
  {0.125, 0.125, 1},
  {0.25, 0, 4},
  {0.375, 0.375, 6},
  {0.5, 0.5, 7},
  {0.625, 0.625, 10},
  {0.75, -0.25, 12},
  {inf, -inf, 3}
]
==
[name=orderby_single_computed_column_double_asc]
SELECT double_val, str_val, row_id FROM AllTypesTable t ORDER BY double_val * 2 ASC
--
ARRAY<STRUCT<double_val DOUBLE, str_val STRING, row_id INT64>>[unknown order:
  {NULL, NULL, 8},
  {NULL, "1", 17},
  {nan, NULL, 9},
  {-inf, "1", 3},
  {-0.75, "222", 13},
  {-0.5, "432", 15},
  {-0.375, "345", 14},
  {-0.25, "24", 12},
  {-0.125, "123", 11},
  {0, "2", 4},
  {-0, NULL, 16},
  {0.125, "1", 1},
  {0.25, "2", 5},
  {0.375, "3", 6},
  {0.5, "4", 7},
  {0.625, "6", 10},
  {inf, "1", 2}
]
==
[name=orderby_single_computed_column_str_asc]
SELECT str_val, bytes_val, row_id FROM AllTypesTable t
WHERE row_id NOT IN (2, 3, 5, 9, 16, 17)
ORDER BY LTRIM(str_val) ASC
--
ARRAY<STRUCT<str_val STRING, bytes_val BYTES, row_id INT64>>[known order:
  {NULL, NULL, 8},
  {"1", b"1", 1},
  {"123", b"123", 11},
  {"2", b"2", 4},
  {"222", b"234", 13},
  {"24", b"22", 12},
  {"3", b"3", 6},
  {"345", b"345", 14},
  {"4", b"4", 7},
  {"432", b"433", 15},
  {"6", b"7", 10}
]
==
[name=orderby_single_computed_column_bytes_asc]
SELECT bytes_val, date_val, row_id FROM AllTypesTable t
WHERE row_id NOT IN (2, 3, 5, 9, 16, 17)
ORDER BY UPPER(bytes_val) ASC
--
ARRAY<STRUCT<bytes_val BYTES, date_val DATE, row_id INT64>>[known order:
  {NULL, NULL, 8},
  {b"1", 2014-01-01, 1},
  {b"123", 2014-02-01, 11},
  {b"2", 2014-01-02, 4},
  {b"22", 2014-02-02, 12},
  {b"234", 2014-05-02, 13},
  {b"3", 2014-01-03, 6},
  {b"345", 2014-01-06, 14},
  {b"4", 2014-01-04, 7},
  {b"433", 2014-02-04, 15},
  {b"7", 2014-01-08, 10}
]
==
#
# Single computed column descending
#
[name=orderby_single_computed_column_bool_desc]
SELECT bool_val, int32_val, row_id FROM AllTypesTable t
WHERE row_id IN (1, 4, 8)
ORDER BY NOT bool_val DESC
--
ARRAY<STRUCT<bool_val BOOL, int32_val INT32, row_id INT64>>[known order:
  {false, -2, 4},
  {true, -1, 1},
  {NULL, NULL, 8}
]
==
[name=orderby_single_computed_column_int32_desc]
SELECT int32_val, int64_val, row_id FROM AllTypesTable t
WHERE row_id NOT IN (2, 3, 5, 9, 16, 17)
ORDER BY int32_val + 1 DESC
--
ARRAY<STRUCT<int32_val INT32, int64_val INT64, row_id INT64>>[known order:
  {13, 23, 14},
  {9, 9, 13},
  {5, 3, 11},
  {2, 16, 12},
  {1, 1, 10},
  {-1, -1, 1},
  {-2, -2, 4},
  {-3, -3, 6},
  {-4, -4, 7},
  {-24, -14, 15},
  {NULL, NULL, 8}
]
==
[name=orderby_single_computed_column_int64_desc]
SELECT int64_val, uint32_val, row_id FROM AllTypesTable t
WHERE row_id NOT IN (2, 3, 5, 9, 16, 17)
ORDER BY int64_val * 2 DESC
--
ARRAY<STRUCT<int64_val INT64, uint32_val UINT32, row_id INT64>>[known order:
  {23, 31, 14},
  {16, 5, 12},
  {9, 4, 13},
  {3, 11, 11},
  {1, 11, 10},
  {-1, 1, 1},
  {-2, 2, 4},
  {-3, 3, 6},
  {-4, 4, 7},
  {-14, 41, 15},
  {NULL, NULL, 8}
]
==
[name=orderby_single_computed_column_uint32_desc]
SELECT uint32_val, uint64_val, row_id FROM AllTypesTable t
WHERE row_id NOT IN (2, 3, 5, 9, 10, 13, 16, 17)
ORDER BY uint32_val + 7 DESC
--
ARRAY<STRUCT<uint32_val UINT32, uint64_val UINT64, row_id INT64>>[known order:
  {41, 54, 15},
  {31, 32, 14},
  {11, 8, 11},
  {5, 9, 12},
  {4, 4, 7},
  {3, 3, 6},
  {2, 2, 4},
  {1, 1, 1},
  {NULL, NULL, 8}
]
==
[name=orderby_single_computed_column_uint64_desc]
SELECT uint64_val, float_val, row_id FROM AllTypesTable t
WHERE row_id NOT IN (2, 3, 5, 9, 13, 16, 17)
ORDER BY uint64_val * 3 DESC
--
ARRAY<STRUCT<uint64_val UINT64, float_val FLOAT, row_id INT64>>[known order:
  {54, -0.5, 15},
  {32, -0.375, 14},
  {11, 0.625, 10},
  {9, 0.75, 12},
  {8, -0.125, 11},
  {4, 0.5, 7},
  {3, 0.375, 6},
  {2, 0.25, 4},
  {1, 0.125, 1},
  {NULL, NULL, 8}
]
==
[name=orderby_single_computed_column_float_desc]
SELECT float_val, double_val, row_id FROM AllTypesTable t
ORDER BY float_val + 0.125 DESC
--
ARRAY<STRUCT<float_val FLOAT, double_val DOUBLE, row_id INT64>>[unknown order:
  {inf, -inf, 3},
  {0.75, -0.25, 12},
  {0.625, 0.625, 10},
  {0.5, 0.5, 7},
  {0.375, 0.375, 6},
  {0.25, 0, 4},
  {0.125, 0.125, 1},
  {-0, nan, 9},
  {0, NULL, 17},
  {-0.125, -0.125, 11},
  {-0.25, -0.75, 13},
  {-0.375, -0.375, 14},
  {-0.5, -0.5, 15},
  {-inf, 0.25, 5},
  {nan, inf, 2},
  {NULL, NULL, 8},
  {NULL, -0, 16}
]
==
[name=orderby_single_computed_column_double_desc]
SELECT double_val, str_val, row_id FROM AllTypesTable t
ORDER BY double_val * 2 DESC
--
ARRAY<STRUCT<double_val DOUBLE, str_val STRING, row_id INT64>>[unknown order:
  {inf, "1", 2},
  {0.625, "6", 10},
  {0.5, "4", 7},
  {0.375, "3", 6},
  {0.25, "2", 5},
  {0.125, "1", 1},
  {0, "2", 4},
  {-0, NULL, 16},
  {-0.125, "123", 11},
  {-0.25, "24", 12},
  {-0.375, "345", 14},
  {-0.5, "432", 15},
  {-0.75, "222", 13},
  {-inf, "1", 3},
  {nan, NULL, 9},
  {NULL, NULL, 8},
  {NULL, "1", 17}
]
==
[name=orderby_single_computed_column_str_desc]
SELECT str_val, bytes_val, row_id FROM AllTypesTable t
WHERE row_id NOT IN (2, 3, 5, 9, 16, 17)
ORDER BY LTRIM(str_val) DESC
--
ARRAY<STRUCT<str_val STRING, bytes_val BYTES, row_id INT64>>[known order:
  {"6", b"7", 10},
  {"432", b"433", 15},
  {"4", b"4", 7},
  {"345", b"345", 14},
  {"3", b"3", 6},
  {"24", b"22", 12},
  {"222", b"234", 13},
  {"2", b"2", 4},
  {"123", b"123", 11},
  {"1", b"1", 1},
  {NULL, NULL, 8}
]
==
[name=orderby_single_computed_column_bytes_desc]
SELECT bytes_val, date_val, row_id FROM AllTypesTable t
WHERE row_id NOT IN (2, 3, 5, 9, 16, 17)
ORDER BY LOWER(bytes_val) DESC
--
ARRAY<STRUCT<bytes_val BYTES, date_val DATE, row_id INT64>>[known order:
  {b"7", 2014-01-08, 10},
  {b"433", 2014-02-04, 15},
  {b"4", 2014-01-04, 7},
  {b"345", 2014-01-06, 14},
  {b"3", 2014-01-03, 6},
  {b"234", 2014-05-02, 13},
  {b"22", 2014-02-02, 12},
  {b"2", 2014-01-02, 4},
  {b"123", 2014-02-01, 11},
  {b"1", 2014-01-01, 1},
  {NULL, NULL, 8}
]
==
[required_features=NUMERIC_TYPE]
[name=orderby_single_computed_column_numeric_desc]
SELECT numeric_val, date_val, row_id FROM AllTypesNumericTable t
WHERE row_id NOT IN (2, 3, 5, 9, 16, 17)
ORDER BY numeric_val * 2 DESC
--
ARRAY<STRUCT<numeric_val NUMERIC, date_val DATE, row_id INT64>>[unknown order:
  {999.999, 2014-02-02, 12},
  {222, 2014-01-06, 14},
  {4, 2014-01-04, 7},
  {3, 2014-01-03, 6},
  {2, 2014-01-02, 4},
  {1, 2014-01-08, 10},
  {1, 2014-01-01, 1},
  {-5.34, 2014-02-01, 11},
  {-1000.10101, 2014-05-02, 13},
  {-123456789.123456789, 2014-02-04, 15},
  {NULL, NULL, 8}
]
==
[required_features=BIGNUMERIC_TYPE]
[name=orderby_single_computed_column_bignumeric_desc]
SELECT bignumeric_val, date_val, row_id FROM AllTypesBigNumericTable t
WHERE row_id NOT IN (2, 3, 5, 9, 16, 17)
ORDER BY bignumeric_val * 2 DESC
--
ARRAY<STRUCT<
        bignumeric_val BIGNUMERIC,
        date_val DATE,
        row_id INT64
      >>
[unknown order:{
                 999.9999999999999999999,
                 2014-02-02,
                 12
               },
               {222, 2014-01-06, 14},
               {4, 2014-01-04, 7},
               {3, 2014-01-03, 6},
               {2, 2014-01-02, 4},
               {1, 2014-01-08, 10},
               {1, 2014-01-01, 1},
               {-5.34, 2014-02-01, 11},
               {
                 -1000.0000000000000000001,
                 2014-05-02,
                 13
               },
               {
                 -123456789.1234567890123456789,
                 2014-02-04,
                 15
               },
               {NULL, NULL, 8}]
==
[required_features=RANGE_TYPE]
[name=orderby_single_computed_column_range_timestamp_desc]
SELECT range_timestamp_val, int64_val, row_id FROM AllTypesRangeTable t
WHERE row_id NOT IN (2, 3, 5, 9, 10, 12, 16, 17)
ORDER BY IF(
  range_timestamp_val IS NULL,
  NULL,
  RANGE(RANGE_START(range_timestamp_val), RANGE_END(range_timestamp_val))) DESC
--
ARRAY<STRUCT<
        range_timestamp_val RANGE<TIMESTAMP>,
        int64_val INT64,
        row_id INT64
      >>
[known order:{[
                2019-01-01 00:00:00+00,
                2019-10-15 00:00:00+00
              ),
              9,
              13},
             {[
                2017-01-01 00:00:00+00,
                NULL
              ),
              -14,
              15},
             {[
                2015-01-01 00:00:00+00,
                2015-10-15 00:00:00+00
              ),
              3,
              11},
             {[
                2014-01-01 00:00:00+00,
                2014-10-15 00:00:00+00
              ),
              -4,
              7},
             {[
                2013-01-01 00:00:00+00,
                2013-10-15 00:00:00+00
              ),
              -3,
              6},
             {[
                2012-01-01 00:00:00+00,
                2012-10-15 00:00:00+00
              ),
              -2,
              4},
             {[
                2011-01-01 00:00:00+00,
                2011-10-15 00:00:00+00
              ),
              -1,
              1},
             {[
                NULL,
                2013-10-15 00:00:00+00
              ),
              23,
              14},
             {NULL, NULL, 8}]
==
[required_features=RANGE_TYPE]
[name=orderby_single_computed_column_range_date_desc]
SELECT range_date_val, int64_val, row_id FROM AllTypesRangeTable t
WHERE row_id NOT IN (2, 3, 5, 8, 9, 10, 11)
ORDER BY IF(
  range_date_val IS NULL,
  NULL,
  RANGE(RANGE_START(range_date_val), RANGE_END(range_date_val))) DESC
--
ARRAY<STRUCT<
        range_date_val RANGE<DATE>,
        int64_val INT64,
        row_id INT64
      >>
[known order:{
               [2026-01-01, 2026-10-15),
               16,
               12
             },
             {
               [2019-01-01, 2019-10-15),
               9,
               13
             },
             {[2017-01-01, NULL), 23, 14},
             {
               [2014-01-01, 2014-10-15),
               -4,
               7
             },
             {
               [2013-01-01, 2013-10-15),
               -3,
               6
             },
             {
               [2012-01-01, 2012-10-15),
               -2,
               4
             },
             {
               [2011-01-01, 2011-10-15),
               -1,
               1
             },
             {
               [2007-01-01, 2007-10-15),
               NULL,
               17
             },
             {[NULL, 2007-10-15), -14, 15},
             {NULL, -1, 16}]
==
[required_features=RANGE_TYPE,V_1_2_CIVIL_TIME]
[name=orderby_single_computed_column_range_datetime_desc]
SELECT range_datetime_val, int64_val, row_id FROM AllTypesRangeDatetimeTable t
WHERE row_id NOT IN (2, 3, 5, 9, 10, 12, 17)
ORDER BY IF(
  range_datetime_val IS NULL,
  NULL,
  RANGE(RANGE_START(range_datetime_val), RANGE_END(range_datetime_val))) DESC
--
ARRAY<STRUCT<
        range_datetime_val RANGE<DATETIME>,
        int64_val INT64,
        row_id INT64
      >>
[known order:{
               [2019-01-01 00:00:00, 2019-10-15 00:00:00),
               9,
               13
             },
             {
               [2017-01-01 00:00:00, NULL),
               -14,
               15
             },
             {
               [2015-01-01 00:00:00, 2015-10-15 00:00:00),
               3,
               11
             },
             {
               [2014-01-01 00:00:00, 2014-10-15 00:00:00),
               -4,
               7
             },
             {
               [2013-01-01 00:00:00, 2013-10-15 00:00:00),
               -3,
               6
             },
             {
               [2012-01-01 00:00:00, 2012-10-15 00:00:00),
               -2,
               4
             },
             {
               [2011-01-01 00:00:00, 2011-10-15 00:00:00),
               -1,
               1
             },
             {
               [2004-01-01 00:00:00, 2004-10-15 00:00:00),
               -1,
               16
             },
             {
               [NULL, 2013-10-15 00:00:00),
               23,
               14
             },
             {NULL, NULL, 8}]
==
#
# Multiple columns, with first as base table column ascending
#
[name=orderby_multi_base_column_bool_asc]
SELECT bool_val, int32_val, row_id FROM AllTypesTable t
ORDER BY bool_val ASC, int32_val DESC, row_id ASC
--
ARRAY<STRUCT<bool_val BOOL, int32_val INT32, row_id INT64>>[known order:
  {NULL, -1, 17},
  {NULL, NULL, 8},
  {NULL, NULL, 9},
  {false, 9, 13},
  {false, 5, 11},
  {false, 2, 12},
  {false, -2, 4},
  {false, -2, 5},
  {false, -4, 7},
  {false, -24, 15},
  {false, NULL, 16},
  {true, 13, 14},
  {true, 1, 10},
  {true, -1, 1},
  {true, -1, 2},
  {true, -1, 3},
  {true, -3, 6}
]
==
[name=orderby_multi_base_column_int32_asc]
SELECT int32_val, int64_val, row_id FROM AllTypesTable t
ORDER BY int32_val ASC, -int64_val ASC, row_id ASC
--
ARRAY<STRUCT<int32_val INT32, int64_val INT64, row_id INT64>>[known order:
  {NULL, NULL, 8},
  {NULL, NULL, 9},
  {NULL, -1, 16},
  {-24, -14, 15},
  {-4, -4, 7},
  {-3, -3, 6},
  {-2, -2, 4},
  {-2, -2, 5},
  {-1, NULL, 17},
  {-1, -1, 1},
  {-1, -1, 2},
  {-1, -1, 3},
  {1, 1, 10},
  {2, 16, 12},
  {5, 3, 11},
  {9, 9, 13},
  {13, 23, 14}
]
==
[name=orderby_multi_base_column_int64_asc]
SELECT int64_val, uint32_val, row_id FROM AllTypesTable t
ORDER BY int64_val ASC, uint32_val + 2 DESC, row_id ASC
--
ARRAY<STRUCT<int64_val INT64, uint32_val UINT32, row_id INT64>>[known order:
  {NULL, 1, 17},
  {NULL, NULL, 8},
  {NULL, NULL, 9},
  {-14, 41, 15},
  {-4, 4, 7},
  {-3, 3, 6},
  {-2, 2, 4},
  {-2, 2, 5},
  {-1, 1, 1},
  {-1, 1, 2},
  {-1, 1, 3},
  {-1, NULL, 16},
  {1, 11, 10},
  {3, 11, 11},
  {9, 4, 13},
  {16, 5, 12},
  {23, 31, 14}
]
==
[name=orderby_multi_base_column_uint32_asc]
SELECT uint32_val, uint64_val, row_id FROM AllTypesTable t
ORDER BY uint32_val ASC, uint64_val * 2 ASC, row_id ASC
--
ARRAY<STRUCT<uint32_val UINT32, uint64_val UINT64, row_id INT64>>[known order:
  {NULL, NULL, 8},
  {NULL, NULL, 9},
  {NULL, 1, 16},
  {1, NULL, 17},
  {1, 1, 1},
  {1, 1, 2},
  {1, 1, 3},
  {2, 2, 4},
  {2, 2, 5},
  {3, 3, 6},
  {4, 4, 7},
  {4, 8, 13},
  {5, 9, 12},
  {11, 8, 11},
  {11, 11, 10},
  {31, 32, 14},
  {41, 54, 15}
]
==
[name=orderby_multi_base_column_uint64_asc]
SELECT uint64_val, float_val, row_id FROM AllTypesTable t
ORDER BY uint64_val ASC, float_val DESC, row_id ASC
--
ARRAY<STRUCT<uint64_val UINT64, float_val FLOAT, row_id INT64>>[known order:
  {NULL, -0, 9},
  {NULL, 0, 17},
  {NULL, NULL, 8},
  {1, inf, 3},
  {1, 0.125, 1},
  {1, nan, 2},
  {1, NULL, 16},
  {2, 0.25, 4},
  {2, -inf, 5},
  {3, 0.375, 6},
  {4, 0.5, 7},
  {8, -0.125, 11},
  {8, -0.25, 13},
  {9, 0.75, 12},
  {11, 0.625, 10},
  {32, -0.375, 14},
  {54, -0.5, 15}
]
==
[name=orderby_multi_base_column_float_asc]
SELECT float_val, double_val, row_id FROM AllTypesTable t
ORDER BY float_val ASC, double_val ASC, row_id ASC
--
ARRAY<STRUCT<float_val FLOAT, double_val DOUBLE, row_id INT64>>[known order:
  {NULL, NULL, 8},
  {NULL, -0, 16},
  {nan, inf, 2},
  {-inf, 0.25, 5},
  {-0.5, -0.5, 15},
  {-0.375, -0.375, 14},
  {-0.25, -0.75, 13},
  {-0.125, -0.125, 11},
  {0, NULL, 17},
  {-0, nan, 9},
  {0.125, 0.125, 1},
  {0.25, 0, 4},
  {0.375, 0.375, 6},
  {0.5, 0.5, 7},
  {0.625, 0.625, 10},
  {0.75, -0.25, 12},
  {inf, -inf, 3}
]
==
[name=orderby_multi_base_column_double_asc]
SELECT double_val, str_val, row_id FROM AllTypesTable t
ORDER BY double_val ASC, str_val DESC, row_id ASC
--
ARRAY<STRUCT<double_val DOUBLE, str_val STRING, row_id INT64>>[known order:
  {NULL, "1", 17},
  {NULL, NULL, 8},
  {nan, NULL, 9},
  {-inf, "1", 3},
  {-0.75, "222", 13},
  {-0.5, "432", 15},
  {-0.375, "345", 14},
  {-0.25, "24", 12},
  {-0.125, "123", 11},
  {0, "2", 4},
  {-0, NULL, 16},
  {0.125, "1", 1},
  {0.25, "2", 5},
  {0.375, "3", 6},
  {0.5, "4", 7},
  {0.625, "6", 10},
  {inf, "1", 2}
]
==
[name=orderby_multi_base_column_str_asc]
SELECT str_val, bytes_val, row_id FROM AllTypesTable t
ORDER BY str_val ASC, bytes_val ASC, row_id ASC
--
ARRAY<STRUCT<str_val STRING, bytes_val BYTES, row_id INT64>>[known order:
  {NULL, NULL, 8},
  {NULL, NULL, 9},
  {NULL, b"1", 16},
  {"1", NULL, 17},
  {"1", b"1", 1},
  {"1", b"1", 2},
  {"1", b"1", 3},
  {"123", b"123", 11},
  {"2", b"2", 4},
  {"2", b"2", 5},
  {"222", b"234", 13},
  {"24", b"22", 12},
  {"3", b"3", 6},
  {"345", b"345", 14},
  {"4", b"4", 7},
  {"432", b"433", 15},
  {"6", b"7", 10}
]
==
[name=orderby_multi_base_column_bytes_asc]
SELECT bytes_val, date_val, row_id FROM AllTypesTable t
ORDER BY bytes_val ASC, date_val ASC, row_id ASC
--
ARRAY<STRUCT<bytes_val BYTES, date_val DATE, row_id INT64>>[known order:
  {NULL, NULL, 8},
  {NULL, NULL, 9},
  {NULL, 2014-02-04, 17},
  {b"1", NULL, 16},
  {b"1", 2014-01-01, 1},
  {b"1", 2014-01-01, 2},
  {b"1", 2014-01-01, 3},
  {b"123", 2014-02-01, 11},
  {b"2", 2014-01-02, 4},
  {b"2", 2014-01-02, 5},
  {b"22", 2014-02-02, 12},
  {b"234", 2014-05-02, 13},
  {b"3", 2014-01-03, 6},
  {b"345", 2014-01-06, 14},
  {b"4", 2014-01-04, 7},
  {b"433", 2014-02-04, 15},
  {b"7", 2014-01-08, 10}
]
==
[name=orderby_multi_base_column_date_asc]
SELECT date_val, timestamp_val, row_id FROM AllTypesTable t
ORDER BY date_val ASC, timestamp_val, row_id ASC
--
ARRAY<STRUCT<
        date_val DATE,
        timestamp_val TIMESTAMP,
        row_id INT64
      >>
[known order:{NULL, NULL, 8},
             {NULL, NULL, 9},
             {
               NULL,
               2014-02-04 00:00:04.044044+00,
               16
             },
             {
               2014-01-01,
               2014-01-01 00:00:01.011011+00,
               1
             },
             {
               2014-01-01,
               2014-01-01 00:00:01.011011+00,
               2
             },
             {
               2014-01-01,
               2014-01-01 00:00:01.011011+00,
               3
             },
             {
               2014-01-02,
               2014-01-02 00:00:02.022022+00,
               4
             },
             {
               2014-01-02,
               2014-01-02 00:00:02.022022+00,
               5
             },
             {
               2014-01-03,
               2014-01-03 00:00:03.033033+00,
               6
             },
             {
               2014-01-04,
               2014-01-04 00:00:04.044044+00,
               7
             },
             {
               2014-01-06,
               2014-01-04 00:00:03.033033+00,
               14
             },
             {
               2014-01-08,
               2014-01-02 00:00:01.011011+00,
               10
             },
             {
               2014-02-01,
               2014-04-01 00:00:01.011011+00,
               11
             },
             {
               2014-02-02,
               2014-01-05 00:00:02.022022+00,
               12
             },
             {2014-02-04, NULL, 17},
             {
               2014-02-04,
               2014-02-04 00:00:04.044044+00,
               15
             },
             {
               2014-05-02,
               2014-05-02 00:00:02.022022+00,
               13
             }]
==
[name=orderby_multi_base_column_timestamp_asc]
SELECT timestamp_val, date_val, row_id FROM AllTypesTable t
ORDER BY timestamp_val ASC, date_val ASC, row_id ASC
--
ARRAY<STRUCT<
        timestamp_val TIMESTAMP,
        date_val DATE,
        row_id INT64
      >>
[known order:{NULL, NULL, 8},
             {NULL, NULL, 9},
             {NULL, 2014-02-04, 17},
             {
               2014-01-01 00:00:01.011011+00,
               2014-01-01,
               1
             },
             {
               2014-01-01 00:00:01.011011+00,
               2014-01-01,
               2
             },
             {
               2014-01-01 00:00:01.011011+00,
               2014-01-01,
               3
             },
             {
               2014-01-02 00:00:01.011011+00,
               2014-01-08,
               10
             },
             {
               2014-01-02 00:00:02.022022+00,
               2014-01-02,
               4
             },
             {
               2014-01-02 00:00:02.022022+00,
               2014-01-02,
               5
             },
             {
               2014-01-03 00:00:03.033033+00,
               2014-01-03,
               6
             },
             {
               2014-01-04 00:00:03.033033+00,
               2014-01-06,
               14
             },
             {
               2014-01-04 00:00:04.044044+00,
               2014-01-04,
               7
             },
             {
               2014-01-05 00:00:02.022022+00,
               2014-02-02,
               12
             },
             {
               2014-02-04 00:00:04.044044+00,
               NULL,
               16
             },
             {
               2014-02-04 00:00:04.044044+00,
               2014-02-04,
               15
             },
             {
               2014-04-01 00:00:01.011011+00,
               2014-02-01,
               11
             },
             {
               2014-05-02 00:00:02.022022+00,
               2014-05-02,
               13
             }]
==
[required_features=NUMERIC_TYPE]
[name=orderby_multi_base_column_numeric_asc]
SELECT numeric_val, date_val, row_id FROM AllTypesNumericTable t
ORDER BY numeric_val ASC, date_val ASC, row_id ASC
--
ARRAY<STRUCT<numeric_val NUMERIC, date_val DATE, row_id INT64>>[known order:
  {NULL, NULL, 8},
  {NULL, NULL, 9},
  {NULL, NULL, 16},
  {-123456789.123456789, 2014-02-04, 15},
  {-123456789.123456789, 2014-02-04, 17},
  {-1000.10101, 2014-05-02, 13},
  {-5.34, 2014-02-01, 11},
  {1, 2014-01-01, 1},
  {1, 2014-01-01, 2},
  {1, 2014-01-01, 3},
  {1, 2014-01-08, 10},
  {2, 2014-01-02, 4},
  {3, 2014-01-03, 6},
  {4, 2014-01-04, 7},
  {93, 2014-01-02, 5},
  {222, 2014-01-06, 14},
  {999.999, 2014-02-02, 12}
]
==
[required_features=BIGNUMERIC_TYPE]
[name=orderby_multi_base_column_bignumeric_asc]
SELECT bignumeric_val, date_val, row_id FROM AllTypesBigNumericTable t
ORDER BY bignumeric_val ASC, date_val ASC, row_id ASC
--
ARRAY<STRUCT<
        bignumeric_val BIGNUMERIC,
        date_val DATE,
        row_id INT64
      >>
[known order:{NULL, NULL, 8},
             {NULL, NULL, 9},
             {NULL, NULL, 16},
             {
               -123456789.1234567890123456789,
               2014-02-04,
               15
             },
             {
               -123456789.1234567890123456789,
               2014-02-04,
               17
             },
             {
               -1000.0000000000000000001,
               2014-05-02,
               13
             },
             {-5.34, 2014-02-01, 11},
             {1, 2014-01-01, 1},
             {1, 2014-01-01, 2},
             {1, 2014-01-01, 3},
             {1, 2014-01-08, 10},
             {2, 2014-01-02, 4},
             {3, 2014-01-03, 6},
             {4, 2014-01-04, 7},
             {93, 2014-01-02, 5},
             {222, 2014-01-06, 14},
             {
               999.9999999999999999999,
               2014-02-02,
               12
             }]
==
[required_features=RANGE_TYPE]
[name=orderby_multi_base_column_range_timestamp_asc]
SELECT range_timestamp_val, date_val, row_id FROM AllTypesRangeTable t
ORDER BY range_timestamp_val ASC, date_val ASC, row_id ASC
--
ARRAY<STRUCT<
        range_timestamp_val RANGE<TIMESTAMP>,
        date_val DATE,
        row_id INT64
      >>
[known order:{NULL, NULL, 8},
             {NULL, NULL, 9},
             {NULL, 2014-02-04, 17},
             {[
                NULL,
                2013-10-15 00:00:00+00
              ),
              2014-01-06,
              14},
             {[
                2004-01-01 00:00:00+00,
                2004-10-15 00:00:00+00
              ),
              NULL,
              16},
             {[
                2011-01-01 00:00:00+00,
                2011-10-15 00:00:00+00
              ),
              2014-01-01,
              1},
             {[
                2011-01-01 00:00:00+00,
                2011-10-15 00:00:00+00
              ),
              2014-01-01,
              2},
             {[
                2011-01-01 00:00:00+00,
                2011-10-15 00:00:00+00
              ),
              2014-01-01,
              3},
             {[
                2011-01-01 00:00:00+00,
                2011-10-15 00:00:00+00
              ),
              2014-01-08,
              10},
             {[
                2012-01-01 00:00:00+00,
                2012-10-15 00:00:00+00
              ),
              2014-01-02,
              4},
             {[
                2012-01-01 00:00:00+00,
                2012-10-15 00:00:00+00
              ),
              2014-01-02,
              5},
             {[
                2012-01-01 00:00:00+00,
                2012-10-15 00:00:00+00
              ),
              2014-02-02,
              12},
             {[
                2013-01-01 00:00:00+00,
                2013-10-15 00:00:00+00
              ),
              2014-01-03,
              6},
             {[
                2014-01-01 00:00:00+00,
                2014-10-15 00:00:00+00
              ),
              2014-01-04,
              7},
             {[
                2015-01-01 00:00:00+00,
                2015-10-15 00:00:00+00
              ),
              2014-02-01,
              11},
             {[
                2017-01-01 00:00:00+00,
                NULL
              ),
              2014-02-04,
              15},
             {[
                2019-01-01 00:00:00+00,
                2019-10-15 00:00:00+00
              ),
              2014-05-02,
              13}]
==
[required_features=RANGE_TYPE]
[name=orderby_multi_base_column_range_date_asc]
SELECT range_date_val, timestamp_val, row_id FROM AllTypesRangeTable t
ORDER BY range_date_val ASC, timestamp_val ASC, row_id ASC
--
ARRAY<STRUCT<
        range_date_val RANGE<DATE>,
        timestamp_val TIMESTAMP,
        row_id INT64
      >>
[known order:{NULL, NULL, 8},
             {NULL, NULL, 9},
             {
               NULL,
               2014-02-04 00:00:04.044044+00,
               16
             },
             {
               [NULL, 2007-10-15),
               2014-02-04 00:00:04.044044+00,
               15
             },
             {
               [2007-01-01, 2007-10-15),
               NULL,
               17
             },
             {
               [2011-01-01, 2011-10-15),
               2014-01-01 00:00:01.011011+00,
               1
             },
             {
               [2011-01-01, 2011-10-15),
               2014-01-01 00:00:01.011011+00,
               2
             },
             {
               [2011-01-01, 2011-10-15),
               2014-01-01 00:00:01.011011+00,
               3
             },
             {
               [2011-01-01, 2011-10-15),
               2014-01-02 00:00:01.011011+00,
               10
             },
             {
               [2012-01-01, 2012-10-15),
               2014-01-02 00:00:02.022022+00,
               4
             },
             {
               [2012-01-01, 2012-10-15),
               2014-01-02 00:00:02.022022+00,
               5
             },
             {
               [2013-01-01, 2013-10-15),
               2014-01-03 00:00:03.033033+00,
               6
             },
             {
               [2013-01-01, 2013-10-15),
               2014-04-01 00:00:01.011011+00,
               11
             },
             {
               [2014-01-01, 2014-10-15),
               2014-01-04 00:00:04.044044+00,
               7
             },
             {
               [2017-01-01, NULL),
               2014-01-04 00:00:03.033033+00,
               14
             },
             {
               [2019-01-01, 2019-10-15),
               2014-05-02 00:00:02.022022+00,
               13
             },
             {
               [2026-01-01, 2026-10-15),
               2014-01-05 00:00:02.022022+00,
               12
             }]
==
[required_features=RANGE_TYPE,V_1_2_CIVIL_TIME]
[name=orderby_multi_base_column_range_datetime_asc]
SELECT range_datetime_val, timestamp_val, row_id FROM AllTypesRangeDatetimeTable t
ORDER BY range_datetime_val ASC, timestamp_val ASC, row_id ASC
--
ARRAY<STRUCT<
        range_datetime_val RANGE<DATETIME>,
        timestamp_val TIMESTAMP,
        row_id INT64
      >>
[known order:{NULL, NULL, 8},
             {NULL, NULL, 9},
             {NULL, NULL, 17},
             {
               [NULL, 2013-10-15 00:00:00),
               2014-01-04 00:00:03.033033+00,
               14
             },
             {
               [2004-01-01 00:00:00, 2004-10-15 00:00:00),
               2014-02-04 00:00:04.044044+00,
               16
             },
             {
               [2011-01-01 00:00:00, 2011-10-15 00:00:00),
               2014-01-01 00:00:01.011011+00,
               1
             },
             {
               [2011-01-01 00:00:00, 2011-10-15 00:00:00),
               2014-01-01 00:00:01.011011+00,
               2
             },
             {
               [2011-01-01 00:00:00, 2011-10-15 00:00:00),
               2014-01-01 00:00:01.011011+00,
               3
             },
             {
               [2011-01-01 00:00:00, 2011-10-15 00:00:00),
               2014-01-02 00:00:01.011011+00,
               10
             },
             {
               [2012-01-01 00:00:00, 2012-10-15 00:00:00),
               2014-01-02 00:00:02.022022+00,
               4
             },
             {
               [2012-01-01 00:00:00, 2012-10-15 00:00:00),
               2014-01-02 00:00:02.022022+00,
               5
             },
             {
               [2012-01-01 00:00:00, 2012-10-15 00:00:00),
               2014-01-05 00:00:02.022022+00,
               12
             },
             {
               [2013-01-01 00:00:00, 2013-10-15 00:00:00),
               2014-01-03 00:00:03.033033+00,
               6
             },
             {
               [2014-01-01 00:00:00, 2014-10-15 00:00:00),
               2014-01-04 00:00:04.044044+00,
               7
             },
             {
               [2015-01-01 00:00:00, 2015-10-15 00:00:00),
               2014-04-01 00:00:01.011011+00,
               11
             },
             {
               [2017-01-01 00:00:00, NULL),
               2014-02-04 00:00:04.044044+00,
               15
             },
             {
               [2019-01-01 00:00:00, 2019-10-15 00:00:00),
               2014-05-02 00:00:02.022022+00,
               13
             }]
==
#
# Multiple columns, with first as base table column descending
#
[name=orderby_multi_base_column_bool_desc]
SELECT bool_val, int32_val, row_id FROM AllTypesTable t
ORDER BY bool_val DESC, int32_val DESC, row_id ASC
--
ARRAY<STRUCT<bool_val BOOL, int32_val INT32, row_id INT64>>[known order:
  {true, 13, 14},
  {true, 1, 10},
  {true, -1, 1},
  {true, -1, 2},
  {true, -1, 3},
  {true, -3, 6},
  {false, 9, 13},
  {false, 5, 11},
  {false, 2, 12},
  {false, -2, 4},
  {false, -2, 5},
  {false, -4, 7},
  {false, -24, 15},
  {false, NULL, 16},
  {NULL, -1, 17},
  {NULL, NULL, 8},
  {NULL, NULL, 9}
]
==
[name=orderby_multi_base_column_int32_desc]
SELECT int32_val, int64_val, row_id FROM AllTypesTable t
ORDER BY int32_val DESC, -int64_val ASC, row_id ASC
--
ARRAY<STRUCT<int32_val INT32, int64_val INT64, row_id INT64>>[known order:
  {13, 23, 14},
  {9, 9, 13},
  {5, 3, 11},
  {2, 16, 12},
  {1, 1, 10},
  {-1, NULL, 17},
  {-1, -1, 1},
  {-1, -1, 2},
  {-1, -1, 3},
  {-2, -2, 4},
  {-2, -2, 5},
  {-3, -3, 6},
  {-4, -4, 7},
  {-24, -14, 15},
  {NULL, NULL, 8},
  {NULL, NULL, 9},
  {NULL, -1, 16}
]
==
[name=orderby_multi_base_column_int64_desc]
SELECT int64_val, uint32_val, row_id FROM AllTypesTable t
ORDER BY int64_val DESC, uint32_val + 2 DESC, row_id ASC
--
ARRAY<STRUCT<int64_val INT64, uint32_val UINT32, row_id INT64>>[known order:
  {23, 31, 14},
  {16, 5, 12},
  {9, 4, 13},
  {3, 11, 11},
  {1, 11, 10},
  {-1, 1, 1},
  {-1, 1, 2},
  {-1, 1, 3},
  {-1, NULL, 16},
  {-2, 2, 4},
  {-2, 2, 5},
  {-3, 3, 6},
  {-4, 4, 7},
  {-14, 41, 15},
  {NULL, 1, 17},
  {NULL, NULL, 8},
  {NULL, NULL, 9}
]
==
[name=orderby_multi_base_column_uint32_desc]
SELECT uint32_val, uint64_val, row_id FROM AllTypesTable t
ORDER BY uint32_val DESC, uint64_val * 2 ASC, row_id ASC
--
ARRAY<STRUCT<uint32_val UINT32, uint64_val UINT64, row_id INT64>>[known order:
  {41, 54, 15},
  {31, 32, 14},
  {11, 8, 11},
  {11, 11, 10},
  {5, 9, 12},
  {4, 4, 7},
  {4, 8, 13},
  {3, 3, 6},
  {2, 2, 4},
  {2, 2, 5},
  {1, NULL, 17},
  {1, 1, 1},
  {1, 1, 2},
  {1, 1, 3},
  {NULL, NULL, 8},
  {NULL, NULL, 9},
  {NULL, 1, 16}
]
==
[name=orderby_multi_base_column_uint64_desc]
SELECT uint64_val, float_val, row_id FROM AllTypesTable t
ORDER BY uint64_val DESC, float_val DESC, row_id ASC
--
ARRAY<STRUCT<uint64_val UINT64, float_val FLOAT, row_id INT64>>[known order:
  {54, -0.5, 15},
  {32, -0.375, 14},
  {11, 0.625, 10},
  {9, 0.75, 12},
  {8, -0.125, 11},
  {8, -0.25, 13},
  {4, 0.5, 7},
  {3, 0.375, 6},
  {2, 0.25, 4},
  {2, -inf, 5},
  {1, inf, 3},
  {1, 0.125, 1},
  {1, nan, 2},
  {1, NULL, 16},
  {NULL, -0, 9},
  {NULL, 0, 17},
  {NULL, NULL, 8}
]
==
[name=orderby_multi_base_column_float_desc]
SELECT float_val, double_val, row_id FROM AllTypesTable t
ORDER BY float_val DESC, double_val ASC, row_id ASC
--
ARRAY<STRUCT<float_val FLOAT, double_val DOUBLE, row_id INT64>>[known order:
  {inf, -inf, 3},
  {0.75, -0.25, 12},
  {0.625, 0.625, 10},
  {0.5, 0.5, 7},
  {0.375, 0.375, 6},
  {0.25, 0, 4},
  {0.125, 0.125, 1},
  {0, NULL, 17},
  {-0, nan, 9},
  {-0.125, -0.125, 11},
  {-0.25, -0.75, 13},
  {-0.375, -0.375, 14},
  {-0.5, -0.5, 15},
  {-inf, 0.25, 5},
  {nan, inf, 2},
  {NULL, NULL, 8},
  {NULL, -0, 16}
]
==
[name=orderby_multi_base_column_double_desc]
SELECT double_val, str_val, row_id FROM AllTypesTable t
ORDER BY double_val DESC, str_val DESC, row_id ASC
--
ARRAY<STRUCT<double_val DOUBLE, str_val STRING, row_id INT64>>[known order:
  {inf, "1", 2},
  {0.625, "6", 10},
  {0.5, "4", 7},
  {0.375, "3", 6},
  {0.25, "2", 5},
  {0.125, "1", 1},
  {0, "2", 4},
  {-0, NULL, 16},
  {-0.125, "123", 11},
  {-0.25, "24", 12},
  {-0.375, "345", 14},
  {-0.5, "432", 15},
  {-0.75, "222", 13},
  {-inf, "1", 3},
  {nan, NULL, 9},
  {NULL, "1", 17},
  {NULL, NULL, 8}
]
==
[name=orderby_multi_base_column_str_desc]
SELECT str_val, bytes_val, row_id FROM AllTypesTable t
ORDER BY str_val DESC, bytes_val ASC, row_id ASC
--
ARRAY<STRUCT<str_val STRING, bytes_val BYTES, row_id INT64>>[known order:
  {"6", b"7", 10},
  {"432", b"433", 15},
  {"4", b"4", 7},
  {"345", b"345", 14},
  {"3", b"3", 6},
  {"24", b"22", 12},
  {"222", b"234", 13},
  {"2", b"2", 4},
  {"2", b"2", 5},
  {"123", b"123", 11},
  {"1", NULL, 17},
  {"1", b"1", 1},
  {"1", b"1", 2},
  {"1", b"1", 3},
  {NULL, NULL, 8},
  {NULL, NULL, 9},
  {NULL, b"1", 16}
]
==
[name=orderby_multi_base_column_bytes_desc]
SELECT bytes_val, date_val, row_id FROM AllTypesTable t
ORDER BY bytes_val DESC, date_val ASC, row_id ASC
--
ARRAY<STRUCT<bytes_val BYTES, date_val DATE, row_id INT64>>[known order:
  {b"7", 2014-01-08, 10},
  {b"433", 2014-02-04, 15},
  {b"4", 2014-01-04, 7},
  {b"345", 2014-01-06, 14},
  {b"3", 2014-01-03, 6},
  {b"234", 2014-05-02, 13},
  {b"22", 2014-02-02, 12},
  {b"2", 2014-01-02, 4},
  {b"2", 2014-01-02, 5},
  {b"123", 2014-02-01, 11},
  {b"1", NULL, 16},
  {b"1", 2014-01-01, 1},
  {b"1", 2014-01-01, 2},
  {b"1", 2014-01-01, 3},
  {NULL, NULL, 8},
  {NULL, NULL, 9},
  {NULL, 2014-02-04, 17}
]
==
[name=orderby_multi_base_column_date_desc]
SELECT date_val, timestamp_val, row_id FROM AllTypesTable t
ORDER BY date_val DESC, timestamp_val, row_id ASC
--
ARRAY<STRUCT<
        date_val DATE,
        timestamp_val TIMESTAMP,
        row_id INT64
      >>
[known order:{
               2014-05-02,
               2014-05-02 00:00:02.022022+00,
               13
             },
             {2014-02-04, NULL, 17},
             {
               2014-02-04,
               2014-02-04 00:00:04.044044+00,
               15
             },
             {
               2014-02-02,
               2014-01-05 00:00:02.022022+00,
               12
             },
             {
               2014-02-01,
               2014-04-01 00:00:01.011011+00,
               11
             },
             {
               2014-01-08,
               2014-01-02 00:00:01.011011+00,
               10
             },
             {
               2014-01-06,
               2014-01-04 00:00:03.033033+00,
               14
             },
             {
               2014-01-04,
               2014-01-04 00:00:04.044044+00,
               7
             },
             {
               2014-01-03,
               2014-01-03 00:00:03.033033+00,
               6
             },
             {
               2014-01-02,
               2014-01-02 00:00:02.022022+00,
               4
             },
             {
               2014-01-02,
               2014-01-02 00:00:02.022022+00,
               5
             },
             {
               2014-01-01,
               2014-01-01 00:00:01.011011+00,
               1
             },
             {
               2014-01-01,
               2014-01-01 00:00:01.011011+00,
               2
             },
             {
               2014-01-01,
               2014-01-01 00:00:01.011011+00,
               3
             },
             {NULL, NULL, 8},
             {NULL, NULL, 9},
             {
               NULL,
               2014-02-04 00:00:04.044044+00,
               16
             }]
==
[name=orderby_multi_base_column_timestamp_desc]
SELECT timestamp_val, date_val, row_id FROM AllTypesTable t
ORDER BY timestamp_val DESC, date_val ASC, row_id ASC
--
ARRAY<STRUCT<
        timestamp_val TIMESTAMP,
        date_val DATE,
        row_id INT64
      >>
[known order:{
               2014-05-02 00:00:02.022022+00,
               2014-05-02,
               13
             },
             {
               2014-04-01 00:00:01.011011+00,
               2014-02-01,
               11
             },
             {
               2014-02-04 00:00:04.044044+00,
               NULL,
               16
             },
             {
               2014-02-04 00:00:04.044044+00,
               2014-02-04,
               15
             },
             {
               2014-01-05 00:00:02.022022+00,
               2014-02-02,
               12
             },
             {
               2014-01-04 00:00:04.044044+00,
               2014-01-04,
               7
             },
             {
               2014-01-04 00:00:03.033033+00,
               2014-01-06,
               14
             },
             {
               2014-01-03 00:00:03.033033+00,
               2014-01-03,
               6
             },
             {
               2014-01-02 00:00:02.022022+00,
               2014-01-02,
               4
             },
             {
               2014-01-02 00:00:02.022022+00,
               2014-01-02,
               5
             },
             {
               2014-01-02 00:00:01.011011+00,
               2014-01-08,
               10
             },
             {
               2014-01-01 00:00:01.011011+00,
               2014-01-01,
               1
             },
             {
               2014-01-01 00:00:01.011011+00,
               2014-01-01,
               2
             },
             {
               2014-01-01 00:00:01.011011+00,
               2014-01-01,
               3
             },
             {NULL, NULL, 8},
             {NULL, NULL, 9},
             {NULL, 2014-02-04, 17}]
==
[required_features=NUMERIC_TYPE]
[name=orderby_multi_base_column_numeric_desc]
SELECT numeric_val, date_val, row_id FROM AllTypesNumericTable t
ORDER BY numeric_val DESC, date_val ASC, row_id ASC
--
ARRAY<STRUCT<numeric_val NUMERIC, date_val DATE, row_id INT64>>[known order:
  {999.999, 2014-02-02, 12},
  {222, 2014-01-06, 14},
  {93, 2014-01-02, 5},
  {4, 2014-01-04, 7},
  {3, 2014-01-03, 6},
  {2, 2014-01-02, 4},
  {1, 2014-01-01, 1},
  {1, 2014-01-01, 2},
  {1, 2014-01-01, 3},
  {1, 2014-01-08, 10},
  {-5.34, 2014-02-01, 11},
  {-1000.10101, 2014-05-02, 13},
  {-123456789.123456789, 2014-02-04, 15},
  {-123456789.123456789, 2014-02-04, 17},
  {NULL, NULL, 8},
  {NULL, NULL, 9},
  {NULL, NULL, 16}
]
==
[required_features=BIGNUMERIC_TYPE]
[name=orderby_multi_base_column_bignumeric_desc]
SELECT bignumeric_val, date_val, row_id FROM AllTypesBigNumericTable t
ORDER BY bignumeric_val DESC, date_val ASC, row_id ASC
--
ARRAY<STRUCT<
        bignumeric_val BIGNUMERIC,
        date_val DATE,
        row_id INT64
      >>
[known order:{
               999.9999999999999999999,
               2014-02-02,
               12
             },
             {222, 2014-01-06, 14},
             {93, 2014-01-02, 5},
             {4, 2014-01-04, 7},
             {3, 2014-01-03, 6},
             {2, 2014-01-02, 4},
             {1, 2014-01-01, 1},
             {1, 2014-01-01, 2},
             {1, 2014-01-01, 3},
             {1, 2014-01-08, 10},
             {-5.34, 2014-02-01, 11},
             {
               -1000.0000000000000000001,
               2014-05-02,
               13
             },
             {
               -123456789.1234567890123456789,
               2014-02-04,
               15
             },
             {
               -123456789.1234567890123456789,
               2014-02-04,
               17
             },
             {NULL, NULL, 8},
             {NULL, NULL, 9},
             {NULL, NULL, 16}]
==
[required_features=RANGE_TYPE]
[name=orderby_multi_base_column_range_timestamp_desc]
SELECT range_timestamp_val, date_val, row_id FROM AllTypesRangeTable t
ORDER BY range_timestamp_val DESC, date_val ASC, row_id ASC
--
ARRAY<STRUCT<
        range_timestamp_val RANGE<TIMESTAMP>,
        date_val DATE,
        row_id INT64
      >>
[known order:{[
                2019-01-01 00:00:00+00,
                2019-10-15 00:00:00+00
              ),
              2014-05-02,
              13},
             {[
                2017-01-01 00:00:00+00,
                NULL
              ),
              2014-02-04,
              15},
             {[
                2015-01-01 00:00:00+00,
                2015-10-15 00:00:00+00
              ),
              2014-02-01,
              11},
             {[
                2014-01-01 00:00:00+00,
                2014-10-15 00:00:00+00
              ),
              2014-01-04,
              7},
             {[
                2013-01-01 00:00:00+00,
                2013-10-15 00:00:00+00
              ),
              2014-01-03,
              6},
             {[
                2012-01-01 00:00:00+00,
                2012-10-15 00:00:00+00
              ),
              2014-01-02,
              4},
             {[
                2012-01-01 00:00:00+00,
                2012-10-15 00:00:00+00
              ),
              2014-01-02,
              5},
             {[
                2012-01-01 00:00:00+00,
                2012-10-15 00:00:00+00
              ),
              2014-02-02,
              12},
             {[
                2011-01-01 00:00:00+00,
                2011-10-15 00:00:00+00
              ),
              2014-01-01,
              1},
             {[
                2011-01-01 00:00:00+00,
                2011-10-15 00:00:00+00
              ),
              2014-01-01,
              2},
             {[
                2011-01-01 00:00:00+00,
                2011-10-15 00:00:00+00
              ),
              2014-01-01,
              3},
             {[
                2011-01-01 00:00:00+00,
                2011-10-15 00:00:00+00
              ),
              2014-01-08,
              10},
             {[
                2004-01-01 00:00:00+00,
                2004-10-15 00:00:00+00
              ),
              NULL,
              16},
             {[
                NULL,
                2013-10-15 00:00:00+00
              ),
              2014-01-06,
              14},
             {NULL, NULL, 8},
             {NULL, NULL, 9},
             {NULL, 2014-02-04, 17}]
==
[required_features=RANGE_TYPE]
[name=orderby_multi_base_column_range_date_desc]
SELECT range_date_val, timestamp_val, row_id FROM AllTypesRangeTable t
ORDER BY range_date_val DESC, timestamp_val ASC, row_id ASC
--
ARRAY<STRUCT<
        range_date_val RANGE<DATE>,
        timestamp_val TIMESTAMP,
        row_id INT64
      >>
[known order:{
               [2026-01-01, 2026-10-15),
               2014-01-05 00:00:02.022022+00,
               12
             },
             {
               [2019-01-01, 2019-10-15),
               2014-05-02 00:00:02.022022+00,
               13
             },
             {
               [2017-01-01, NULL),
               2014-01-04 00:00:03.033033+00,
               14
             },
             {
               [2014-01-01, 2014-10-15),
               2014-01-04 00:00:04.044044+00,
               7
             },
             {
               [2013-01-01, 2013-10-15),
               2014-01-03 00:00:03.033033+00,
               6
             },
             {
               [2013-01-01, 2013-10-15),
               2014-04-01 00:00:01.011011+00,
               11
             },
             {
               [2012-01-01, 2012-10-15),
               2014-01-02 00:00:02.022022+00,
               4
             },
             {
               [2012-01-01, 2012-10-15),
               2014-01-02 00:00:02.022022+00,
               5
             },
             {
               [2011-01-01, 2011-10-15),
               2014-01-01 00:00:01.011011+00,
               1
             },
             {
               [2011-01-01, 2011-10-15),
               2014-01-01 00:00:01.011011+00,
               2
             },
             {
               [2011-01-01, 2011-10-15),
               2014-01-01 00:00:01.011011+00,
               3
             },
             {
               [2011-01-01, 2011-10-15),
               2014-01-02 00:00:01.011011+00,
               10
             },
             {
               [2007-01-01, 2007-10-15),
               NULL,
               17
             },
             {
               [NULL, 2007-10-15),
               2014-02-04 00:00:04.044044+00,
               15
             },
             {NULL, NULL, 8},
             {NULL, NULL, 9},
             {
               NULL,
               2014-02-04 00:00:04.044044+00,
               16
             }]
==
[required_features=RANGE_TYPE,V_1_2_CIVIL_TIME]
[name=orderby_multi_base_column_range_datetime_desc]
SELECT range_datetime_val, timestamp_val, row_id FROM AllTypesRangeDatetimeTable t
ORDER BY range_datetime_val DESC, timestamp_val ASC, row_id ASC
--
ARRAY<STRUCT<
        range_datetime_val RANGE<DATETIME>,
        timestamp_val TIMESTAMP,
        row_id INT64
      >>
[known order:{
               [2019-01-01 00:00:00, 2019-10-15 00:00:00),
               2014-05-02 00:00:02.022022+00,
               13
             },
             {
               [2017-01-01 00:00:00, NULL),
               2014-02-04 00:00:04.044044+00,
               15
             },
             {
               [2015-01-01 00:00:00, 2015-10-15 00:00:00),
               2014-04-01 00:00:01.011011+00,
               11
             },
             {
               [2014-01-01 00:00:00, 2014-10-15 00:00:00),
               2014-01-04 00:00:04.044044+00,
               7
             },
             {
               [2013-01-01 00:00:00, 2013-10-15 00:00:00),
               2014-01-03 00:00:03.033033+00,
               6
             },
             {
               [2012-01-01 00:00:00, 2012-10-15 00:00:00),
               2014-01-02 00:00:02.022022+00,
               4
             },
             {
               [2012-01-01 00:00:00, 2012-10-15 00:00:00),
               2014-01-02 00:00:02.022022+00,
               5
             },
             {
               [2012-01-01 00:00:00, 2012-10-15 00:00:00),
               2014-01-05 00:00:02.022022+00,
               12
             },
             {
               [2011-01-01 00:00:00, 2011-10-15 00:00:00),
               2014-01-01 00:00:01.011011+00,
               1
             },
             {
               [2011-01-01 00:00:00, 2011-10-15 00:00:00),
               2014-01-01 00:00:01.011011+00,
               2
             },
             {
               [2011-01-01 00:00:00, 2011-10-15 00:00:00),
               2014-01-01 00:00:01.011011+00,
               3
             },
             {
               [2011-01-01 00:00:00, 2011-10-15 00:00:00),
               2014-01-02 00:00:01.011011+00,
               10
             },
             {
               [2004-01-01 00:00:00, 2004-10-15 00:00:00),
               2014-02-04 00:00:04.044044+00,
               16
             },
             {
               [NULL, 2013-10-15 00:00:00),
               2014-01-04 00:00:03.033033+00,
               14
             },
             {NULL, NULL, 8},
             {NULL, NULL, 9},
             {NULL, NULL, 17}]
==
#
# Multiple columns, with first as computed column ascending
#
[name=orderby_multi_computed_column_bool_asc]
SELECT bool_val, int32_val, row_id FROM AllTypesTable t
ORDER BY (NOT bool_val) ASC, int32_val DESC, row_id ASC
--
ARRAY<STRUCT<bool_val BOOL, int32_val INT32, row_id INT64>>[known order:
  {NULL, -1, 17},
  {NULL, NULL, 8},
  {NULL, NULL, 9},
  {true, 13, 14},
  {true, 1, 10},
  {true, -1, 1},
  {true, -1, 2},
  {true, -1, 3},
  {true, -3, 6},
  {false, 9, 13},
  {false, 5, 11},
  {false, 2, 12},
  {false, -2, 4},
  {false, -2, 5},
  {false, -4, 7},
  {false, -24, 15},
  {false, NULL, 16}
]
==
[name=orderby_multi_computed_column_int32_asc]
SELECT int32_val, int64_val, row_id FROM AllTypesTable t
ORDER BY int32_val * 2 ASC, -int64_val ASC, row_id ASC
--
ARRAY<STRUCT<int32_val INT32, int64_val INT64, row_id INT64>>[known order:
  {NULL, NULL, 8},
  {NULL, NULL, 9},
  {NULL, -1, 16},
  {-24, -14, 15},
  {-4, -4, 7},
  {-3, -3, 6},
  {-2, -2, 4},
  {-2, -2, 5},
  {-1, NULL, 17},
  {-1, -1, 1},
  {-1, -1, 2},
  {-1, -1, 3},
  {1, 1, 10},
  {2, 16, 12},
  {5, 3, 11},
  {9, 9, 13},
  {13, 23, 14}
]
==
[name=orderby_multi_computed_column_int64_asc]
SELECT int64_val, uint32_val, row_id FROM AllTypesTable t
ORDER BY int64_val + 2 ASC, uint32_val + 2 DESC, row_id ASC
--
ARRAY<STRUCT<int64_val INT64, uint32_val UINT32, row_id INT64>>[known order:
  {NULL, 1, 17},
  {NULL, NULL, 8},
  {NULL, NULL, 9},
  {-14, 41, 15},
  {-4, 4, 7},
  {-3, 3, 6},
  {-2, 2, 4},
  {-2, 2, 5},
  {-1, 1, 1},
  {-1, 1, 2},
  {-1, 1, 3},
  {-1, NULL, 16},
  {1, 11, 10},
  {3, 11, 11},
  {9, 4, 13},
  {16, 5, 12},
  {23, 31, 14}
]
==
[name=orderby_multi_computed_column_uint32_asc]
SELECT uint32_val, uint64_val, row_id FROM AllTypesTable t
ORDER BY uint32_val + 7 ASC, uint64_val * 2 ASC, row_id ASC
--
ARRAY<STRUCT<uint32_val UINT32, uint64_val UINT64, row_id INT64>>[known order:
  {NULL, NULL, 8},
  {NULL, NULL, 9},
  {NULL, 1, 16},
  {1, NULL, 17},
  {1, 1, 1},
  {1, 1, 2},
  {1, 1, 3},
  {2, 2, 4},
  {2, 2, 5},
  {3, 3, 6},
  {4, 4, 7},
  {4, 8, 13},
  {5, 9, 12},
  {11, 8, 11},
  {11, 11, 10},
  {31, 32, 14},
  {41, 54, 15}
]
==
[name=orderby_multi_computed_column_uint64_asc]
SELECT uint64_val, float_val, row_id FROM AllTypesTable t
ORDER BY uint64_val * 4 ASC, float_val DESC, row_id ASC
--
ARRAY<STRUCT<uint64_val UINT64, float_val FLOAT, row_id INT64>>[known order:
  {NULL, -0, 9},
  {NULL, 0, 17},
  {NULL, NULL, 8},
  {1, inf, 3},
  {1, 0.125, 1},
  {1, nan, 2},
  {1, NULL, 16},
  {2, 0.25, 4},
  {2, -inf, 5},
  {3, 0.375, 6},
  {4, 0.5, 7},
  {8, -0.125, 11},
  {8, -0.25, 13},
  {9, 0.75, 12},
  {11, 0.625, 10},
  {32, -0.375, 14},
  {54, -0.5, 15}
]
==
[name=orderby_multi_computed_column_float_asc]
SELECT float_val, double_val, row_id FROM AllTypesTable t
ORDER BY float_val + 0.5 ASC, double_val ASC, row_id ASC
--
ARRAY<STRUCT<float_val FLOAT, double_val DOUBLE, row_id INT64>>[known order:
  {NULL, NULL, 8},
  {NULL, -0, 16},
  {nan, inf, 2},
  {-inf, 0.25, 5},
  {-0.5, -0.5, 15},
  {-0.375, -0.375, 14},
  {-0.25, -0.75, 13},
  {-0.125, -0.125, 11},
  {0, NULL, 17},
  {-0, nan, 9},
  {0.125, 0.125, 1},
  {0.25, 0, 4},
  {0.375, 0.375, 6},
  {0.5, 0.5, 7},
  {0.625, 0.625, 10},
  {0.75, -0.25, 12},
  {inf, -inf, 3}
]
==
[name=orderby_multi_computed_column_double_asc]
SELECT double_val, str_val, row_id FROM AllTypesTable t
ORDER BY double_val - 0.75 ASC, str_val DESC, row_id ASC
--
ARRAY<STRUCT<double_val DOUBLE, str_val STRING, row_id INT64>>[known order:
  {NULL, "1", 17},
  {NULL, NULL, 8},
  {nan, NULL, 9},
  {-inf, "1", 3},
  {-0.75, "222", 13},
  {-0.5, "432", 15},
  {-0.375, "345", 14},
  {-0.25, "24", 12},
  {-0.125, "123", 11},
  {0, "2", 4},
  {-0, NULL, 16},
  {0.125, "1", 1},
  {0.25, "2", 5},
  {0.375, "3", 6},
  {0.5, "4", 7},
  {0.625, "6", 10},
  {inf, "1", 2}
]
==
[name=orderby_multi_computed_column_str_asc]
SELECT str_val, bytes_val, row_id FROM AllTypesTable t
ORDER BY RTRIM(str_val) ASC, bytes_val ASC, row_id ASC
--
ARRAY<STRUCT<str_val STRING, bytes_val BYTES, row_id INT64>>[known order:
  {NULL, NULL, 8},
  {NULL, NULL, 9},
  {NULL, b"1", 16},
  {"1", NULL, 17},
  {"1", b"1", 1},
  {"1", b"1", 2},
  {"1", b"1", 3},
  {"123", b"123", 11},
  {"2", b"2", 4},
  {"2", b"2", 5},
  {"222", b"234", 13},
  {"24", b"22", 12},
  {"3", b"3", 6},
  {"345", b"345", 14},
  {"4", b"4", 7},
  {"432", b"433", 15},
  {"6", b"7", 10}
]
==
[name=orderby_multi_computed_column_bytes_asc]
SELECT bytes_val, date_val, row_id FROM AllTypesTable t
ORDER BY UPPER(bytes_val) ASC, date_val ASC, row_id ASC
--
ARRAY<STRUCT<bytes_val BYTES, date_val DATE, row_id INT64>>[known order:
  {NULL, NULL, 8},
  {NULL, NULL, 9},
  {NULL, 2014-02-04, 17},
  {b"1", NULL, 16},
  {b"1", 2014-01-01, 1},
  {b"1", 2014-01-01, 2},
  {b"1", 2014-01-01, 3},
  {b"123", 2014-02-01, 11},
  {b"2", 2014-01-02, 4},
  {b"2", 2014-01-02, 5},
  {b"22", 2014-02-02, 12},
  {b"234", 2014-05-02, 13},
  {b"3", 2014-01-03, 6},
  {b"345", 2014-01-06, 14},
  {b"4", 2014-01-04, 7},
  {b"433", 2014-02-04, 15},
  {b"7", 2014-01-08, 10}
]
==
#
# Multiple columns, with first as computed column descending
#
[name=orderby_multi_computed_column_bool_desc]
SELECT bool_val, int32_val, row_id FROM AllTypesTable t
ORDER BY (NOT bool_val) DESC, int32_val DESC, row_id ASC
--
ARRAY<STRUCT<bool_val BOOL, int32_val INT32, row_id INT64>>[known order:
  {false, 9, 13},
  {false, 5, 11},
  {false, 2, 12},
  {false, -2, 4},
  {false, -2, 5},
  {false, -4, 7},
  {false, -24, 15},
  {false, NULL, 16},
  {true, 13, 14},
  {true, 1, 10},
  {true, -1, 1},
  {true, -1, 2},
  {true, -1, 3},
  {true, -3, 6},
  {NULL, -1, 17},
  {NULL, NULL, 8},
  {NULL, NULL, 9}
]
==
[name=orderby_multi_computed_column_int32_desc]
SELECT int32_val, int64_val, row_id FROM AllTypesTable t
ORDER BY int32_val - 9 DESC, -int64_val ASC, row_id ASC
--
ARRAY<STRUCT<int32_val INT32, int64_val INT64, row_id INT64>>[known order:
  {13, 23, 14},
  {9, 9, 13},
  {5, 3, 11},
  {2, 16, 12},
  {1, 1, 10},
  {-1, NULL, 17},
  {-1, -1, 1},
  {-1, -1, 2},
  {-1, -1, 3},
  {-2, -2, 4},
  {-2, -2, 5},
  {-3, -3, 6},
  {-4, -4, 7},
  {-24, -14, 15},
  {NULL, NULL, 8},
  {NULL, NULL, 9},
  {NULL, -1, 16}
]
==
[name=orderby_multi_computed_column_int64_desc]
SELECT int64_val, uint32_val, row_id FROM AllTypesTable t
ORDER BY int64_val * -2 DESC, uint32_val + 2 DESC, row_id ASC
--
ARRAY<STRUCT<int64_val INT64, uint32_val UINT32, row_id INT64>>[known order:
  {-14, 41, 15},
  {-4, 4, 7},
  {-3, 3, 6},
  {-2, 2, 4},
  {-2, 2, 5},
  {-1, 1, 1},
  {-1, 1, 2},
  {-1, 1, 3},
  {-1, NULL, 16},
  {1, 11, 10},
  {3, 11, 11},
  {9, 4, 13},
  {16, 5, 12},
  {23, 31, 14},
  {NULL, 1, 17},
  {NULL, NULL, 8},
  {NULL, NULL, 9}
]
==
[name=orderby_multi_computed_column_uint32_desc]
SELECT uint32_val, uint64_val, row_id FROM AllTypesTable t
ORDER BY uint32_val + 17 DESC, uint64_val * 2 ASC, row_id ASC
--
ARRAY<STRUCT<uint32_val UINT32, uint64_val UINT64, row_id INT64>>[known order:
  {41, 54, 15},
  {31, 32, 14},
  {11, 8, 11},
  {11, 11, 10},
  {5, 9, 12},
  {4, 4, 7},
  {4, 8, 13},
  {3, 3, 6},
  {2, 2, 4},
  {2, 2, 5},
  {1, NULL, 17},
  {1, 1, 1},
  {1, 1, 2},
  {1, 1, 3},
  {NULL, NULL, 8},
  {NULL, NULL, 9},
  {NULL, 1, 16}
]
==
[name=orderby_multi_computed_column_uint64_desc]
SELECT uint64_val, float_val, row_id FROM AllTypesTable t
ORDER BY uint64_val + 123456789 DESC, float_val DESC, row_id ASC
--
ARRAY<STRUCT<uint64_val UINT64, float_val FLOAT, row_id INT64>>[known order:
  {54, -0.5, 15},
  {32, -0.375, 14},
  {11, 0.625, 10},
  {9, 0.75, 12},
  {8, -0.125, 11},
  {8, -0.25, 13},
  {4, 0.5, 7},
  {3, 0.375, 6},
  {2, 0.25, 4},
  {2, -inf, 5},
  {1, inf, 3},
  {1, 0.125, 1},
  {1, nan, 2},
  {1, NULL, 16},
  {NULL, -0, 9},
  {NULL, 0, 17},
  {NULL, NULL, 8}
]
==
[name=orderby_multi_computed_column_float_desc]
SELECT float_val, double_val, row_id FROM AllTypesTable t
ORDER BY float_val * 0.125 DESC, double_val ASC, row_id ASC
--
ARRAY<STRUCT<float_val FLOAT, double_val DOUBLE, row_id INT64>>[known order:
  {inf, -inf, 3},
  {0.75, -0.25, 12},
  {0.625, 0.625, 10},
  {0.5, 0.5, 7},
  {0.375, 0.375, 6},
  {0.25, 0, 4},
  {0.125, 0.125, 1},
  {0, NULL, 17},
  {-0, nan, 9},
  {-0.125, -0.125, 11},
  {-0.25, -0.75, 13},
  {-0.375, -0.375, 14},
  {-0.5, -0.5, 15},
  {-inf, 0.25, 5},
  {nan, inf, 2},
  {NULL, NULL, 8},
  {NULL, -0, 16}
]
==
[name=orderby_multi_computed_column_double_desc]
SELECT double_val, str_val, row_id FROM AllTypesTable t
ORDER BY double_val / 0.125 DESC, str_val DESC, row_id ASC
--
ARRAY<STRUCT<double_val DOUBLE, str_val STRING, row_id INT64>>[known order:
  {inf, "1", 2},
  {0.625, "6", 10},
  {0.5, "4", 7},
  {0.375, "3", 6},
  {0.25, "2", 5},
  {0.125, "1", 1},
  {0, "2", 4},
  {-0, NULL, 16},
  {-0.125, "123", 11},
  {-0.25, "24", 12},
  {-0.375, "345", 14},
  {-0.5, "432", 15},
  {-0.75, "222", 13},
  {-inf, "1", 3},
  {nan, NULL, 9},
  {NULL, "1", 17},
  {NULL, NULL, 8}
]
==
[name=orderby_multi_computed_column_str_desc]
SELECT str_val, bytes_val, row_id FROM AllTypesTable t
ORDER BY LOWER(str_val) DESC, bytes_val ASC, row_id ASC
--
ARRAY<STRUCT<str_val STRING, bytes_val BYTES, row_id INT64>>[known order:
  {"6", b"7", 10},
  {"432", b"433", 15},
  {"4", b"4", 7},
  {"345", b"345", 14},
  {"3", b"3", 6},
  {"24", b"22", 12},
  {"222", b"234", 13},
  {"2", b"2", 4},
  {"2", b"2", 5},
  {"123", b"123", 11},
  {"1", NULL, 17},
  {"1", b"1", 1},
  {"1", b"1", 2},
  {"1", b"1", 3},
  {NULL, NULL, 8},
  {NULL, NULL, 9},
  {NULL, b"1", 16}
]
==
[name=orderby_multi_computed_column_bytes_desc]
SELECT bytes_val, date_val, row_id FROM AllTypesTable t
ORDER BY UPPER(bytes_val) DESC, date_val ASC, row_id ASC
--
ARRAY<STRUCT<bytes_val BYTES, date_val DATE, row_id INT64>>[known order:
  {b"7", 2014-01-08, 10},
  {b"433", 2014-02-04, 15},
  {b"4", 2014-01-04, 7},
  {b"345", 2014-01-06, 14},
  {b"3", 2014-01-03, 6},
  {b"234", 2014-05-02, 13},
  {b"22", 2014-02-02, 12},
  {b"2", 2014-01-02, 4},
  {b"2", 2014-01-02, 5},
  {b"123", 2014-02-01, 11},
  {b"1", NULL, 16},
  {b"1", 2014-01-01, 1},
  {b"1", 2014-01-01, 2},
  {b"1", 2014-01-01, 3},
  {NULL, NULL, 8},
  {NULL, NULL, 9},
  {NULL, 2014-02-04, 17}
]
==
[required_features=NUMERIC_TYPE]
[name=orderby_multi_computed_column_numeric_desc]
SELECT numeric_val, date_val, row_id FROM AllTypesNumericTable t
ORDER BY numeric_val * 2 DESC, date_val ASC, row_id ASC
--
ARRAY<STRUCT<numeric_val NUMERIC, date_val DATE, row_id INT64>>[known order:
  {999.999, 2014-02-02, 12},
  {222, 2014-01-06, 14},
  {93, 2014-01-02, 5},
  {4, 2014-01-04, 7},
  {3, 2014-01-03, 6},
  {2, 2014-01-02, 4},
  {1, 2014-01-01, 1},
  {1, 2014-01-01, 2},
  {1, 2014-01-01, 3},
  {1, 2014-01-08, 10},
  {-5.34, 2014-02-01, 11},
  {-1000.10101, 2014-05-02, 13},
  {-123456789.123456789, 2014-02-04, 15},
  {-123456789.123456789, 2014-02-04, 17},
  {NULL, NULL, 8},
  {NULL, NULL, 9},
  {NULL, NULL, 16}
]
==
[required_features=BIGNUMERIC_TYPE]
[name=orderby_multi_computed_column_bignumeric_desc]
SELECT bignumeric_val, date_val, row_id FROM AllTypesBigNumericTable t
ORDER BY bignumeric_val * 2 DESC, date_val ASC, row_id ASC
--
ARRAY<STRUCT<
        bignumeric_val BIGNUMERIC,
        date_val DATE,
        row_id INT64
      >>
[known order:{
               999.9999999999999999999,
               2014-02-02,
               12
             },
             {222, 2014-01-06, 14},
             {93, 2014-01-02, 5},
             {4, 2014-01-04, 7},
             {3, 2014-01-03, 6},
             {2, 2014-01-02, 4},
             {1, 2014-01-01, 1},
             {1, 2014-01-01, 2},
             {1, 2014-01-01, 3},
             {1, 2014-01-08, 10},
             {-5.34, 2014-02-01, 11},
             {
               -1000.0000000000000000001,
               2014-05-02,
               13
             },
             {
               -123456789.1234567890123456789,
               2014-02-04,
               15
             },
             {
               -123456789.1234567890123456789,
               2014-02-04,
               17
             },
             {NULL, NULL, 8},
             {NULL, NULL, 9},
             {NULL, NULL, 16}]
==
[required_features=RANGE_TYPE]
[name=orderby_multi_computed_column_range_timestamp_desc]
SELECT range_timestamp_val, date_val, row_id FROM AllTypesRangeTable t
ORDER BY
  IF(range_timestamp_val IS NULL,
     NULL,
     RANGE(RANGE_START(range_timestamp_val), RANGE_END(range_timestamp_val))) DESC,
  date_val ASC,
  row_id ASC
--
ARRAY<STRUCT<
        range_timestamp_val RANGE<TIMESTAMP>,
        date_val DATE,
        row_id INT64
      >>
[known order:{[
                2019-01-01 00:00:00+00,
                2019-10-15 00:00:00+00
              ),
              2014-05-02,
              13},
             {[
                2017-01-01 00:00:00+00,
                NULL
              ),
              2014-02-04,
              15},
             {[
                2015-01-01 00:00:00+00,
                2015-10-15 00:00:00+00
              ),
              2014-02-01,
              11},
             {[
                2014-01-01 00:00:00+00,
                2014-10-15 00:00:00+00
              ),
              2014-01-04,
              7},
             {[
                2013-01-01 00:00:00+00,
                2013-10-15 00:00:00+00
              ),
              2014-01-03,
              6},
             {[
                2012-01-01 00:00:00+00,
                2012-10-15 00:00:00+00
              ),
              2014-01-02,
              4},
             {[
                2012-01-01 00:00:00+00,
                2012-10-15 00:00:00+00
              ),
              2014-01-02,
              5},
             {[
                2012-01-01 00:00:00+00,
                2012-10-15 00:00:00+00
              ),
              2014-02-02,
              12},
             {[
                2011-01-01 00:00:00+00,
                2011-10-15 00:00:00+00
              ),
              2014-01-01,
              1},
             {[
                2011-01-01 00:00:00+00,
                2011-10-15 00:00:00+00
              ),
              2014-01-01,
              2},
             {[
                2011-01-01 00:00:00+00,
                2011-10-15 00:00:00+00
              ),
              2014-01-01,
              3},
             {[
                2011-01-01 00:00:00+00,
                2011-10-15 00:00:00+00
              ),
              2014-01-08,
              10},
             {[
                2004-01-01 00:00:00+00,
                2004-10-15 00:00:00+00
              ),
              NULL,
              16},
             {[
                NULL,
                2013-10-15 00:00:00+00
              ),
              2014-01-06,
              14},
             {NULL, NULL, 8},
             {NULL, NULL, 9},
             {NULL, 2014-02-04, 17}]
==
[required_features=RANGE_TYPE]
[name=orderby_multi_computed_column_range_date_desc]
SELECT range_date_val, timestamp_val, row_id FROM AllTypesRangeTable t
ORDER BY
  IF(range_date_val IS NULL,
     NULL,
     RANGE(RANGE_START(range_date_val), RANGE_END(range_date_val))) DESC,
  timestamp_val ASC,
  row_id ASC
--
ARRAY<STRUCT<
        range_date_val RANGE<DATE>,
        timestamp_val TIMESTAMP,
        row_id INT64
      >>
[known order:{
               [2026-01-01, 2026-10-15),
               2014-01-05 00:00:02.022022+00,
               12
             },
             {
               [2019-01-01, 2019-10-15),
               2014-05-02 00:00:02.022022+00,
               13
             },
             {
               [2017-01-01, NULL),
               2014-01-04 00:00:03.033033+00,
               14
             },
             {
               [2014-01-01, 2014-10-15),
               2014-01-04 00:00:04.044044+00,
               7
             },
             {
               [2013-01-01, 2013-10-15),
               2014-01-03 00:00:03.033033+00,
               6
             },
             {
               [2013-01-01, 2013-10-15),
               2014-04-01 00:00:01.011011+00,
               11
             },
             {
               [2012-01-01, 2012-10-15),
               2014-01-02 00:00:02.022022+00,
               4
             },
             {
               [2012-01-01, 2012-10-15),
               2014-01-02 00:00:02.022022+00,
               5
             },
             {
               [2011-01-01, 2011-10-15),
               2014-01-01 00:00:01.011011+00,
               1
             },
             {
               [2011-01-01, 2011-10-15),
               2014-01-01 00:00:01.011011+00,
               2
             },
             {
               [2011-01-01, 2011-10-15),
               2014-01-01 00:00:01.011011+00,
               3
             },
             {
               [2011-01-01, 2011-10-15),
               2014-01-02 00:00:01.011011+00,
               10
             },
             {
               [2007-01-01, 2007-10-15),
               NULL,
               17
             },
             {
               [NULL, 2007-10-15),
               2014-02-04 00:00:04.044044+00,
               15
             },
             {NULL, NULL, 8},
             {NULL, NULL, 9},
             {
               NULL,
               2014-02-04 00:00:04.044044+00,
               16
             }]
==
[required_features=RANGE_TYPE,V_1_2_CIVIL_TIME]
[name=orderby_multi_computed_column_range_datetime_desc]
SELECT range_datetime_val, timestamp_val, row_id FROM AllTypesRangeDatetimeTable t
ORDER BY
  IF(range_datetime_val IS NULL,
     NULL,
     RANGE(RANGE_START(range_datetime_val), RANGE_END(range_datetime_val))) DESC,
  timestamp_val ASC,
  row_id ASC
--
ARRAY<STRUCT<
        range_datetime_val RANGE<DATETIME>,
        timestamp_val TIMESTAMP,
        row_id INT64
      >>
[known order:{
               [2019-01-01 00:00:00, 2019-10-15 00:00:00),
               2014-05-02 00:00:02.022022+00,
               13
             },
             {
               [2017-01-01 00:00:00, NULL),
               2014-02-04 00:00:04.044044+00,
               15
             },
             {
               [2015-01-01 00:00:00, 2015-10-15 00:00:00),
               2014-04-01 00:00:01.011011+00,
               11
             },
             {
               [2014-01-01 00:00:00, 2014-10-15 00:00:00),
               2014-01-04 00:00:04.044044+00,
               7
             },
             {
               [2013-01-01 00:00:00, 2013-10-15 00:00:00),
               2014-01-03 00:00:03.033033+00,
               6
             },
             {
               [2012-01-01 00:00:00, 2012-10-15 00:00:00),
               2014-01-02 00:00:02.022022+00,
               4
             },
             {
               [2012-01-01 00:00:00, 2012-10-15 00:00:00),
               2014-01-02 00:00:02.022022+00,
               5
             },
             {
               [2012-01-01 00:00:00, 2012-10-15 00:00:00),
               2014-01-05 00:00:02.022022+00,
               12
             },
             {
               [2011-01-01 00:00:00, 2011-10-15 00:00:00),
               2014-01-01 00:00:01.011011+00,
               1
             },
             {
               [2011-01-01 00:00:00, 2011-10-15 00:00:00),
               2014-01-01 00:00:01.011011+00,
               2
             },
             {
               [2011-01-01 00:00:00, 2011-10-15 00:00:00),
               2014-01-01 00:00:01.011011+00,
               3
             },
             {
               [2011-01-01 00:00:00, 2011-10-15 00:00:00),
               2014-01-02 00:00:01.011011+00,
               10
             },
             {
               [2004-01-01 00:00:00, 2004-10-15 00:00:00),
               2014-02-04 00:00:04.044044+00,
               16
             },
             {
               [NULL, 2013-10-15 00:00:00),
               2014-01-04 00:00:03.033033+00,
               14
             },
             {NULL, NULL, 8},
             {NULL, NULL, 9},
             {NULL, NULL, 17}]
==
#
# Single base table column ascending with duplicates
#
[name=orderby_duplicates_single_base_column_bool_asc]
SELECT * FROM UNNEST(ARRAY(
  SELECT bool_val FROM AllTypesTable t
  ORDER BY bool_val ASC
)) x WITH OFFSET POS
--
ARRAY<STRUCT<x BOOL, POS INT64>>[unknown order:
  {NULL, 0},
  {NULL, 1},
  {NULL, 2},
  {false, 3},
  {false, 4},
  {false, 5},
  {false, 6},
  {false, 7},
  {false, 8},
  {false, 9},
  {false, 10},
  {true, 11},
  {true, 12},
  {true, 13},
  {true, 14},
  {true, 15},
  {true, 16}
]
==
[name=orderby_duplicates_single_base_column_int32_asc]
SELECT * FROM UNNEST(ARRAY(
  SELECT int32_val FROM AllTypesTable t
  ORDER BY int32_val ASC
)) x WITH OFFSET POS
--
ARRAY<STRUCT<x INT32, POS INT64>>[unknown order:
  {NULL, 0},
  {NULL, 1},
  {NULL, 2},
  {-24, 3},
  {-4, 4},
  {-3, 5},
  {-2, 6},
  {-2, 7},
  {-1, 8},
  {-1, 9},
  {-1, 10},
  {-1, 11},
  {1, 12},
  {2, 13},
  {5, 14},
  {9, 15},
  {13, 16}
]
==
[name=orderby_duplicates_single_base_column_int64_asc]
SELECT * FROM UNNEST(ARRAY(
  SELECT int64_val FROM AllTypesTable t
  ORDER BY int64_val ASC
)) x WITH OFFSET POS
--
ARRAY<STRUCT<x INT64, POS INT64>>[unknown order:
  {NULL, 0},
  {NULL, 1},
  {NULL, 2},
  {-14, 3},
  {-4, 4},
  {-3, 5},
  {-2, 6},
  {-2, 7},
  {-1, 8},
  {-1, 9},
  {-1, 10},
  {-1, 11},
  {1, 12},
  {3, 13},
  {9, 14},
  {16, 15},
  {23, 16}
]
==
[name=orderby_duplicates_single_base_column_uint32_asc]
SELECT * FROM UNNEST(ARRAY(
  SELECT uint32_val FROM AllTypesTable t
  ORDER BY uint32_val ASC
)) x WITH OFFSET POS
--
ARRAY<STRUCT<x UINT32, POS INT64>>[unknown order:
  {NULL, 0},
  {NULL, 1},
  {NULL, 2},
  {1, 3},
  {1, 4},
  {1, 5},
  {1, 6},
  {2, 7},
  {2, 8},
  {3, 9},
  {4, 10},
  {4, 11},
  {5, 12},
  {11, 13},
  {11, 14},
  {31, 15},
  {41, 16}
]
==
[name=orderby_duplicates_single_base_column_uint64_asc]
SELECT * FROM UNNEST(ARRAY(
  SELECT uint64_val FROM AllTypesTable t
  ORDER BY uint64_val ASC
)) x WITH OFFSET POS
--
ARRAY<STRUCT<x UINT64, POS INT64>>[unknown order:
  {NULL, 0},
  {NULL, 1},
  {NULL, 2},
  {1, 3},
  {1, 4},
  {1, 5},
  {1, 6},
  {2, 7},
  {2, 8},
  {3, 9},
  {4, 10},
  {8, 11},
  {8, 12},
  {9, 13},
  {11, 14},
  {32, 15},
  {54, 16}
]
==
[name=orderby_duplicates_single_base_column_float_asc]
SELECT * FROM UNNEST(ARRAY(
  SELECT float_val FROM AllTypesTable t
  ORDER BY float_val ASC
)) x WITH OFFSET POS
--
ARRAY<STRUCT<x FLOAT, POS INT64>>[unknown order:
  {NULL, 0},
  {NULL, 1},
  {nan, 2},
  {-inf, 3},
  {-0.5, 4},
  {-0.375, 5},
  {-0.25, 6},
  {-0.125, 7},
  {-0, 8},
  {0, 9},
  {0.125, 10},
  {0.25, 11},
  {0.375, 12},
  {0.5, 13},
  {0.625, 14},
  {0.75, 15},
  {inf, 16}
]
==
[name=orderby_duplicates_single_base_column_double_asc]
SELECT * FROM UNNEST(ARRAY(
  SELECT double_val FROM AllTypesTable t
  ORDER BY double_val ASC
)) x WITH OFFSET POS
--
ARRAY<STRUCT<x DOUBLE, POS INT64>>[unknown order:
  {NULL, 0},
  {NULL, 1},
  {nan, 2},
  {-inf, 3},
  {-0.75, 4},
  {-0.5, 5},
  {-0.375, 6},
  {-0.25, 7},
  {-0.125, 8},
  {0, 9},
  {-0, 10},
  {0.125, 11},
  {0.25, 12},
  {0.375, 13},
  {0.5, 14},
  {0.625, 15},
  {inf, 16}
]
==
[name=orderby_duplicates_single_base_column_str_asc]
SELECT * FROM UNNEST(ARRAY(
  SELECT str_val FROM AllTypesTable t
  ORDER BY str_val ASC
)) x WITH OFFSET POS
--
ARRAY<STRUCT<x STRING, POS INT64>>[unknown order:
  {NULL, 0},
  {NULL, 1},
  {NULL, 2},
  {"1", 3},
  {"1", 4},
  {"1", 5},
  {"1", 6},
  {"123", 7},
  {"2", 8},
  {"2", 9},
  {"222", 10},
  {"24", 11},
  {"3", 12},
  {"345", 13},
  {"4", 14},
  {"432", 15},
  {"6", 16}
]
==
[name=orderby_duplicates_single_base_column_bytes_asc]
SELECT * FROM UNNEST(ARRAY(
  SELECT bytes_val FROM AllTypesTable t
  ORDER BY bytes_val ASC
)) x WITH OFFSET POS
--
ARRAY<STRUCT<x BYTES, POS INT64>>[unknown order:
  {NULL, 0},
  {NULL, 1},
  {NULL, 2},
  {b"1", 3},
  {b"1", 4},
  {b"1", 5},
  {b"1", 6},
  {b"123", 7},
  {b"2", 8},
  {b"2", 9},
  {b"22", 10},
  {b"234", 11},
  {b"3", 12},
  {b"345", 13},
  {b"4", 14},
  {b"433", 15},
  {b"7", 16}
]
==
[name=orderby_duplicates_single_base_column_date_asc]
SELECT * FROM UNNEST(ARRAY(
  SELECT date_val FROM AllTypesTable t
  ORDER BY date_val ASC
)) x WITH OFFSET POS
--
ARRAY<STRUCT<x DATE, POS INT64>>[unknown order:
  {NULL, 0},
  {NULL, 1},
  {NULL, 2},
  {2014-01-01, 3},
  {2014-01-01, 4},
  {2014-01-01, 5},
  {2014-01-02, 6},
  {2014-01-02, 7},
  {2014-01-03, 8},
  {2014-01-04, 9},
  {2014-01-06, 10},
  {2014-01-08, 11},
  {2014-02-01, 12},
  {2014-02-02, 13},
  {2014-02-04, 14},
  {2014-02-04, 15},
  {2014-05-02, 16}
]
==
[name=orderby_duplicates_single_base_column_timestamp_asc]
SELECT * FROM UNNEST(ARRAY(
  SELECT timestamp_val FROM AllTypesTable t
  ORDER BY timestamp_val ASC
)) x WITH OFFSET POS
--
ARRAY<STRUCT<x TIMESTAMP, POS INT64>>[unknown order:
  {NULL, 0},
  {NULL, 1},
  {NULL, 2},
  {
    2014-01-01 00:00:01.011011+00,
    3
  },
  {
    2014-01-01 00:00:01.011011+00,
    4
  },
  {
    2014-01-01 00:00:01.011011+00,
    5
  },
  {
    2014-01-02 00:00:01.011011+00,
    6
  },
  {
    2014-01-02 00:00:02.022022+00,
    7
  },
  {
    2014-01-02 00:00:02.022022+00,
    8
  },
  {
    2014-01-03 00:00:03.033033+00,
    9
  },
  {
    2014-01-04 00:00:03.033033+00,
    10
  },
  {
    2014-01-04 00:00:04.044044+00,
    11
  },
  {
    2014-01-05 00:00:02.022022+00,
    12
  },
  {
    2014-02-04 00:00:04.044044+00,
    13
  },
  {
    2014-02-04 00:00:04.044044+00,
    14
  },
  {
    2014-04-01 00:00:01.011011+00,
    15
  },
  {
    2014-05-02 00:00:02.022022+00,
    16
  }
]
==
[required_features=NUMERIC_TYPE]
[name=orderby_duplicates_single_base_column_numeric_asc]
SELECT * FROM UNNEST(ARRAY(
  SELECT numeric_val FROM AllTypesNumericTable t
  ORDER BY numeric_val ASC
)) x WITH OFFSET POS
--
ARRAY<STRUCT<x NUMERIC, POS INT64>>[unknown order:
  {NULL, 0},
  {NULL, 1},
  {NULL, 2},
  {-123456789.123456789, 3},
  {-123456789.123456789, 4},
  {-1000.10101, 5},
  {-5.34, 6},
  {1, 7},
  {1, 8},
  {1, 9},
  {1, 10},
  {2, 11},
  {3, 12},
  {4, 13},
  {93, 14},
  {222, 15},
  {999.999, 16}
]
==
[required_features=BIGNUMERIC_TYPE]
[name=orderby_duplicates_single_base_column_bignumeric_asc]
SELECT * FROM UNNEST(ARRAY(
  SELECT bignumeric_val FROM AllTypesBigNumericTable t
  ORDER BY bignumeric_val ASC
)) x WITH OFFSET POS
--
ARRAY<STRUCT<x BIGNUMERIC, POS INT64>>[unknown order:
  {NULL, 0},
  {NULL, 1},
  {NULL, 2},
  {
    -123456789.1234567890123456789,
    3
  },
  {
    -123456789.1234567890123456789,
    4
  },
  {
    -1000.0000000000000000001,
    5
  },
  {-5.34, 6},
  {1, 7},
  {1, 8},
  {1, 9},
  {1, 10},
  {2, 11},
  {3, 12},
  {4, 13},
  {93, 14},
  {222, 15},
  {
    999.9999999999999999999,
    16
  }
]
==
[required_features=RANGE_TYPE]
[name=orderby_duplicates_single_base_column_range_timestamp_asc]
SELECT * FROM UNNEST(ARRAY(
  SELECT range_timestamp_val FROM AllTypesRangeTable t
  ORDER BY range_timestamp_val ASC
)) x WITH OFFSET POS
--
ARRAY<STRUCT<x RANGE<TIMESTAMP>, POS INT64>>[unknown order:
  {NULL, 0},
  {NULL, 1},
  {NULL, 2},
  {[
     NULL,
     2013-10-15 00:00:00+00
   ),
   3},
  {[
     2004-01-01 00:00:00+00,
     2004-10-15 00:00:00+00
   ),
   4},
  {[
     2011-01-01 00:00:00+00,
     2011-10-15 00:00:00+00
   ),
   5},
  {[
     2011-01-01 00:00:00+00,
     2011-10-15 00:00:00+00
   ),
   6},
  {[
     2011-01-01 00:00:00+00,
     2011-10-15 00:00:00+00
   ),
   7},
  {[
     2011-01-01 00:00:00+00,
     2011-10-15 00:00:00+00
   ),
   8},
  {[
     2012-01-01 00:00:00+00,
     2012-10-15 00:00:00+00
   ),
   9},
  {[
     2012-01-01 00:00:00+00,
     2012-10-15 00:00:00+00
   ),
   10},
  {[
     2012-01-01 00:00:00+00,
     2012-10-15 00:00:00+00
   ),
   11},
  {[
     2013-01-01 00:00:00+00,
     2013-10-15 00:00:00+00
   ),
   12},
  {[
     2014-01-01 00:00:00+00,
     2014-10-15 00:00:00+00
   ),
   13},
  {[
     2015-01-01 00:00:00+00,
     2015-10-15 00:00:00+00
   ),
   14},
  {[
     2017-01-01 00:00:00+00,
     NULL
   ),
   15},
  {[
     2019-01-01 00:00:00+00,
     2019-10-15 00:00:00+00
   ),
   16}
]
==
[required_features=RANGE_TYPE]
[name=orderby_duplicates_single_base_column_range_date_asc]
SELECT * FROM UNNEST(ARRAY(
  SELECT range_date_val FROM AllTypesRangeTable t
  ORDER BY range_date_val ASC
)) x WITH OFFSET POS
--
ARRAY<STRUCT<x RANGE<DATE>, POS INT64>>[unknown order:
  {NULL, 0},
  {NULL, 1},
  {NULL, 2},
  {[NULL, 2007-10-15), 3},
  {
    [2007-01-01, 2007-10-15),
    4
  },
  {
    [2011-01-01, 2011-10-15),
    5
  },
  {
    [2011-01-01, 2011-10-15),
    6
  },
  {
    [2011-01-01, 2011-10-15),
    7
  },
  {
    [2011-01-01, 2011-10-15),
    8
  },
  {
    [2012-01-01, 2012-10-15),
    9
  },
  {
    [2012-01-01, 2012-10-15),
    10
  },
  {
    [2013-01-01, 2013-10-15),
    11
  },
  {
    [2013-01-01, 2013-10-15),
    12
  },
  {
    [2014-01-01, 2014-10-15),
    13
  },
  {[2017-01-01, NULL), 14},
  {
    [2019-01-01, 2019-10-15),
    15
  },
  {
    [2026-01-01, 2026-10-15),
    16
  }
]
==
[required_features=RANGE_TYPE,V_1_2_CIVIL_TIME]
[name=orderby_duplicates_single_base_column_range_datetime_asc]
SELECT * FROM UNNEST(ARRAY(
  SELECT range_datetime_val FROM AllTypesRangeDatetimeTable t
  ORDER BY range_datetime_val ASC
)) x WITH OFFSET POS
--
ARRAY<STRUCT<x RANGE<DATETIME>, POS INT64>>[unknown order:
  {NULL, 0},
  {NULL, 1},
  {NULL, 2},
  {
    [NULL, 2013-10-15 00:00:00),
    3
  },
  {
    [2004-01-01 00:00:00, 2004-10-15 00:00:00),
    4
  },
  {
    [2011-01-01 00:00:00, 2011-10-15 00:00:00),
    5
  },
  {
    [2011-01-01 00:00:00, 2011-10-15 00:00:00),
    6
  },
  {
    [2011-01-01 00:00:00, 2011-10-15 00:00:00),
    7
  },
  {
    [2011-01-01 00:00:00, 2011-10-15 00:00:00),
    8
  },
  {
    [2012-01-01 00:00:00, 2012-10-15 00:00:00),
    9
  },
  {
    [2012-01-01 00:00:00, 2012-10-15 00:00:00),
    10
  },
  {
    [2012-01-01 00:00:00, 2012-10-15 00:00:00),
    11
  },
  {
    [2013-01-01 00:00:00, 2013-10-15 00:00:00),
    12
  },
  {
    [2014-01-01 00:00:00, 2014-10-15 00:00:00),
    13
  },
  {
    [2015-01-01 00:00:00, 2015-10-15 00:00:00),
    14
  },
  {
    [2017-01-01 00:00:00, NULL),
    15
  },
  {
    [2019-01-01 00:00:00, 2019-10-15 00:00:00),
    16
  }
]
==
[name=orderby_duplicates_single_base_column_bool_desc]
SELECT * FROM UNNEST(ARRAY(
  SELECT bool_val FROM AllTypesTable t
  ORDER BY bool_val DESC
)) x WITH OFFSET POS
--
ARRAY<STRUCT<x BOOL, POS INT64>>[unknown order:
  {true, 0},
  {true, 1},
  {true, 2},
  {true, 3},
  {true, 4},
  {true, 5},
  {false, 6},
  {false, 7},
  {false, 8},
  {false, 9},
  {false, 10},
  {false, 11},
  {false, 12},
  {false, 13},
  {NULL, 14},
  {NULL, 15},
  {NULL, 16}
]
==
[name=orderby_duplicates_single_base_column_int32_desc]
SELECT * FROM UNNEST(ARRAY(
  SELECT int32_val FROM AllTypesTable t
  ORDER BY int32_val DESC
)) x WITH OFFSET POS
--
ARRAY<STRUCT<x INT32, POS INT64>>[unknown order:
  {13, 0},
  {9, 1},
  {5, 2},
  {2, 3},
  {1, 4},
  {-1, 5},
  {-1, 6},
  {-1, 7},
  {-1, 8},
  {-2, 9},
  {-2, 10},
  {-3, 11},
  {-4, 12},
  {-24, 13},
  {NULL, 14},
  {NULL, 15},
  {NULL, 16}
]
==
[name=orderby_duplicates_single_base_column_int64_desc]
SELECT * FROM UNNEST(ARRAY(
  SELECT int64_val FROM AllTypesTable t
  ORDER BY int64_val DESC
)) x WITH OFFSET POS
--
ARRAY<STRUCT<x INT64, POS INT64>>[unknown order:
  {23, 0},
  {16, 1},
  {9, 2},
  {3, 3},
  {1, 4},
  {-1, 5},
  {-1, 6},
  {-1, 7},
  {-1, 8},
  {-2, 9},
  {-2, 10},
  {-3, 11},
  {-4, 12},
  {-14, 13},
  {NULL, 14},
  {NULL, 15},
  {NULL, 16}
]
==
[name=orderby_duplicates_single_base_column_uint32_desc]
SELECT * FROM UNNEST(ARRAY(
  SELECT uint32_val FROM AllTypesTable t
  ORDER BY uint32_val DESC
)) x WITH OFFSET POS
--
ARRAY<STRUCT<x UINT32, POS INT64>>[unknown order:
  {41, 0},
  {31, 1},
  {11, 2},
  {11, 3},
  {5, 4},
  {4, 5},
  {4, 6},
  {3, 7},
  {2, 8},
  {2, 9},
  {1, 10},
  {1, 11},
  {1, 12},
  {1, 13},
  {NULL, 14},
  {NULL, 15},
  {NULL, 16}
]
==
[name=orderby_duplicates_single_base_column_uint64_desc]
SELECT * FROM UNNEST(ARRAY(
  SELECT uint64_val FROM AllTypesTable t
  ORDER BY uint64_val DESC
)) x WITH OFFSET POS
--
ARRAY<STRUCT<x UINT64, POS INT64>>[unknown order:
  {54, 0},
  {32, 1},
  {11, 2},
  {9, 3},
  {8, 4},
  {8, 5},
  {4, 6},
  {3, 7},
  {2, 8},
  {2, 9},
  {1, 10},
  {1, 11},
  {1, 12},
  {1, 13},
  {NULL, 14},
  {NULL, 15},
  {NULL, 16}
]
==
[name=orderby_duplicates_single_base_column_float_desc]
SELECT * FROM UNNEST(ARRAY(
  SELECT float_val FROM AllTypesTable t
  ORDER BY float_val DESC
)) x WITH OFFSET POS
--
ARRAY<STRUCT<x FLOAT, POS INT64>>[unknown order:
  {inf, 0},
  {0.75, 1},
  {0.625, 2},
  {0.5, 3},
  {0.375, 4},
  {0.25, 5},
  {0.125, 6},
  {-0, 7},
  {0, 8},
  {-0.125, 9},
  {-0.25, 10},
  {-0.375, 11},
  {-0.5, 12},
  {-inf, 13},
  {nan, 14},
  {NULL, 15},
  {NULL, 16}
]
==
[name=orderby_duplicates_single_base_column_double_desc]
SELECT * FROM UNNEST(ARRAY(
  SELECT double_val FROM AllTypesTable t
  ORDER BY double_val DESC
)) x WITH OFFSET POS
--
ARRAY<STRUCT<x DOUBLE, POS INT64>>[unknown order:
  {inf, 0},
  {0.625, 1},
  {0.5, 2},
  {0.375, 3},
  {0.25, 4},
  {0.125, 5},
  {0, 6},
  {-0, 7},
  {-0.125, 8},
  {-0.25, 9},
  {-0.375, 10},
  {-0.5, 11},
  {-0.75, 12},
  {-inf, 13},
  {nan, 14},
  {NULL, 15},
  {NULL, 16}
]
==
[name=orderby_duplicates_single_base_column_str_desc]
SELECT * FROM UNNEST(ARRAY(
  SELECT str_val FROM AllTypesTable t
  ORDER BY str_val DESC
)) x WITH OFFSET POS
--
ARRAY<STRUCT<x STRING, POS INT64>>[unknown order:
  {"6", 0},
  {"432", 1},
  {"4", 2},
  {"345", 3},
  {"3", 4},
  {"24", 5},
  {"222", 6},
  {"2", 7},
  {"2", 8},
  {"123", 9},
  {"1", 10},
  {"1", 11},
  {"1", 12},
  {"1", 13},
  {NULL, 14},
  {NULL, 15},
  {NULL, 16}
]
==
[name=orderby_duplicates_single_base_column_bytes_desc]
SELECT * FROM UNNEST(ARRAY(
  SELECT bytes_val FROM AllTypesTable t
  ORDER BY bytes_val DESC
)) x WITH OFFSET POS
--
ARRAY<STRUCT<x BYTES, POS INT64>>[unknown order:
  {b"7", 0},
  {b"433", 1},
  {b"4", 2},
  {b"345", 3},
  {b"3", 4},
  {b"234", 5},
  {b"22", 6},
  {b"2", 7},
  {b"2", 8},
  {b"123", 9},
  {b"1", 10},
  {b"1", 11},
  {b"1", 12},
  {b"1", 13},
  {NULL, 14},
  {NULL, 15},
  {NULL, 16}
]
==
[name=orderby_duplicates_single_base_column_date_desc]
SELECT * FROM UNNEST(ARRAY(
  SELECT date_val FROM AllTypesTable t
  ORDER BY date_val DESC
)) x WITH OFFSET POS
--
ARRAY<STRUCT<x DATE, POS INT64>>[unknown order:
  {2014-05-02, 0},
  {2014-02-04, 1},
  {2014-02-04, 2},
  {2014-02-02, 3},
  {2014-02-01, 4},
  {2014-01-08, 5},
  {2014-01-06, 6},
  {2014-01-04, 7},
  {2014-01-03, 8},
  {2014-01-02, 9},
  {2014-01-02, 10},
  {2014-01-01, 11},
  {2014-01-01, 12},
  {2014-01-01, 13},
  {NULL, 14},
  {NULL, 15},
  {NULL, 16}
]
==
[name=orderby_duplicates_single_base_column_timestamp_desc]
SELECT * FROM UNNEST(ARRAY(
  SELECT timestamp_val FROM AllTypesTable t
  ORDER BY timestamp_val DESC
)) x WITH OFFSET POS
--
ARRAY<STRUCT<x TIMESTAMP, POS INT64>>[unknown order:
  {
    2014-05-02 00:00:02.022022+00,
    0
  },
  {
    2014-04-01 00:00:01.011011+00,
    1
  },
  {
    2014-02-04 00:00:04.044044+00,
    2
  },
  {
    2014-02-04 00:00:04.044044+00,
    3
  },
  {
    2014-01-05 00:00:02.022022+00,
    4
  },
  {
    2014-01-04 00:00:04.044044+00,
    5
  },
  {
    2014-01-04 00:00:03.033033+00,
    6
  },
  {
    2014-01-03 00:00:03.033033+00,
    7
  },
  {
    2014-01-02 00:00:02.022022+00,
    8
  },
  {
    2014-01-02 00:00:02.022022+00,
    9
  },
  {
    2014-01-02 00:00:01.011011+00,
    10
  },
  {
    2014-01-01 00:00:01.011011+00,
    11
  },
  {
    2014-01-01 00:00:01.011011+00,
    12
  },
  {
    2014-01-01 00:00:01.011011+00,
    13
  },
  {NULL, 14},
  {NULL, 15},
  {NULL, 16}
]
==
[required_features=NUMERIC_TYPE]
[name=orderby_duplicates_single_base_column_numeric_desc]
SELECT * FROM UNNEST(ARRAY(
  SELECT numeric_val FROM AllTypesNumericTable t
  ORDER BY numeric_val DESC
)) x WITH OFFSET POS
--
ARRAY<STRUCT<x NUMERIC, POS INT64>>[unknown order:
  {999.999, 0},
  {222, 1},
  {93, 2},
  {4, 3},
  {3, 4},
  {2, 5},
  {1, 6},
  {1, 7},
  {1, 8},
  {1, 9},
  {-5.34, 10},
  {-1000.10101, 11},
  {-123456789.123456789, 12},
  {-123456789.123456789, 13},
  {NULL, 14},
  {NULL, 15},
  {NULL, 16}
]
==
[required_features=BIGNUMERIC_TYPE]
[name=orderby_duplicates_single_base_column_bignumeric_desc]
SELECT * FROM UNNEST(ARRAY(
  SELECT bignumeric_val FROM AllTypesBigNumericTable t
  ORDER BY bignumeric_val DESC
)) x WITH OFFSET POS
--
ARRAY<STRUCT<x BIGNUMERIC, POS INT64>>[unknown order:
  {
    999.9999999999999999999,
    0
  },
  {222, 1},
  {93, 2},
  {4, 3},
  {3, 4},
  {2, 5},
  {1, 6},
  {1, 7},
  {1, 8},
  {1, 9},
  {-5.34, 10},
  {
    -1000.0000000000000000001,
    11
  },
  {
    -123456789.1234567890123456789,
    12
  },
  {
    -123456789.1234567890123456789,
    13
  },
  {NULL, 14},
  {NULL, 15},
  {NULL, 16}
]
==
[required_features=RANGE_TYPE]
[name=orderby_duplicates_single_base_column_range_timestamp_desc]
SELECT * FROM UNNEST(ARRAY(
  SELECT range_timestamp_val FROM AllTypesRangeTable t
  ORDER BY range_timestamp_val DESC
)) x WITH OFFSET POS
--
ARRAY<STRUCT<x RANGE<TIMESTAMP>, POS INT64>>[unknown order:
  {[
     2019-01-01 00:00:00+00,
     2019-10-15 00:00:00+00
   ),
   0},
  {[
     2017-01-01 00:00:00+00,
     NULL
   ),
   1},
  {[
     2015-01-01 00:00:00+00,
     2015-10-15 00:00:00+00
   ),
   2},
  {[
     2014-01-01 00:00:00+00,
     2014-10-15 00:00:00+00
   ),
   3},
  {[
     2013-01-01 00:00:00+00,
     2013-10-15 00:00:00+00
   ),
   4},
  {[
     2012-01-01 00:00:00+00,
     2012-10-15 00:00:00+00
   ),
   5},
  {[
     2012-01-01 00:00:00+00,
     2012-10-15 00:00:00+00
   ),
   6},
  {[
     2012-01-01 00:00:00+00,
     2012-10-15 00:00:00+00
   ),
   7},
  {[
     2011-01-01 00:00:00+00,
     2011-10-15 00:00:00+00
   ),
   8},
  {[
     2011-01-01 00:00:00+00,
     2011-10-15 00:00:00+00
   ),
   9},
  {[
     2011-01-01 00:00:00+00,
     2011-10-15 00:00:00+00
   ),
   10},
  {[
     2011-01-01 00:00:00+00,
     2011-10-15 00:00:00+00
   ),
   11},
  {[
     2004-01-01 00:00:00+00,
     2004-10-15 00:00:00+00
   ),
   12},
  {[
     NULL,
     2013-10-15 00:00:00+00
   ),
   13},
  {NULL, 14},
  {NULL, 15},
  {NULL, 16}
]
==
[required_features=RANGE_TYPE]
[name=orderby_duplicates_single_base_column_range_date_desc]
SELECT * FROM UNNEST(ARRAY(
  SELECT range_date_val FROM AllTypesRangeTable t
  ORDER BY range_date_val DESC
)) x WITH OFFSET POS
--
ARRAY<STRUCT<x RANGE<DATE>, POS INT64>>[unknown order:
  {
    [2026-01-01, 2026-10-15),
    0
  },
  {
    [2019-01-01, 2019-10-15),
    1
  },
  {[2017-01-01, NULL), 2},
  {
    [2014-01-01, 2014-10-15),
    3
  },
  {
    [2013-01-01, 2013-10-15),
    4
  },
  {
    [2013-01-01, 2013-10-15),
    5
  },
  {
    [2012-01-01, 2012-10-15),
    6
  },
  {
    [2012-01-01, 2012-10-15),
    7
  },
  {
    [2011-01-01, 2011-10-15),
    8
  },
  {
    [2011-01-01, 2011-10-15),
    9
  },
  {
    [2011-01-01, 2011-10-15),
    10
  },
  {
    [2011-01-01, 2011-10-15),
    11
  },
  {
    [2007-01-01, 2007-10-15),
    12
  },
  {[NULL, 2007-10-15), 13},
  {NULL, 14},
  {NULL, 15},
  {NULL, 16}
]
==
[required_features=RANGE_TYPE,V_1_2_CIVIL_TIME]
[name=orderby_duplicates_single_base_column_range_datetime_desc]
SELECT * FROM UNNEST(ARRAY(
  SELECT range_datetime_val FROM AllTypesRangeDatetimeTable t
  ORDER BY range_datetime_val DESC
)) x WITH OFFSET POS
--
ARRAY<STRUCT<x RANGE<DATETIME>, POS INT64>>[unknown order:
  {
    [2019-01-01 00:00:00, 2019-10-15 00:00:00),
    0
  },
  {
    [2017-01-01 00:00:00, NULL),
    1
  },
  {
    [2015-01-01 00:00:00, 2015-10-15 00:00:00),
    2
  },
  {
    [2014-01-01 00:00:00, 2014-10-15 00:00:00),
    3
  },
  {
    [2013-01-01 00:00:00, 2013-10-15 00:00:00),
    4
  },
  {
    [2012-01-01 00:00:00, 2012-10-15 00:00:00),
    5
  },
  {
    [2012-01-01 00:00:00, 2012-10-15 00:00:00),
    6
  },
  {
    [2012-01-01 00:00:00, 2012-10-15 00:00:00),
    7
  },
  {
    [2011-01-01 00:00:00, 2011-10-15 00:00:00),
    8
  },
  {
    [2011-01-01 00:00:00, 2011-10-15 00:00:00),
    9
  },
  {
    [2011-01-01 00:00:00, 2011-10-15 00:00:00),
    10
  },
  {
    [2011-01-01 00:00:00, 2011-10-15 00:00:00),
    11
  },
  {
    [2004-01-01 00:00:00, 2004-10-15 00:00:00),
    12
  },
  {
    [NULL, 2013-10-15 00:00:00),
    13
  },
  {NULL, 14},
  {NULL, 15},
  {NULL, 16}
]
==
#
# Enum tests
#
[name=orderby_single_base_column_enum_asc]
SELECT enum_val, row_id FROM (
  SELECT CAST(1 AS int64) as row_id,
         CAST(0 AS "zetasql_test__.TestEnum") as enum_val
  UNION ALL
  SELECT CAST(2 AS int64) as row_id,
         CAST(0 AS "zetasql_test__.TestEnum") as enum_val
  UNION ALL
  SELECT CAST(3 AS int64) as row_id,
         CAST(1 AS "zetasql_test__.TestEnum") as enum_val
  UNION ALL
  SELECT CAST(4 AS int64) as row_id,
         CAST(1 AS "zetasql_test__.TestEnum") as enum_val
  UNION ALL
  SELECT CAST(5 AS int64) as row_id,
         CAST(2 AS "zetasql_test__.TestEnum") as enum_val
  UNION ALL
  SELECT CAST(6 AS int64) as row_id,
         CAST(2 AS "zetasql_test__.TestEnum") as enum_val
  UNION ALL
  SELECT CAST(7 AS int64) as row_id,
         CAST(2147483647 AS "zetasql_test__.TestEnum") as enum_val
  UNION ALL
  SELECT CAST(8 AS int64) as row_id,
         CAST(2147483647 AS "zetasql_test__.TestEnum") as enum_val
  UNION ALL
  SELECT CAST(9 AS int64) as row_id,
         CAST(NULL AS "zetasql_test__.TestEnum") as enum_val
  UNION ALL
  SELECT CAST(10 AS int64) as row_id,
         CAST(NULL AS "zetasql_test__.TestEnum") as enum_val
) t
WHERE row_id IN (1, 3, 5, 7)
ORDER BY enum_val ASC
--
ARRAY<STRUCT<
        enum_val ENUM<zetasql_test__.TestEnum>,
        row_id INT64
      >>
[known order:
  {TESTENUM0, 1},
  {TESTENUM1, 3},
  {TESTENUM2, 5},
  {TESTENUM2147483647, 7}
]
==
[name=orderby_single_base_column_enum_desc]
SELECT enum_val, row_id FROM (
  SELECT CAST(1 AS int64) as row_id,
         CAST(0 AS "zetasql_test__.TestEnum") as enum_val
  UNION ALL
  SELECT CAST(2 AS int64) as row_id,
         CAST(0 AS "zetasql_test__.TestEnum") as enum_val
  UNION ALL
  SELECT CAST(3 AS int64) as row_id,
         CAST(1 AS "zetasql_test__.TestEnum") as enum_val
  UNION ALL
  SELECT CAST(4 AS int64) as row_id,
         CAST(1 AS "zetasql_test__.TestEnum") as enum_val
  UNION ALL
  SELECT CAST(5 AS int64) as row_id,
         CAST(2 AS "zetasql_test__.TestEnum") as enum_val
  UNION ALL
  SELECT CAST(6 AS int64) as row_id,
         CAST(2 AS "zetasql_test__.TestEnum") as enum_val
  UNION ALL
  SELECT CAST(7 AS int64) as row_id,
         CAST(2147483647 AS "zetasql_test__.TestEnum") as enum_val
  UNION ALL
  SELECT CAST(8 AS int64) as row_id,
         CAST(2147483647 AS "zetasql_test__.TestEnum") as enum_val
  UNION ALL
  SELECT CAST(9 AS int64) as row_id,
         CAST(NULL AS "zetasql_test__.TestEnum") as enum_val
  UNION ALL
  SELECT CAST(10 AS int64) as row_id,
         CAST(NULL AS "zetasql_test__.TestEnum") as enum_val
) t
WHERE row_id IN (1, 3, 5, 7)
ORDER BY enum_val DESC
--
ARRAY<STRUCT<
        enum_val ENUM<zetasql_test__.TestEnum>,
        row_id INT64
      >>
[known order:
  {TESTENUM2147483647, 7},
  {TESTENUM2, 5},
  {TESTENUM1, 3},
  {TESTENUM0, 1}
]
==
[name=orderby_multi_base_column_enum_asc]
SELECT enum_val, row_id FROM (
  SELECT CAST(1 AS int64) as row_id,
         CAST(0 AS "zetasql_test__.TestEnum") as enum_val
  UNION ALL
  SELECT CAST(2 AS int64) as row_id,
         CAST(0 AS "zetasql_test__.TestEnum") as enum_val
  UNION ALL
  SELECT CAST(3 AS int64) as row_id,
         CAST(1 AS "zetasql_test__.TestEnum") as enum_val
  UNION ALL
  SELECT CAST(4 AS int64) as row_id,
         CAST(1 AS "zetasql_test__.TestEnum") as enum_val
  UNION ALL
  SELECT CAST(5 AS int64) as row_id,
         CAST(2 AS "zetasql_test__.TestEnum") as enum_val
  UNION ALL
  SELECT CAST(6 AS int64) as row_id,
         CAST(2 AS "zetasql_test__.TestEnum") as enum_val
  UNION ALL
  SELECT CAST(7 AS int64) as row_id,
         CAST(2147483647 AS "zetasql_test__.TestEnum") as enum_val
  UNION ALL
  SELECT CAST(8 AS int64) as row_id,
         CAST(2147483647 AS "zetasql_test__.TestEnum") as enum_val
  UNION ALL
  SELECT CAST(9 AS int64) as row_id,
         CAST(NULL AS "zetasql_test__.TestEnum") as enum_val
  UNION ALL
  SELECT CAST(10 AS int64) as row_id,
         CAST(NULL AS "zetasql_test__.TestEnum") as enum_val
) t
ORDER BY enum_val ASC, row_id
--
ARRAY<STRUCT<
        enum_val ENUM<zetasql_test__.TestEnum>,
        row_id INT64
      >>
[known order:
  {NULL, 9},
  {NULL, 10},
  {TESTENUM0, 1},
  {TESTENUM0, 2},
  {TESTENUM1, 3},
  {TESTENUM1, 4},
  {TESTENUM2, 5},
  {TESTENUM2, 6},
  {TESTENUM2147483647, 7},
  {TESTENUM2147483647, 8}
]
==
[name=orderby_multi_base_column_enum_desc]
SELECT enum_val, row_id FROM (
  SELECT CAST(1 AS int64) as row_id,
         CAST(0 AS "zetasql_test__.TestEnum") as enum_val
  UNION ALL
  SELECT CAST(2 AS int64) as row_id,
         CAST(0 AS "zetasql_test__.TestEnum") as enum_val
  UNION ALL
  SELECT CAST(3 AS int64) as row_id,
         CAST(1 AS "zetasql_test__.TestEnum") as enum_val
  UNION ALL
  SELECT CAST(4 AS int64) as row_id,
         CAST(1 AS "zetasql_test__.TestEnum") as enum_val
  UNION ALL
  SELECT CAST(5 AS int64) as row_id,
         CAST(2 AS "zetasql_test__.TestEnum") as enum_val
  UNION ALL
  SELECT CAST(6 AS int64) as row_id,
         CAST(2 AS "zetasql_test__.TestEnum") as enum_val
  UNION ALL
  SELECT CAST(7 AS int64) as row_id,
         CAST(2147483647 AS "zetasql_test__.TestEnum") as enum_val
  UNION ALL
  SELECT CAST(8 AS int64) as row_id,
         CAST(2147483647 AS "zetasql_test__.TestEnum") as enum_val
  UNION ALL
  SELECT CAST(9 AS int64) as row_id,
         CAST(NULL AS "zetasql_test__.TestEnum") as enum_val
  UNION ALL
  SELECT CAST(10 AS int64) as row_id,
         CAST(NULL AS "zetasql_test__.TestEnum") as enum_val
) t
ORDER BY enum_val DESC, row_id
--
ARRAY<STRUCT<
        enum_val ENUM<zetasql_test__.TestEnum>,
        row_id INT64
      >>
[known order:
  {TESTENUM2147483647, 7},
  {TESTENUM2147483647, 8},
  {TESTENUM2, 5},
  {TESTENUM2, 6},
  {TESTENUM1, 3},
  {TESTENUM1, 4},
  {TESTENUM0, 1},
  {TESTENUM0, 2},
  {NULL, 9},
  {NULL, 10}
]
==
[name=orderby_duplicates_single_base_column_enum_asc]
SELECT * FROM UNNEST(ARRAY(
  SELECT enum_val FROM (
    SELECT CAST(1 AS int64) as row_id,
           CAST(0 AS "zetasql_test__.TestEnum") as enum_val
    UNION ALL
    SELECT CAST(2 AS int64) as row_id,
           CAST(0 AS "zetasql_test__.TestEnum") as enum_val
    UNION ALL
    SELECT CAST(3 AS int64) as row_id,
           CAST(1 AS "zetasql_test__.TestEnum") as enum_val
    UNION ALL
    SELECT CAST(4 AS int64) as row_id,
           CAST(1 AS "zetasql_test__.TestEnum") as enum_val
    UNION ALL
    SELECT CAST(5 AS int64) as row_id,
           CAST(2 AS "zetasql_test__.TestEnum") as enum_val
    UNION ALL
    SELECT CAST(6 AS int64) as row_id,
           CAST(2 AS "zetasql_test__.TestEnum") as enum_val
    UNION ALL
    SELECT CAST(7 AS int64) as row_id,
           CAST(2147483647 AS "zetasql_test__.TestEnum") as enum_val
    UNION ALL
    SELECT CAST(8 AS int64) as row_id,
           CAST(2147483647 AS "zetasql_test__.TestEnum") as enum_val
    UNION ALL
    SELECT CAST(9 AS int64) as row_id,
           CAST(NULL AS "zetasql_test__.TestEnum") as enum_val
    UNION ALL
    SELECT CAST(10 AS int64) as row_id,
           CAST(NULL AS "zetasql_test__.TestEnum") as enum_val
  ) t
  ORDER BY enum_val ASC
)) x WITH OFFSET POS
--
ARRAY<STRUCT<
        x ENUM<zetasql_test__.TestEnum>,
        POS INT64
      >>
[unknown order:
  {NULL, 0},
  {NULL, 1},
  {TESTENUM0, 2},
  {TESTENUM0, 3},
  {TESTENUM1, 4},
  {TESTENUM1, 5},
  {TESTENUM2, 6},
  {TESTENUM2, 7},
  {TESTENUM2147483647, 8},
  {TESTENUM2147483647, 9}
]
==
[name=orderby_duplicates_single_base_column_enum_desc]
SELECT * FROM UNNEST(ARRAY(
  SELECT enum_val FROM (
    SELECT CAST(1 AS int64) as row_id,
           CAST(0 AS "zetasql_test__.TestEnum") as enum_val
    UNION ALL
    SELECT CAST(2 AS int64) as row_id,
           CAST(0 AS "zetasql_test__.TestEnum") as enum_val
    UNION ALL
    SELECT CAST(3 AS int64) as row_id,
           CAST(1 AS "zetasql_test__.TestEnum") as enum_val
    UNION ALL
    SELECT CAST(4 AS int64) as row_id,
           CAST(1 AS "zetasql_test__.TestEnum") as enum_val
    UNION ALL
    SELECT CAST(5 AS int64) as row_id,
           CAST(2 AS "zetasql_test__.TestEnum") as enum_val
    UNION ALL
    SELECT CAST(6 AS int64) as row_id,
           CAST(2 AS "zetasql_test__.TestEnum") as enum_val
    UNION ALL
    SELECT CAST(7 AS int64) as row_id,
           CAST(2147483647 AS "zetasql_test__.TestEnum") as enum_val
    UNION ALL
    SELECT CAST(8 AS int64) as row_id,
           CAST(2147483647 AS "zetasql_test__.TestEnum") as enum_val
    UNION ALL
    SELECT CAST(9 AS int64) as row_id,
           CAST(NULL AS "zetasql_test__.TestEnum") as enum_val
    UNION ALL
    SELECT CAST(10 AS int64) as row_id,
           CAST(NULL AS "zetasql_test__.TestEnum") as enum_val
  ) t
  ORDER BY enum_val DESC
)) x WITH OFFSET POS
--
ARRAY<STRUCT<
        x ENUM<zetasql_test__.TestEnum>,
        POS INT64
      >>
[unknown order:
  {TESTENUM2147483647, 0},
  {TESTENUM2147483647, 1},
  {TESTENUM2, 2},
  {TESTENUM2, 3},
  {TESTENUM1, 4},
  {TESTENUM1, 5},
  {TESTENUM0, 6},
  {TESTENUM0, 7},
  {NULL, 8},
  {NULL, 9}
]
==

# --------------------
# Ordering of doubles.
# --------------------
[name=orderby_doubles]
SELECT primary_double_sort_key, secondary_int_sort_key
from (select -0.0 primary_double_sort_key, 1 secondary_int_sort_key union all
      select +0.0, 2 union all
      select SQRT(0.0), 3 union all
      select SQRT(-0.0), 4 union all
      select 0.0 / 1, 5 union all
      select 0.0 / -1, 6 union all
      select -0.0 / 1, 7 union all
      select -0.0 / -1, 8 union all
      select cast(1.0 as double), 81 union all
      select cast(NULL as double), 82 union all
      select (-0.0) * (-0.0), 9 union all
      select (-0.0) + (-0.0), 10 union all
      select (0.0) - (-0.0), 11 union all
      select 1.0 - 1.0, 12 union all
      select 0.0 / IEEE_DIVIDE(-1, 0.0), 13 union all
      select -0.0 / IEEE_DIVIDE(-1, 0.0), 14 union all
      select cast(-1.0 as double), 141 union all
      select -cast(NULL as double), 142 union all
      select 0.0 / IEEE_DIVIDE(1, 0.0), 15 union all
      select -0.0 / IEEE_DIVIDE(-1, 0.0), 16 union all
      select cast("-0.0" as DOUBLE), 17 union all
      select cast("+0.0" as DOUBLE), 18 union all
      select IEEE_DIVIDE(1, 0), 19 union all
      select POW(0.1, IEEE_DIVIDE(-1, 0)), 20 union all
      select POW(1.1, IEEE_DIVIDE(1, 0)), 21 union all
      select POW(IEEE_DIVIDE(-1, 0), 2), 22 union all
      select POW(IEEE_DIVIDE(1, 0), 2), 23 union all
      select LOG(IEEE_DIVIDE(1, 0), 1.1), 24 union all
      select cast(1.0 as double), 241 union all
      select -cast(NULL as double), 242 union all
      select CAST("Inf" as DOUBLE), 25 union all
      select IEEE_DIVIDE(-1, 0), 26 union all
      select POW(IEEE_DIVIDE(-1, 0), 3), 27 union all
      select LOG(IEEE_DIVIDE(1, 0), 0.1), 28 union all
      select CAST("-Inf" as DOUBLE), 29 union all
      select TAN(IEEE_DIVIDE(1, 0)), 30 union all
      select cast(-1.0 as double), 301 union all
      select cast(NULL as double), 302 union all
      select TAN(IEEE_DIVIDE(-1, 0)), 31 union all
      select TAN(TAN(IEEE_DIVIDE(1, 0))), 32 union all
      select IEEE_DIVIDE(0, 0), 33 union all
      select LOG(IEEE_DIVIDE(-1, 0), 1), 34 union all
      select LOG(1, IEEE_DIVIDE(1, 0)), 35 union all
      select cast("NAN" as DOUBLE), 36 union all
      select cast("-NAN" as DOUBLE), 37 union all
      select -cast("NAN" as DOUBLE), 38) val
ORDER BY primary_double_sort_key, secondary_int_sort_key
--
ARRAY<STRUCT<
        primary_double_sort_key DOUBLE,
        secondary_int_sort_key INT64
      >>
[known order:{NULL, 82},
             {NULL, 142},
             {NULL, 242},
             {NULL, 302},
             {nan, 30},
             {nan, 31},
             {nan, 32},
             {nan, 33},
             {nan, 34},
             {nan, 35},
             {nan, 36},
             {nan, 37},
             {nan, 38},
             {-inf, 26},
             {-inf, 27},
             {-inf, 28},
             {-inf, 29},
             {-1, 141},
             {-1, 301},
             {-0, 1},
             {0, 2},
             {0, 3},
             {-0, 4},
             {0, 5},
             {-0, 6},
             {-0, 7},
             {0, 8},
             {0, 9},
             {-0, 10},
             {0, 11},
             {0, 12},
             {-0, 13},
             {0, 14},
             {0, 15},
             {0, 16},
             {-0, 17},
             {0, 18},
             {1, 81},
             {1, 241},
             {inf, 19},
             {inf, 20},
             {inf, 21},
             {inf, 22},
             {inf, 23},
             {inf, 24},
             {inf, 25}]
==

# -------------------
# Ordering of floats.
# -------------------
[name=orderby_floats]
SELECT primary_float_sort_key, secondary_int_sort_key
from (select cast(-0.0 as float) primary_float_sort_key,
             1 secondary_int_sort_key union all
      select cast(+0.0 as float), 2 union all
      select cast(SQRT(0.0) as float), 3 union all
      select cast(SQRT(-0.0) as float), 4 union all
      select cast((0.0 / 1) as float), 5 union all
      select cast(1.0 as float), 51 union all
      select cast(NULL as float), 52 union all
      select cast((0.0 / -1) as float), 6 union all
      select cast((-0.0 / 1) as float), 7 union all
      select cast((-0.0 / -1) as float), 8 union all
      select cast(((-0.0) * (-0.0)) as float), 9 union all
      select cast(((-0.0) + (-0.0)) as float), 10 union all
      select cast(-1.0 as float), 101 union all
      select -cast(NULL as float), 102 union all
      select cast(((0.0) - (-0.0)) as float), 11 union all
      select cast((1.0 - 1.0) as float), 12 union all
      select cast((0.0 / IEEE_DIVIDE(-1, 0.0)) as float), 13 union all
      select cast((-0.0 / IEEE_DIVIDE(-1, 0.0)) as float), 14 union all
      select cast((0.0 / IEEE_DIVIDE(1, 0.0)) as float), 15 union all
      select cast((-0.0 / IEEE_DIVIDE(-1, 0.0)) as float), 16 union all
      select cast("-0.0" as float), 17 union all
      select cast("+0.0" as float), 18 union all
      select cast(IEEE_DIVIDE(1, 0) as float), 19 union all
      select cast(POW(0.1, IEEE_DIVIDE(-1, 0)) as float), 20 union all
      select cast(1.0 as float), 201 union all
      select -cast(NULL as float), 202 union all
      select cast(POW(1.1, IEEE_DIVIDE(1, 0)) as float), 21 union all
      select cast(POW(IEEE_DIVIDE(-1, 0), 2) as float), 22 union all
      select cast(POW(IEEE_DIVIDE(1, 0), 2) as float), 23 union all
      select cast(LOG(IEEE_DIVIDE(1, 0), 1.1) as float), 24 union all
      select CAST("Inf" as float), 25 union all
      select cast(IEEE_DIVIDE(-1, 0) as float), 26 union all
      select cast(-1.0 as float), 261 union all
      select cast(NULL as float), 262 union all
      select cast(POW(IEEE_DIVIDE(-1, 0), 3) as float), 27 union all
      select cast(LOG(IEEE_DIVIDE(1, 0), 0.1) as float), 28 union all
      select CAST("-Inf" as float), 29 union all
      select cast(TAN(IEEE_DIVIDE(1, 0)) as float), 30 union all
      select cast(TAN(IEEE_DIVIDE(-1, 0)) as float), 31 union all
      select cast(TAN(TAN(IEEE_DIVIDE(1, 0))) as float), 32 union all
      select cast(IEEE_DIVIDE(0, 0) as float), 33 union all
      select cast(LOG(IEEE_DIVIDE(-1, 0), 1) as float), 34 union all
      select cast(LOG(1, IEEE_DIVIDE(1, 0)) as float), 35 union all
      select cast("NAN" as float), 36 union all
      select cast("-NAN" as float), 37 union all
      select -cast("NAN" as float), 38) val
ORDER BY primary_float_sort_key, secondary_int_sort_key
--
ARRAY<STRUCT<
        primary_float_sort_key FLOAT,
        secondary_int_sort_key INT64
      >>
[known order:{NULL, 52},
             {NULL, 102},
             {NULL, 202},
             {NULL, 262},
             {nan, 30},
             {nan, 31},
             {nan, 32},
             {nan, 33},
             {nan, 34},
             {nan, 35},
             {nan, 36},
             {nan, 37},
             {nan, 38},
             {-inf, 26},
             {-inf, 27},
             {-inf, 28},
             {-inf, 29},
             {-1, 101},
             {-1, 261},
             {-0, 1},
             {0, 2},
             {0, 3},
             {-0, 4},
             {0, 5},
             {-0, 6},
             {-0, 7},
             {0, 8},
             {0, 9},
             {-0, 10},
             {0, 11},
             {0, 12},
             {-0, 13},
             {0, 14},
             {0, 15},
             {0, 16},
             {-0, 17},
             {0, 18},
             {1, 51},
             {1, 201},
             {inf, 19},
             {inf, 20},
             {inf, 21},
             {inf, 22},
             {inf, 23},
             {inf, 24},
             {inf, 25}]
==

[name=order_by_subquery_constant]
select row_id from AllTypesTable
order by (select 'abc'), row_id
--
ARRAY<STRUCT<row_id INT64>>[known order:
  {1},
  {2},
  {3},
  {4},
  {5},
  {6},
  {7},
  {8},
  {9},
  {10},
  {11},
  {12},
  {13},
  {14},
  {15},
  {16},
  {17}
]
==

[name=order_by_subquery_correlated]
select row_id from AllTypesTable
order by (select row_id)
--
ARRAY<STRUCT<row_id INT64>>[known order:
  {1},
  {2},
  {3},
  {4},
  {5},
  {6},
  {7},
  {8},
  {9},
  {10},
  {11},
  {12},
  {13},
  {14},
  {15},
  {16},
  {17}
]
==

[name=order_by_subquery_with_table]
select t1.row_id from AllTypesTable t1
order by (select count(*) from AllTypesTable), row_id
--
ARRAY<STRUCT<row_id INT64>>[known order:
  {1},
  {2},
  {3},
  {4},
  {5},
  {6},
  {7},
  {8},
  {9},
  {10},
  {11},
  {12},
  {13},
  {14},
  {15},
  {16},
  {17}
]
==

[name=order_by_correlated_column_1]
select (select array_agg(r)
        from (select r
              from outer_table.a.repeated_uint32_val r
              order by outer_table.a.int64_key_1 desc limit 3))
from (select new zetasql_test__.KitchenSinkPB(
                     3 as int64_key_1,
                     3 as int64_key_2,
                     ARRAY<UINT32>[7, 8, 9]
                         as repeated_uint32_val) as a) as outer_table
--
ARRAY<STRUCT<ARRAY<>>>[{ARRAY<UINT32>[unknown order:7, 8, 9]}]

NOTE: Reference implementation reports non-determinism.
==

[name=order_by_correlated_column_2]
select (select array_agg(r)
        from (select r from outer_table.a.repeated_uint32_val r
              order by outer_table.a.int64_key_1, r desc limit 3))
from (select new zetasql_test__.KitchenSinkPB(
                     3 as int64_key_1,
                     3 as int64_key_2,
                     ARRAY<UINT32>[7, 8, 9]
                         as repeated_uint32_val) as a) as outer_table
--
ARRAY<STRUCT<ARRAY<>>>[{ARRAY<UINT32>[unknown order:8, 9, 7]}]
==

# The order by has undefined ordering, but only for the y column.
[name=partial_order_by]
select x from
  (select x,y from
    (select 1 as x, 0 as y union all
     select 0, 0 union all
     select 1, 0 union all
     select 1, 1)
   order by x limit 1)
--
ARRAY<STRUCT<x INT64>>[{0}]

NOTE: Reference implementation reports non-determinism.
==

[name=order_by_array_asc]
[required_features=V_1_3_ARRAY_ORDERING]
select arrayval
from (select array<int64>[] as arrayval
      union all
      select cast(null AS array<int64>) as arrayval
      union all
      select array<int64>[5] as arrayval
      union all
      select array<int64>[4, 7] as arrayval
      union all
      select array<int64>[5, 3] as arrayval
      union all
      select array<int64>[NULL] as arrayval
      union all
      select array<int64>[6, 1, 8] as arrayval
      union all
      select array<int64>[6, 1] as arrayval)
order by arrayval asc;
--
ARRAY<STRUCT<arrayval ARRAY<>>>[known order:
  {ARRAY<INT64>(NULL)},
  {ARRAY<INT64>[]},
  {ARRAY<INT64>[NULL]},
  {ARRAY<INT64>[known order:4, 7]},
  {ARRAY<INT64>[5]},
  {ARRAY<INT64>[known order:5, 3]},
  {ARRAY<INT64>[known order:6, 1]},
  {ARRAY<INT64>[known order:6, 1, 8]}
]
==

[name=order_by_array_desc]
[required_features=V_1_3_ARRAY_ORDERING]
select arrayval
from (select array<int64>[] as arrayval
      union all
      select cast(null AS array<int64>) as arrayval
      union all
      select array<int64>[5] as arrayval
      union all
      select array<int64>[4, 7] as arrayval
      union all
      select array<int64>[5, 3] as arrayval
      union all
      select array<int64>[NULL] as arrayval
      union all
      select array<int64>[6, 1, 8] as arrayval
      union all
      select array<int64>[6, 1] as arrayval)
order by arrayval desc;
--
ARRAY<STRUCT<arrayval ARRAY<>>>[known order:
  {ARRAY<INT64>[known order:6, 1, 8]},
  {ARRAY<INT64>[known order:6, 1]},
  {ARRAY<INT64>[known order:5, 3]},
  {ARRAY<INT64>[5]},
  {ARRAY<INT64>[known order:4, 7]},
  {ARRAY<INT64>[NULL]},
  {ARRAY<INT64>[]},
  {ARRAY<INT64>(NULL)}
]
==

[name=order_by_array_double_with_nan_asc]
[required_features=V_1_3_ARRAY_ORDERING]
select arrayval
from (select array<double>[] as arrayval
      union all
      select array<double>[5] as arrayval
      union all
      select array<double>[4, 7] as arrayval
      union all
      select array<double>[5, 3] as arrayval
      union all
      select cast(NULL as array<double>) as arrayval
      union all
      select array<double>[cast('nan' as double)] as arrayval
      union all
      select array<double>[6, 1, 8] as arrayval
      union all
      select array<double>[6, cast('nan' as double)] as arrayval
      union all
      select array<double>[6, 1] as arrayval)
order by arrayval asc;
--
ARRAY<STRUCT<arrayval ARRAY<>>>[known order:
  {ARRAY<DOUBLE>(NULL)},
  {ARRAY<DOUBLE>[]},
  {ARRAY<DOUBLE>[nan]},
  {ARRAY<DOUBLE>[known order:4, 7]},
  {ARRAY<DOUBLE>[5]},
  {ARRAY<DOUBLE>[known order:5, 3]},
  {ARRAY<DOUBLE>[known order:6, nan]},
  {ARRAY<DOUBLE>[known order:6, 1]},
  {ARRAY<DOUBLE>[known order:6, 1, 8]}
]
==

[name=order_by_array_double_with_nan_desc]
[required_features=V_1_3_ARRAY_ORDERING]
select arrayval
from (select array<double>[] as arrayval
      union all
      select array<double>[5] as arrayval
      union all
      select array<double>[4, 7] as arrayval
      union all
      select cast(NULL as array<double>) as arrayval
      union all
      select array<double>[5, 3] as arrayval
      union all
      select array<double>[cast('nan' as double)] as arrayval
      union all
      select array<double>[6, 1, 8] as arrayval
      union all
      select array<double>[6, cast('nan' as double)] as arrayval
      union all
      select array<double>[6, 1] as arrayval)
order by arrayval desc;
--
ARRAY<STRUCT<arrayval ARRAY<>>>[known order:
  {ARRAY<DOUBLE>[known order:6, 1, 8]},
  {ARRAY<DOUBLE>[known order:6, 1]},
  {ARRAY<DOUBLE>[known order:6, nan]},
  {ARRAY<DOUBLE>[known order:5, 3]},
  {ARRAY<DOUBLE>[5]},
  {ARRAY<DOUBLE>[known order:4, 7]},
  {ARRAY<DOUBLE>[nan]},
  {ARRAY<DOUBLE>[]},
  {ARRAY<DOUBLE>(NULL)}
]
==

[name=order_by_array_double_with_nan_and_null_asc]
[required_features=V_1_3_ARRAY_ORDERING]
select arrayval
from (select array<double>[] as arrayval
      union all
      select cast(NULL as array<double>) as arrayval
      union all
      select array<double>[cast('nan' as double)] as arrayval
      union all
      select array<double>[cast(NULL as double)] as arrayval
      union all
      select array<double>[3.0] as arrayval)
order by arrayval asc;
--
ARRAY<STRUCT<arrayval ARRAY<>>>[known order:
  {ARRAY<DOUBLE>(NULL)},
  {ARRAY<DOUBLE>[]},
  {ARRAY<DOUBLE>[NULL]},
  {ARRAY<DOUBLE>[nan]},
  {ARRAY<DOUBLE>[3]}
]
==

[name=order_by_array_double_with_nan_and_null_desc]
[required_features=V_1_3_ARRAY_ORDERING]
select arrayval
from (select array<double>[] as arrayval
      union all
      select array<double>[cast('nan' as double)] as arrayval
      union all
      select cast(NULL as array<double>) as arrayval
      union all
      select array<double>[cast(NULL as double)] as arrayval
      union all
      select array<double>[3.0] as arrayval)
order by arrayval desc;
--
ARRAY<STRUCT<arrayval ARRAY<>>>[known order:
  {ARRAY<DOUBLE>[3]},
  {ARRAY<DOUBLE>[nan]},
  {ARRAY<DOUBLE>[NULL]},
  {ARRAY<DOUBLE>[]},
  {ARRAY<DOUBLE>(NULL)}
]
==

[name=order_by_nulls_first]
[required_features=V_1_3_NULLS_FIRST_LAST_IN_ORDER_BY]
SELECT int64_val, row_id FROM AllTypesTable t
ORDER BY int64_val DESC NULLS FIRST
--
ARRAY<STRUCT<int64_val INT64, row_id INT64>>[unknown order:
  {NULL, 8},
  {NULL, 9},
  {NULL, 17},
  {23, 14},
  {16, 12},
  {9, 13},
  {3, 11},
  {1, 10},
  {-1, 2},
  {-1, 16},
  {-1, 1},
  {-1, 3},
  {-2, 4},
  {-2, 5},
  {-3, 6},
  {-4, 7},
  {-14, 15}
]

==

[name=order_by_nulls_last]
[required_features=V_1_3_NULLS_FIRST_LAST_IN_ORDER_BY]
SELECT int64_val, row_id FROM AllTypesTable t
ORDER BY int64_val NULLS LAST
--
ARRAY<STRUCT<int64_val INT64, row_id INT64>>[unknown order:
  {-14, 15},
  {-4, 7},
  {-3, 6},
  {-2, 4},
  {-2, 5},
  {-1, 2},
  {-1, 16},
  {-1, 1},
  {-1, 3},
  {1, 10},
  {3, 11},
  {9, 13},
  {16, 12},
  {23, 14},
  {NULL, 8},
  {NULL, 9},
  {NULL, 17}
]

==

# NULLS FIRST/LAST with duplicates
[name=order_by_nulls_first_last_with_duplicates]
[required_features=V_1_3_NULLS_FIRST_LAST_IN_ORDER_BY]
SELECT
  bool_val,
  IF(MOD(int64_val, 2) = 0, int64_val, NULL) AS int64_val,
  row_id
FROM AllTypesTable
ORDER BY bool_val NULLS LAST, int64_val DESC NULLS FIRST, row_id
--
ARRAY<STRUCT<bool_val BOOL, int64_val INT64, row_id INT64>>[known order:
  {false, NULL, 11},
  {false, NULL, 13},
  {false, NULL, 16},
  {false, 16, 12},
  {false, -2, 4},
  {false, -2, 5},
  {false, -4, 7},
  {false, -14, 15},
  {true, NULL, 1},
  {true, NULL, 2},
  {true, NULL, 3},
  {true, NULL, 6},
  {true, NULL, 10},
  {true, NULL, 14},
  {NULL, NULL, 8},
  {NULL, NULL, 9},
  {NULL, NULL, 17}
]

==

# NULLS FIRST over arrays with NULL elements
[name=order_by_nulls_first_array_with_null_elems]
[required_features=V_1_3_NULLS_FIRST_LAST_IN_ORDER_BY,V_1_3_ARRAY_ORDERING]
SELECT elem.field
FROM UNNEST([STRUCT([1] AS field),
             STRUCT([NULL]),
             STRUCT(CAST(NULL AS ARRAY<INT64>)),
             STRUCT([2])]) AS elem
ORDER BY elem.field NULLS FIRST;
--
ARRAY<STRUCT<field ARRAY<>>>[known order:
  {ARRAY<INT64>(NULL)},
  {ARRAY<INT64>[NULL]},
  {ARRAY<INT64>[1]},
  {ARRAY<INT64>[2]}
]
==

# NULLS LAST over arrays with NULL elements
[name=order_by_nulls_last_array_with_null_elems]
[required_features=V_1_3_NULLS_FIRST_LAST_IN_ORDER_BY,V_1_3_ARRAY_ORDERING]
SELECT elem.field
FROM UNNEST([STRUCT([1] AS field),
             STRUCT([NULL]),
             STRUCT(CAST(NULL AS ARRAY<INT64>)),
             STRUCT([2])]) AS elem
ORDER BY elem.field NULLS LAST;
--
ARRAY<STRUCT<field ARRAY<>>>[known order:
  {ARRAY<INT64>[NULL]},
  {ARRAY<INT64>[1]},
  {ARRAY<INT64>[2]},
  {ARRAY<INT64>(NULL)}
]
==

[name=order_by_nulls_last_limit]
[required_features=V_1_3_NULLS_FIRST_LAST_IN_ORDER_BY]
SELECT int64_val FROM AllTypesTable t
ORDER BY int64_val NULLS LAST LIMIT 5
--
ARRAY<STRUCT<int64_val INT64>>[known order:{-14}, {-4}, {-3}, {-2}, {-2}]

==

[name=order_by_nulls_first_limit]
[required_features=V_1_3_NULLS_FIRST_LAST_IN_ORDER_BY]
SELECT int64_val FROM AllTypesTable t
ORDER BY int64_val DESC NULLS FIRST LIMIT 5
--
ARRAY<STRUCT<int64_val INT64>>[known order:{NULL}, {NULL}, {NULL}, {23}, {16}]
